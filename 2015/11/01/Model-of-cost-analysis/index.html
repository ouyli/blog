<!DOCTYPE HTML>
<html>
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">

    

    <title>Model of cost analysis | 成本管理</title>
    <meta name="author" content="歐陽">
    
    <meta name="description" content="成本管理">
    
    
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">

    <meta property="og:title" content="Model of cost analysis"/>
    <meta property="og:site_name" content="栖息地"/>

    
    <meta property="og:image" content="undefined"/>
    

    <link rel="icon" type="image/png" href="/favicon.png">
    <link rel="alternate" href="/atom.xml" title="栖息地" type="application/atom+xml">
    <link rel="stylesheet" href="/css/lib/materialize.min.css">
    <link rel="stylesheet" href="/css/lib/font-awesome.min.css">
    <link rel="stylesheet" href="/css/style.css" media="screen" type="text/css">

    
        <link rel="stylesheet" href="/css/lib/prettify-tomorrow-night-eighties.css" type="text/css">
    
    <!--[if lt IE 9]><script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script><![endif]-->
</head>


<body>
    <img src="/weixin_favicon.png" style="position: absolute; left: -9999px; opacity: 0; filter: alpha(opacity=0);">

    <nav class="indigo">
    <div class="nav-wrapper">
        <a href="#" data-activates="main-menu" class="button-collapse">
            <i class="fa fa-navicon"></i>
        </a>
        <div class="">
            <a href="/" class="brand-logo hide-on-med-and-down">栖息地</a>
            <ul class="right hide-on-med-and-down">
                
                    <li>
                        <a class="menu-home " href="/" >
                            <i class="fa fa-home "></i>
                            
                            首页
                        </a>
                    </li>
                
                    <li>
                        <a class="menu-archive " href="/archives" >
                            <i class="fa fa-archive "></i>
                            
                            归档
                        </a>
                    </li>
                
                    <li>
                        <a class="menu-category category-menu" href="javascript:;" data-activates="category-menu" >
                            <i class="fa fa-bookmark "></i>
                            
                            分类
                        </a>
                    </li>
                
                    <li>
                        <a class="menu-reading " href="/reading" >
                            <i class="fa fa-book "></i>
                            
                            读书
                        </a>
                    </li>
                
                    <li>
                        <a class="menu-about " href="/about" >
                            <i class="fa fa-user "></i>
                            
                            关于
                        </a>
                    </li>
                
                    <li>
                        <a class="menu-search modal-trigger " href="#search" >
                            <i class="fa fa-search "></i>
                            
                            搜索
                        </a>
                    </li>
                
            </ul>
            <div>
    <ul class="side-nav indigo darken-1" id="main-menu">
        
        <li class="side-user">
            <div class="row">
                <div class="col s4 no-padding">
                    <img class="avatar-image circle responsive-img" src="/author.jpg" alt="User Avatar">
                </div>
                <div class="info col s8 valign-wrapper no-padding">
                    <div class="valign">
                        <p class="name">7XI</p>
                        <p class="desc">生活就像是剧本,越到最后情节越是复杂</p>
                    </div>
                </div>
            </div>
        </li>
        

        
            <li class="no-padding">
                <a class="waves-effect menu-home " href="/" >
                    <i class="fa fa-home "></i>
                    
                    首页
                </a>
            </li>
        
            <li class="no-padding">
                <a class="waves-effect menu-archive " href="/archives" >
                    <i class="fa fa-archive "></i>
                    
                    归档
                </a>
            </li>
        
            <li class="no-padding">
                <a class="waves-effect menu-category category-menu" href="javascript:;" data-activates="category-menu" >
                    <i class="fa fa-bookmark "></i>
                    
                    分类
                </a>
            </li>
        
            <li class="no-padding">
                <a class="waves-effect menu-reading " href="/reading" >
                    <i class="fa fa-book "></i>
                    
                    读书
                </a>
            </li>
        
            <li class="no-padding">
                <a class="waves-effect menu-about " href="/about" >
                    <i class="fa fa-user "></i>
                    
                    关于
                </a>
            </li>
        
            <li class="no-padding">
                <a class="waves-effect menu-search modal-trigger " href="#search" >
                    <i class="fa fa-search "></i>
                    
                    搜索
                </a>
            </li>
        
    </ul>

    <ul class="side-nav indigo darken-1" id="category-menu">
    

            

            <li class="collapse-level-0" collapse-level="0">
                <a class="no-padding" href="/categories/成本工作/">
                    成本工作 <span class="right">26 篇</span></a>
                </a>
            </li>

        

            <li class="collapse-level-0" collapse-level="0">
                <a class="no-padding" href="/categories/会计分录/">
                    会计分录 <span class="right">3 篇</span></a>
                </a>
            </li>

        

            <li class="collapse-level-0" collapse-level="0">
                <a class="no-padding" href="/categories/预测分析/">
                    预测分析 <span class="right">7 篇</span></a>
                </a>
            </li>

        

            <li class="collapse-level-0" collapse-level="0">
                <a class="no-padding" href="/categories/EXCEL/">
                    EXCEL <span class="right">3 篇</span></a>
                </a>
            </li>

        

            <li class="collapse-level-0" collapse-level="0">
                <a class="no-padding" href="/categories/注会-会计/">
                    注会-会计 <span class="right">1 篇</span></a>
                </a>
            </li>

        

            <li class="collapse-level-0" collapse-level="0">
                <a class="no-padding" href="/categories/ERP软件/">
                    ERP软件 <span class="right">1 篇</span></a>
                </a>
            </li>

        

            <li class="collapse-level-0" collapse-level="0">
                <a class="no-padding" href="/categories/成本控制管理/">
                    成本控制管理 <span class="right">1 篇</span></a>
                </a>
            </li>

        

    </ul>
</div>

        </div>
    </div>
</nav>

<div id="search" class="modal search-modal">
    <div class="row">
        <div class="input-field col s12">
              <input id="search-input" type="text">
              <label for="search-input">搜索</label>
        </div>

    </div>
    <div id="search-result" class="search-result col s12">

    </div>
</div>


    <main>
        <div class="container main-container">
    <nav class="page-nav hide-on-small-only">
    <div class="nav-wrapper indigo">
        <span class="breadcrumb">当前位置（分类目录）</span>
        
            
    
    
    <a class="breadcrumb" href="/categories/成本工作/">成本工作</a>


        

        
    </div>
</nav>

<article>
    <div class="card">
        <div class="card-content">
            

            <div class="article-title">
                
    
        <h1>Model of cost analysis</h1>
    


            </div>
            <time class="pink-link-context" datetime="2015-10-31T16:31:46.000Z"><a href="/2015/11/01/Model-of-cost-analysis/">2015-11-01</a></time>

            <span id="busuanzi_container_page_pv" class="read-times-container">
    <i class="fa fa-eye"></i>
    <span id="busuanzi_value_page_pv"></span>
</span>

            
    <div class="tags-row">
        
            <a href="/tags/成本分析/" class="chip pink lighten-1">成本分析</a>
        
    </div>


            <div class="toc pink-link-context hide-on-med-and-down">
    <ol class="section table-of-contents"><li class="section table-of-contents-item section table-of-contents-level-1"><a class="section table-of-contents-link" href="#成本分析模型-Model_of_cost_analysis"><span class="section table-of-contents-text">成本分析模型-Model of cost analysis</span></a><ol class="section table-of-contents-child"><li class="section table-of-contents-item section table-of-contents-level-2"><a class="section table-of-contents-link" href="#前言"><span class="section table-of-contents-text">前言</span></a></li><li class="section table-of-contents-item section table-of-contents-level-2"><a class="section table-of-contents-link" href="#成本降低和成本回避"><span class="section table-of-contents-text">成本降低和成本回避</span></a></li></ol></li></ol>
</div>


            <div class="entry pink-link-context">
                <h1 id="成本分析模型-Model_of_cost_analysis">成本分析模型-Model of cost analysis</h1><h2 id="前言">前言</h2><p>　　作好成本管理要从成本分析作起， 成本分析需要运用经验，产品知识和综合判断能力对实际或是预期的成本包括原物料成本；人工成本；加工费；管理成本等加以估计。成本按其不同产生和存在形式可分成固定成本；可变成本；半变动成本；直接成本；间接成本和总成本。<br><a id="more"></a><br>　　## 成本分析基本原理  ##<br>　　无论是采购成本还是生产成本，成本是 企业永久的话题也是最敏感的话题。 要研究成本问题，首先要搞清楚成本的感念和理论范围。从采购专业出发，这里我们要讨论的是总成本（Total Cost）感念。<br><strong>什么是总成本？</strong><br>　　在采购专业领域中，总成本是指采购成本；运送成本；以及间接因操作程序，检验，质量保证，设备 维护，重复劳动，后续作业和其它相关工序所造成的成本的总和。总成本是一个相对复杂的系统，但它是成本分析，采购决策，供应商策略等都是至关重要的。 　　<br>　　## 成本管理与成本分析 ##<br>　　成本管理的关键是成本分析。成本分析是对每一个成本单元（如：材料、工时、行政开支、管理开支和利 润）加以分析并相加，得出最终价格的过程。成本的关键组成部分：　<br>     　1. 直接的材料成本：用经济可行的办法能算出的，所有包含在最终产品中或能追溯到最终产品上的原材料成本。对汽车厂来说钢板就是直接原材料。直接原材料不包括胶水、钉子等项目，因为在这极小部分上一个一个花时间计算成本时不合算的，它们应该被计入间接材料（副料）成本中去。<br>　　   2. 直接劳动力成本：用经济可行的办法能追溯到最终产品上的所有劳动力成本。如机器的操作员、组装人员。对需要大量高技术劳动力的产业来说，比如信息业或IT 业，直接劳动力成本会占很高的比例。要记住如果采购项目包括高技术劳力的时候，一定要有针对性地进行分析，不能直接将其它案例中的数据直接拿来运用。另外，要避免用本地的工资水准来衡量异地供应方的直接劳力成本，在信息不足的情况下往往会犯这种错误。<br>　　   3. 间接生产成本（也叫生产管理费用）：除了上述成本以外，所有和生产过程有关的成本。它又包括:<br>　   　4. 可变管理费用，如水电、供应和劳力等。间接劳力是可变还是固定成本要取决于公司的性质。<br>　   　5. 固定管理费用，如租金、保险、财产税、折旧和工商管理费等。<br>　   　6. 其它费用，如广告、科研和销售费用。<br>　　## 降低采购成本的方法 ##<br>　 　成本降低可从许多方面来实施， 但是，在进行成本降低的同时必须要了解， 成本降低的主要目的是在于找出 并减少不必要的成本部分， 并且在不影响产品质量的前提下，将成本做最有效的分配利用。 任何与此原则相违背的决定，都值得深思熟虑。<br>　　<strong>集权采购 （Centralized Purchasing）</strong>便是很有效的降低成本的方法之一。 将各部门的需求集中起来，采购单位便可用较大的采购量作为砝码得到较好的数量折扣价格。规格标准化后， 可取得供应商标准品的优惠价格， 库存量可以相对降低。 如此，行政费用的支出也会因采购统一作业而减少， 采购部便可以有更多的时间将资源用在开发新的供应商。<br>　　可是，集权 采购或许会给人一种僵化，没有弹性的感觉。因此，另一中较为折中的方法是由使用量最多的单位来整合所有采购数量，并负责主导采购议价。 这除了可以拥有与集权采购相同的数量优势之外，更能促进采购部门与使用部门的紧密合作，充分掌握使用部门的需求状况。 其它如由各相关部门代表组成的产品委员会；联合采购；长期合约以及采购产品生命周期所需的总需求量合约等，都是可以交互使用的。<br>　　不断变动 的供应链粗要不断更新的绩效评估衡量指标。尤其在全球化运筹的公司，营运指标、战术指标与策略指标必须同时被衡量，才能真实的显现整体供应链的绩效全貌。所有的指标设计都必须基于一个基本的观念，那就是”满足最终使用者的需求”。由于使用者的需求不断在改变，衡量供应链的指标也必须随时做适当的调整。而供 应链中的每一成员表现的好坏，则端视如何有效的衡量其绩效。 </p>
<h2 id="成本降低和成本回避">成本降低和成本回避</h2><p>　　当你评价采购部门成本方面的才智时，是用成本降低 法还是成本规避法往往取决于你所买的商品和服务的性质以及你所在公司的经营理念。<br>　　成本降低法包括对已有的产品或服务的合约安排进行检查，或 者对潜在的削减成本的机会加以判定。它可以包括替换已有的物料，买二手或改装的，而非新的产品。总之，这次所付价格比上次低，就可称为成本降低，它对公司的税前利润的影响是直接的、一块钱对一块钱的关系。<br>　　成本规避法是一种用来让采购者不蒙受物料、或供应商价格上涨影响的采购措施，它通过延迟 或减缓可能的价格上涨所导致的影响来避免将来的成本上升。成本规避可包括在涨价之前累积一定的库存或安排一次特殊的装运；签订长期的价格保护条例等等。和过去的结果相比，它并不能降低所购物料的成本，但它能将价格上升给净利润带来的副面影响降到最低，甚至完全避免。 　　<br>　　那么你应该紧盯成本 降低还是成本规避呢？有人说成本规避是采购人员理所当然的任务。比如，你高成功率的及时货运使生产线能顺利运行，但这仅仅是告诉你的执行总裁你在干采购人员应该干的。执行总裁认为成本规避没有带来任何东西，那只是一种”奇怪的钱”，他对次毫无兴趣，而成本降低却能和公司的利润直接挂钩。<br>　　所 以，当你评价采购部门成本方面的才智时，是用成本降低法还是成本规避法往往取决于你所买的商品和服务的性质以及你所在公司的经营理念。<br>如 何降低采购成本<br>　　“成本”是采购人员心里”永远的痛”， 那时因为采购人员无时无刻不在面临成本的压力。企业营运的主要目标是为股东创造最大的财富利益，所以， 经营者在审核年度绩效时， 投资回报率便成了最好的参考数字。<br>　　## 成本对企业的影响  ##<br>　　虽然投资回报率有不同的计算方式， 最普通的表示方法如下： 　　<br>　 　投资回报率（ROI）= 利润率（Profit Margin）x 资产周转率（Asset Turnover Rage）<br>　　利润率代表了 相对于收益，企业对成本控管的能力。 而资产周转率则反映出管理层对企业可用资产有效利用的能力。所以，企业管理层可透过三个方面来达到增加投资回报率：（1）降低销售成本；（2）利用现有资 产来增加销售业绩；或（3）综合以上两项。<br>　　根据统计资料显示，在制造业中，对原料，零配件。机器设备的采购金额平均占总销售额的50%。 换句话说，任何通过采购所节省的费用都是对利润的直接贡献。我们来看以下的一个例子：假设一家公司花费总收益的50%于采购物料，其税前纯利润为10%；每销售100元。 利润为10元，而物料成本是50元， 其它开销占40元。 此外，假设所有的成本费用都随着销售变动，其损益情况如下：<br>　　销售： ￥100<br>　　生产成本：采购 ￥50/其它 ￥40<br>　　税前利润： ￥10</p>
<p>　　如果这家公司想多赚一元， 相当于将利润率增加10%，则销售额必须提高到110元才能实现。 采购以及其它开销则相对各要提高至55元和44元。 新的损益情况如下：<br>　　销售： ￥110<br>　 　生产成本：采购 ￥55/其它 ￥44</p>
<p>　　税前利润： ￥11<br>　　如果这家公司采取将采购成本有50元降低至49元的方法，那么仅仅2%的采购成本节省同样可以达到将利润率增加10%的目的。在这一例子中反映出采购成本降低2%与销售额增长10%对税前纯利润的影响是对等的。但是，增加销售额则要多付出5倍于降低采购成本的努力，而且采购成本占总销售额比例越高，两者的比例也就越明显。<br>　　销售： ￥100<br>　 　生产成本：采购 ￥49/其它 ￥40<br>　　税前利润： ￥11<br>　　如何计算成本的降低  </p>
<p>　　成本的降低包含了分析目前的产品，服务，合约，制造程序等，以决定是否有任何可能的改变 能够降低成本。所有比前一次减少的付款部分都可视为成本的降低。 简单的计算方法有以下几种：</p>
<p>　　1． 单价降低的金额 = 原单价 - 新单价<br>　　2． 成本降低 = （原单价 - 新单价）x 一次采购数量 （或年采购量）<br>　　3． 成本降低与预计目标之差异 = 实际成本降低金额（每单位或每年） - 预计成本降低金额 （每单位或每年）</p>
<p>　　如果某公司在本年度对于某一型号螺丝的采购单价是每颗只5.8元， 年度总采购量为一千万颗， 但是，前一年每千颗的采购单价是6.0元，于是，我们可以得到该公司在此螺丝的单价上有每千颗0.2元的节省，而总成本降低金额为一年2，000元 （0.2元/千颗X10，000千颗）。<br>　　相对于成本降低，另一比较容易混淆的概念是成本规避 （Cost Avoidance）。 有些时候，价格的上涨并不是采购人员所能控制的，为了避免公司在物料或供应商于未来价格上涨中遭受冲击， 采购可采取一些措施， 如签定价格保障合约；涨价前多备库存等。 至于这种做法是否列入成本降低的的范围，各家公司做法和看法各不相同。<br>　　## 降低采购成本的方法 ##<br>　　利用价值分析也是降低成本的重要方法之一。 将产品设计简化从而降低生产成本；使用替代性材料和相应的生产程序。另外，采用提供较佳付款条件的供应商；采购二手机器设备；运用不同的议价技巧；选择具价格优势的运输公司或考虑改变运输方式等也可达到降低成本的目的。 当然，交货期是否足够等其它影响因素必须事先确认，并做出综合决策。</p>
<p>　　<strong>作业导向成本法（Activity Based Costing）</strong>是另一控制成本的方法。这在美国施乐公司和惠普公司早已盛行多年。 可以将间接成本依照在某一产品上所支援花费的时间很正确地作一配置， 有别于传统会计作业将间接成本平均分摊的做法。 它可以让管理层清楚第了解间接成本分配状况，并易于分析成本分配是否合理。 可是，分析的过度细致也可能导致多头马车，越想全面控制越抓不到重点。因此，适当地进行一些分析，找出关键成本所在是绝对必要的。 .<br>　　此外， 还可利用具有高风险的采购策略， 如商品期货操作，采购材料超出目前或将来的需求以次争取价格优势的投机采购。 基本上，任何可以节省费用的手段都应该是采购值得考虑的对象，但必须是合情，合理，更要合法， 有利于供应商的伙伴关系。 至于上述何种方法应该优先采用，何种方法更好，则需要采购人员运用自己的专业技能和工作经验加以综合判断和灵活运用。<br><strong>作者：Patrick </strong></p>

                
<p class="pink-link-context">
    <a href="/2015/11/01/Price-Negotiation/" rel="next" title="Price Negotiation">
    上一篇：Price Negotiation
  </a>
</p>



<p class="pink-link-context">
    <a href="/2015/10/25/报价先后的利弊/" rel="next" title="报价先后的利弊">
    下一篇：报价先后的利弊
  </a>
</p>


            </div>
			
        </div>
    </div>
</article>




    <section id="comment">
        <div class="card">
            <div class="card-content">
                <!-- Duoshuo Comment BEGIN -->
                <div class="ds-thread" data-thread-key="2015/11/01/Model-of-cost-analysis/" data-title="Model of cost analysis" data-url="http://7xi.bid/2015/11/01/Model-of-cost-analysis/"></div>

                <script type="text/javascript">
                    console.log(document.querySelector('.ds-thread'));
                    var duoshuoQuery = {
                        short_name: 'ouyli'
                    };
                    (function() {
                        var ds = document.createElement('script');
                        ds.type = 'text/javascript';
                        ds.async = true;
                        ds.src = (document.location.protocol == 'https:'
                            ? 'https:'
                            : 'http:') + '//static.duoshuo.com/embed.js';
                        ds.charset = 'UTF-8';
                        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(ds);
                    })();
                </script>
                <!-- Duoshuo Comment END -->
            </div>
        </div>
    </section>




</div>

        <div class="fixed-action-btn float-sitemap">
    <a class="btn-floating btn-large pink">
      <i class="fa fa-caret-square-o-up"></i>
    </a>
    <ul>
      <li><a class="btn-return-top btn-floating waves-effect green" title="回到顶部"><i class="fa fa-arrow-circle-o-up"></i></a></li>
      <li><a class="btn-floating waves-effect button-collapse yellow darken-1"  data-activates="main-menu" title="菜单"><i class="fa fa-navicon"></i></a></li>
    </ul>
  </div>

    </main>
    <footer class="page-footer indigo darken-1">
    
    <div class="footer-container container">
        <div class="row">
            
            <div class="social-group col m4 s12">
                <h5 class="white-text">社交</h5>
                
                    <a class="social-link" href="http://weibo.com/ouyli" target="_blank">
                        <i class="fa fa-2x fa-weibo"></i>
                    </a>
                
                    <a class="social-link" href="/atom.xml" target="_blank">
                        <i class="fa fa-2x fa-rss"></i>
                    </a>
                
                
    <script async src="//dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js">
    </script>
    <div class="site-visitors-container white-text">
        <span>
            <i class="fa fa-user"></i>
            <span class="busuanzi-value" id="busuanzi_value_site_uv"></span>
        </span>
        <span>&nbsp;|&nbsp;</span>
        <span>
            <i class="fa fa-eye"></i>
            <span class="busuanzi-value" id="busuanzi_value_site_pv"></span>
        </span>
    </div>


            </div>
            

            
            <div class="col m8 s12">
                <h5 class="white-text">友情链接</h5>
                
                    <a class="social-link" href="http://free8.net/" target="_blank">免费吧</a>
                
                    <a class="social-link" href="http://ouyli.lofter.com/" target="_blank">lofter</a>
                
            </div>
            
        </div>
    </div>
    

    <div class="footer-copyright pink-link-context">
        <div class="container">
            © 2010-2018 7XI.BID, All rights reserved.
            <p class="right" style="margin-top: 0;">本博客由 <a href="https://hexo.io">Hexo</a> 强力驱动 | 主题 <a href="https://github.com/raytaylorlin/hexo-theme-raytaylorism">raytaylorism</a></p>
        </div>
    </div>
</footer>


    <noscript>
    <div class="noscript">
        <p class="center-align">当前网速较慢或者你使用的浏览器不支持博客特定功能，请尝试刷新或换用Chrome、Firefox等现代浏览器</p>
    </div>
</noscript>
<div class="noscript">
    <p class="center-align">当前网速较慢或者你使用的浏览器不支持博客特定功能，请尝试刷新或换用Chrome、Firefox等现代浏览器</p>
</div>


<script src="/js/jquery.min.js"></script>
<script src="/js/materialize.min.js"></script>

<script>
    (function($) {
        $(document).ready(function() {
            // 隐藏禁用javascript（针对微信内置浏览器）的提示
            $('.noscript').hide();

            // 图片缩放效果
            var $imgs = $('img').not('.slider-image').not('.avatar-image').not('.carousel-image').not('.card-cover-image').not('.qrcode');

            // 给图片加上点击放大效果（materialbox插件）
            $imgs.addClass('materialboxed').each(function(i, el) {
                $(this).attr('data-caption', $(this).attr('alt') || ' ');
            }).materialbox();

            // 优化表格的显示
            $('table').each(function() {
                var $table = $(this);
                // 除去多行代码的情况
                if ($table.find('pre').length == 0) {
                    $table.addClass('responsive-table striped bordered');
                }
            });

            // 首页幻灯片
            $('.slider').slider({indicators: true, full_width: true, interval: 8000});

            $(".button-collapse").sideNav();
            $(".category-menu").sideNav();

            // 针对gallery post
            $('.carousel').carousel({full_width: true});
            $('.carousel-control.prev').click(function() {
                $('.carousel').carousel('prev');
            });
            $('.carousel-control.next').click(function() {
                $('.carousel').carousel('next');
            });

            // 文章目录
            $('article').not('.simple-article').find('h1').add('h2').add('h3').add('h4').add('h5').add('h6').scrollSpy();

            // 目录随屏幕滚动（防止目录过长越过footer）
            var $toc = $('.toc');
            var scrollTargetTop = 0;
            $(window).scroll(function() {
                var $activeLink = $toc.find('a.active.section');
                if ($(window).scrollTop() < 100) {
                    scrollTargetTop = 0;
                } else {
                    if ($activeLink[0]) {
                        scrollTargetTop = $activeLink.offset().top - $toc.offset().top;
                    }
                }
                $toc.css('top', '-' + scrollTargetTop + 'px');
            });

            // 修正文章目录的left-border颜色
            var color = $('.table-of-contents-text').css('color');
            $('.table-of-contents-link').css('border-left-color', color);

            // 针对移动端做的优化：FAB按钮点击一下收回
            if (/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)) {
                $('.fixed-action-btn').addClass('click-to-toggle');
            }
            // 回到顶部
            $('.btn-return-top').click(function() {
                $('body, html').animate({
                    scrollTop: 0
                }, 500);
            });

            // 重置读书页面的Tab标签页的颜色
            $('li.tab a').hover(function() {
                $(this).toggleClass('text-lighten-4');
            });
            $('.indicator').addClass('pink lighten-2');

            
            // 添加new标签
            $('.menu-reading, .menu-about').append('<span class="new badge pink"></span>');
            

            // 搜索功能
            $('.modal-trigger').leanModal({
                // 打开搜索框时自动聚焦
                ready: function() {
                    if ($('#search').is(":visible")) {
                        $('#search-input').focus();
                    }
                }
            });
            var searchXml = "";
            if (searchXml.length == 0) {
             	searchXml = "search.xml";
            }
            var searchPath = "/" + searchXml;
            initSearch(searchPath, 'search-input', 'search-result');
        });

        // 初始化搜索与匹配函数
        var initSearch = function(path, search_id, content_id) {
            'use strict';
            $.ajax({
                url: path,
                dataType: "xml",
                success: function(xmlResponse) {
                    // get the contents from search data
                    var datas = $("entry", xmlResponse).map(function() {
                        return {
                            title: $("title", this).text(),
                            content: $("content", this).text(),
                            url: $("url", this).text()
                        };
                    }).get();
                    var $input = document.getElementById(search_id);
                    var $resultContent = document.getElementById(content_id);
                    $input.addEventListener('input', function() {
                        var str = '<ul class=\"search-result-list\">';
                        var keywords = this.value.trim().toLowerCase().split(/[\s\-]+/);
                        $resultContent.innerHTML = "";
                        if (this.value.trim().length <= 0) {
                            return;
                        }
                        // perform local searching
                        datas.forEach(function(data) {
                            var isMatch = true;
                            var content_index = [];
                            var data_title = data.title.trim().toLowerCase();
                            var data_content = data.content.trim().replace(/<[^>]+>/g, "").toLowerCase();
                            var data_url = data.url;
                            var index_title = -1;
                            var index_content = -1;
                            var first_occur = -1;
                            // only match artiles with not empty titles and contents
                            if (data_title != '' && data_content != '') {
                                keywords.forEach(function(keyword, i) {
                                    index_title = data_title.indexOf(keyword);
                                    index_content = data_content.indexOf(keyword);
                                    if (index_title < 0 && index_content < 0) {
                                        isMatch = false;
                                    } else {
                                        if (index_content < 0) {
                                            index_content = 0;
                                        }
                                        if (i == 0) {
                                            first_occur = index_content;
                                        }
                                    }
                                });
                            }
                            // show search results
                            if (isMatch) {
                                keywords.forEach(function(keyword) {
                                    var regS = new RegExp(keyword, "gi");
                                    data_title = data_title.replace(regS, "<span class=\"search-keyword pink lighten-2\">" + keyword + "</span>");
                                });

                                str += "<li><a href='" + data_url + "' class='search-result-title'>" + data_title + "</a>";
                                var content = data.content.trim().replace(/<[^>]+>/g, "");
                                if (first_occur >= 0) {
                                    // cut out 100 characters
                                    var start = first_occur - 20;
                                    var end = first_occur + 80;
                                    if (start < 0) {
                                        start = 0;
                                    }
                                    if (start == 0) {
                                        end = 100;
                                    }
                                    if (end > content.length) {
                                        end = content.length;
                                    }
                                    var match_content = content.substring(start, end);
                                    // highlight all keywords
                                    keywords.forEach(function(keyword) {
                                        var regS = new RegExp(keyword, "gi");
                                        match_content = match_content.replace(regS, "<span class=\"search-keyword pink lighten-2\">" + keyword + "</span>");
                                    });

                                    str += "<p class=\"search-result\">..." + match_content + "...</p>"
                                }
                                str += "</li>";
                            }
                        });
                        str += "</ul>";
                        $resultContent.innerHTML = str;
                    });
                }
            });
        }
    })(jQuery);
</script>


<script src="/js/prettify.js"></script>
<script type="text/javascript">
    $(document).ready(function() {
        $("pre").addClass("prettyprint");
        prettyPrint();
    });
</script>


<script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
        (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
            m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', '116338260303228780000', 'auto');
    ga('send', 'pageview');

</script>





<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  tex2jax: {inlineMath: [['$','$'], ['\\(','\\)']]}
});
</script>
<script type="text/javascript" async
  src="//cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-MML-AM_CHTML">
</script>



</body>
</html>
