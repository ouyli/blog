<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no"><title>非常实用Excel VBA 100个经典函数源码大全 | 6卫的栖息地</title><meta name="keywords" content="VBA代码"><meta name="author" content="欧阳"><meta name="copyright" content="欧阳"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="VBA100个经典函数源码">
<meta property="og:type" content="article">
<meta property="og:title" content="非常实用Excel VBA 100个经典函数源码大全">
<meta property="og:url" content="http://vvvvvv.top/2022/08/08/4fee4ae1e938/index.html">
<meta property="og:site_name" content="6卫的栖息地">
<meta property="og:description" content="VBA100个经典函数源码">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="http://vvvvvv.top/img/4.jpg">
<meta property="article:published_time" content="2022-08-07T16:16:32.000Z">
<meta property="article:modified_time" content="2022-08-12T12:37:41.046Z">
<meta property="article:author" content="欧阳">
<meta property="article:tag" content="VBA代码">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="http://vvvvvv.top/img/4.jpg"><link rel="shortcut icon" href="/img/favicon.png"><link rel="canonical" href="http://vvvvvv.top/2022/08/08/4fee4ae1e938/"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox.min.css" media="print" onload="this.media='all'"><script>const GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: {"path":"/search.xml","preload":false,"languages":{"hits_empty":"找不到您查询的内容：${query}"}},
  translate: {"defaultEncoding":1,"translateDelay":0,"msgToTraditionalChinese":"繁","msgToSimplifiedChinese":"简"},
  noticeOutdate: {"limitDay":200,"position":"top","messagePrev":"It has been","messageNext":"days since the last update, the content of the article may be outdated."},
  highlight: {"plugin":"highlighjs","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":200},
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '天',
  date_suffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: {"limitCount":250,"languages":{"author":"作者: 欧阳","link":"链接: ","source":"来源: 6卫的栖息地","info":"著作权归作者所有。商业转载请联系作者获得授权，非商业转载请注明出处。"}},
  lightbox: 'fancybox',
  Snackbar: undefined,
  source: {
    justifiedGallery: {
      js: 'https://cdn.jsdelivr.net/npm/flickr-justified-gallery/dist/fjGallery.min.js',
      css: 'https://cdn.jsdelivr.net/npm/flickr-justified-gallery/dist/fjGallery.min.css'
    }
  },
  isPhotoFigcaption: false,
  islazyload: false,
  isAnchor: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: '非常实用Excel VBA 100个经典函数源码大全',
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  postUpdate: '2022-08-12 20:37:41'
}</script><noscript><style type="text/css">
  #nav {
    opacity: 1
  }
  .justified-gallery img {
    opacity: 1
  }

  #recent-posts time,
  #post-meta time {
    display: inline !important
  }
</style></noscript><script>(win=>{
    win.saveToLocal = {
      set: function setWithExpiry(key, value, ttl) {
        if (ttl === 0) return
        const now = new Date()
        const expiryDay = ttl * 86400000
        const item = {
          value: value,
          expiry: now.getTime() + expiryDay,
        }
        localStorage.setItem(key, JSON.stringify(item))
      },

      get: function getWithExpiry(key) {
        const itemStr = localStorage.getItem(key)

        if (!itemStr) {
          return undefined
        }
        const item = JSON.parse(itemStr)
        const now = new Date()

        if (now.getTime() > item.expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return item.value
      }
    }
  
    win.getScript = url => new Promise((resolve, reject) => {
      const script = document.createElement('script')
      script.src = url
      script.async = true
      script.onerror = reject
      script.onload = script.onreadystatechange = function() {
        const loadState = this.readyState
        if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
        script.onload = script.onreadystatechange = null
        resolve()
      }
      document.head.appendChild(script)
    })
  
      win.activateDarkMode = function () {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      win.activateLightMode = function () {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }
      const t = saveToLocal.get('theme')
    
          if (t === 'dark') activateDarkMode()
          else if (t === 'light') activateLightMode()
        
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
    const detectApple = () => {
      if(/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)){
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
    })(window)</script><meta name="generator" content="Hexo 6.2.0"><link rel="alternate" href="/atom.xml" title="6卫的栖息地" type="application/atom+xml">
</head><body><div id="loading-box"><div class="loading-left-bg"></div><div class="loading-right-bg"></div><div class="spinner-box"><div class="configure-border-1"><div class="configure-core"></div></div><div class="configure-border-2"><div class="configure-core"></div></div><div class="loading-word">加载中...</div></div></div><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img is-center"><img src="/img/logo.png" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="sidebar-site-data site-data is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">93</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">40</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">11</div></a></div><hr/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page group hide" href="javascript:void(0);"><i class="fa-fw fa fa-heartbeat"></i><span> 文档</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 存档</span></a></li><li><a class="site-page child" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></li><li><a class="site-page child" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> 链接</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> 关于</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="not-top-img" id="page-header"><nav id="nav"><span id="blog_name"><a id="site-name" href="/">6卫的栖息地</a></span><div id="menus"><div id="search-button"><a class="site-page social-icon search"><i class="fas fa-search fa-fw"></i><span> 搜索</span></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page group hide" href="javascript:void(0);"><i class="fa-fw fa fa-heartbeat"></i><span> 文档</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 存档</span></a></li><li><a class="site-page child" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></li><li><a class="site-page child" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> 链接</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> 关于</span></a></div></div><div id="toggle-menu"><a class="site-page"><i class="fas fa-bars fa-fw"></i></a></div></div></nav></header><main class="layout" id="content-inner"><div id="post"><div id="post-info"><h1 class="post-title">非常实用Excel VBA 100个经典函数源码大全</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" datetime="2022-08-07T16:16:32.000Z" title="发表于 2022-08-08 00:16:32">2022-08-08</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2022-08-12T12:37:41.046Z" title="更新于 2022-08-12 20:37:41">2022-08-12</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/VBA%E7%BC%96%E7%A8%8B/">VBA编程</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title="非常实用Excel VBA 100个经典函数源码大全"><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">阅读量:</span><span id="busuanzi_value_page_pv"><i class="fa-solid fa-spinner fa-spin"></i></span></span></div></div></div><article class="post-content" id="article-container"><p>原作者：ExcelChamps<br>原英文网址：<a target="_blank" rel="noopener" href="https://excelchamps.com/blog/useful-macro-codes-for-vba-newcomers/">原文</a><br>翻译及整理：<br>@小辣椒高效Office</p>
<h4 id="1-添加序列号"><a href="#1-添加序列号" class="headerlink" title="1. 添加序列号"></a>1. 添加序列号</h4><figure class="highlight vbnet"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">Sub</span> AddSerialNumbers()</span><br><span class="line">	<span class="keyword">Dim</span> i <span class="keyword">As</span> <span class="type">Integer</span></span><br><span class="line">	<span class="keyword">On</span> <span class="keyword">Error</span> <span class="keyword">GoTo</span> Last</span><br><span class="line">	i = InputBox(<span class="string">&quot;Enter Value&quot;</span>, <span class="string">&quot;Enter Serial Numbers&quot;</span>)</span><br><span class="line">	<span class="keyword">For</span> i = <span class="number">1</span> <span class="keyword">To</span> i</span><br><span class="line">		ActiveCell.Value = i</span><br><span class="line">		ActiveCell.Offset(<span class="number">1</span>, <span class="number">0</span>).Activate</span><br><span class="line">	<span class="keyword">Next</span> i</span><br><span class="line">	Last:<span class="keyword">Exit</span> <span class="keyword">Sub</span></span><br><span class="line"><span class="keyword">End</span> <span class="keyword">Sub</span></span><br></pre></td></tr></table></figure>
<p>此宏代码将帮助您在Excel工作表中自动添加序列号，如果您使用大数据，这对您有所帮助。要使用此代码，您需要选择要从中开始序列号的单元格，当您运行此代码时，它会显示一个消息框，您需要在其中输入序列号的最高数字，然后单击“确定”。单击“确定”后，它只需运行一个循环，然后向下向单元格添加序列号列表。</p>
<h4 id="2-插入多列"><a href="#2-插入多列" class="headerlink" title="2. 插入多列"></a>2. 插入多列</h4><figure class="highlight vbnet"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">Sub</span> InsertMultipleColumns()</span><br><span class="line">	<span class="keyword">Dim</span> i <span class="keyword">As</span> <span class="type">Integer</span></span><br><span class="line">	<span class="keyword">Dim</span> j <span class="keyword">As</span> <span class="type">Integer</span></span><br><span class="line">	ActiveCell.EntireColumn.<span class="keyword">Select</span></span><br><span class="line">	<span class="keyword">On</span> <span class="keyword">Error</span> <span class="keyword">GoTo</span> Last</span><br><span class="line">	i = InputBox(<span class="string">&quot;Enter number of columns to insert&quot;</span>, <span class="string">&quot;Insert Columns&quot;</span>)</span><br><span class="line">	<span class="keyword">For</span> j = <span class="number">1</span> <span class="keyword">To</span> i</span><br><span class="line">		Selection.Insert Shift:=xlToRight, CopyOrigin:=xlFormatFromRightorAbove</span><br><span class="line">	<span class="keyword">Next</span> j</span><br><span class="line">	Last: <span class="keyword">Exit</span> <span class="keyword">Sub</span></span><br><span class="line"><span class="keyword">End</span> <span class="keyword">Sub</span> <span class="comment">&#x27;Translate By Tmtony</span></span><br></pre></td></tr></table></figure>
<p>此代码可帮助您一次单击输入多个列。运行此代码时，它会询问您要添加的列数，当您单击“确定”时，它会在所选单元格后添加输入的列数。如果要在所选单元格之前添加列，请将代码中的 xlToRight 替换为 xlToLeft。</p>
<h4 id="3-插入多行"><a href="#3-插入多行" class="headerlink" title="3. 插入多行"></a>3. 插入多行</h4><figure class="highlight vbnet"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">Sub</span> InsertMultipleRows()</span><br><span class="line">	<span class="keyword">Dim</span> i <span class="keyword">As</span> <span class="type">Integer</span></span><br><span class="line">	<span class="keyword">Dim</span> j <span class="keyword">As</span> <span class="type">Integer</span></span><br><span class="line">	ActiveCell.EntireRow.<span class="keyword">Select</span></span><br><span class="line">	<span class="keyword">On</span> <span class="keyword">Error</span> <span class="keyword">GoTo</span> Last</span><br><span class="line">	i = InputBox(<span class="string">&quot;Enter number of columns to insert&quot;</span>, <span class="string">&quot;Insert Columns&quot;</span>)</span><br><span class="line">	<span class="keyword">For</span> j = <span class="number">1</span> <span class="keyword">To</span> i</span><br><span class="line">		Selection.Insert Shift:=xlToDown, CopyOrigin:=xlFormatFromRightorAbove</span><br><span class="line">	<span class="keyword">Next</span> j</span><br><span class="line">	Last: <span class="keyword">Exit</span> <span class="keyword">Sub</span></span><br><span class="line"><span class="keyword">End</span> <span class="keyword">Sub</span></span><br></pre></td></tr></table></figure>

<p>使用此代码，您可以在工作表中输入多行。运行此代码时，可以输入要插入的行数，并确保从中选择要插入新行的单元格。如果要在所选单元格之前添加行，请将代码中的 xlToDown 替换为 xlToUp。</p>
<h4 id="4-自动调整列"><a href="#4-自动调整列" class="headerlink" title="4. 自动调整列"></a>4. 自动调整列</h4><figure class="highlight mathematica"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">Sub</span> <span class="variable">AutoFitColumns</span><span class="punctuation">(</span><span class="punctuation">)</span></span><br><span class="line">	<span class="built_in">Cells</span><span class="operator">.</span><span class="built_in">Select</span></span><br><span class="line">	<span class="built_in">Cells</span><span class="operator">.</span><span class="variable">EntireColumn</span><span class="operator">.</span><span class="variable">AutoFit</span></span><br><span class="line"><span class="built_in">End</span> <span class="variable">Sub</span></span><br></pre></td></tr></table></figure>
<p>此代码可快速自动填充工作表中的所有列。因此，当您运行此代码时，它将选择工作表中的所有单元格并立即自动填充所有列。</p>
<h4 id="5-自动调整行"><a href="#5-自动调整行" class="headerlink" title="5. 自动调整行"></a>5. 自动调整行</h4><figure class="highlight mathematica"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">Sub</span> <span class="variable">AutoFitRows</span><span class="punctuation">(</span><span class="punctuation">)</span></span><br><span class="line">	<span class="built_in">Cells</span><span class="operator">.</span><span class="built_in">Select</span></span><br><span class="line">	<span class="built_in">Cells</span><span class="operator">.</span><span class="variable">EntireRow</span><span class="operator">.</span><span class="variable">AutoFit</span></span><br><span class="line"><span class="built_in">End</span> <span class="variable">Sub</span></span><br></pre></td></tr></table></figure>
<p>您可以使用此代码自动调整工作表中的所有行。当您运行此代码时，它将选择工作表中的所有单元格，并立即自动调整所有行。</p>
<h4 id="6-删除文字绕排"><a href="#6-删除文字绕排" class="headerlink" title="6. 删除文字绕排"></a>6. 删除文字绕排</h4><figure class="highlight isbl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">Sub</span> <span class="function"><span class="title">RemoveTextWrap</span>()</span></span><br><span class="line">	<span class="function"><span class="title">Range</span>(<span class="string">&quot;A1&quot;</span>).WrapText = <span class="variable"><span class="literal">False</span></span></span></span><br><span class="line"><span class="function"><span class="variable">End</span> <span class="variable">Sub</span></span></span><br></pre></td></tr></table></figure>
<p>此代码将帮助您只需单击一下即可从整个工作表中删除文本换行。它将首先选择所有列，然后删除文本换行并自动适应所有行和列。还有一个快捷方式可以使用（Alt H W），但是如果您将此代码添加到QAT，则它不仅仅是键盘快捷方式。</p>
<h4 id="7-取消合并单元格"><a href="#7-取消合并单元格" class="headerlink" title="7. 取消合并单元格"></a>7. 取消合并单元格</h4><figure class="highlight vbnet"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">Sub</span> UnmergeCells()</span><br><span class="line">	Selection.UnMerge</span><br><span class="line"><span class="keyword">End</span> <span class="keyword">Sub</span> <span class="comment">&#x27;Translate By Tmtony</span></span><br></pre></td></tr></table></figure>

<p>此代码仅使用“主页”选项卡上的取消合并选项。使用此代码的好处是可以将其添加到 QAT 并取消合并所选内容中的所有单元格。如果要取消合并特定范围，可以通过替换单词选择在代码中定义该范围。</p>
<h4 id="8-打开计算器"><a href="#8-打开计算器" class="headerlink" title="8. 打开计算器"></a>8. 打开计算器</h4><figure class="highlight isbl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">Sub</span> <span class="function"><span class="title">OpenCalculator</span>()</span></span><br><span class="line">	<span class="variable"><span class="class">Application</span>.ActivateMicrosoftApp</span> <span class="variable">Index</span>:=<span class="number">0</span></span><br><span class="line"><span class="variable">End</span> <span class="variable">Sub</span></span><br></pre></td></tr></table></figure>
<p>在Windows中，有一个特定的计算器，通过使用此宏代码，您可以直接从Excel打开该计算器。正如我所提到的，它适用于Windows，如果您在MAC版本的VBA中运行此代码，您将收到错误。</p>
<h4 id="9-添加页眉-x2F-页脚日期"><a href="#9-添加页眉-x2F-页脚日期" class="headerlink" title="9. 添加页眉&#x2F;页脚日期"></a>9. 添加页眉&#x2F;页脚日期</h4><figure class="highlight x86asm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">Sub</span> DateInHeader()</span><br><span class="line">	With ActiveSheet<span class="number">.</span>PageSetup</span><br><span class="line"><span class="meta">		.LeftHeader</span> = <span class="string">&quot;&quot;</span></span><br><span class="line"><span class="meta">		.CenterHeader</span> = <span class="string">&quot;&amp;D&quot;</span></span><br><span class="line"><span class="meta">		.RightHeader</span> = <span class="string">&quot;&quot;</span></span><br><span class="line"><span class="meta">		.LeftFooter</span> = <span class="string">&quot;&quot;</span></span><br><span class="line"><span class="meta">		.CenterFooter</span> = <span class="string">&quot;&quot;</span></span><br><span class="line"><span class="meta">		.RightFooter</span> = <span class="string">&quot;&quot;</span></span><br><span class="line">	End With</span><br><span class="line">End <span class="keyword">Sub</span></span><br></pre></td></tr></table></figure>
<p>此宏在运行标头时向其添加日期。它只是使用标签”</p>
<h4 id="10-自定义页眉-x2F-页脚"><a href="#10-自定义页眉-x2F-页脚" class="headerlink" title="10. 自定义页眉&#x2F;页脚"></a>10. 自定义页眉&#x2F;页脚</h4><figure class="highlight vbnet"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">Sub</span> CustomHeader()</span><br><span class="line">	<span class="keyword">Dim</span> myText <span class="keyword">As</span> <span class="type">String</span></span><br><span class="line">	myText = InputBox(<span class="string">&quot;Enter your text here&quot;</span>, <span class="string">&quot;Enter Text&quot;</span>)</span><br><span class="line">	<span class="keyword">With</span> ActiveSheet.PageSetup</span><br><span class="line">		.LeftHeader = <span class="string">&quot;&quot;</span></span><br><span class="line">		.CenterHeader = myText</span><br><span class="line">		.RightHeader = <span class="string">&quot;&quot;</span></span><br><span class="line">		.LeftFooter = <span class="string">&quot;&quot;</span></span><br><span class="line">		.CenterFooter = <span class="string">&quot;&quot;</span></span><br><span class="line">		.RightFooter = <span class="string">&quot;&quot;</span></span><br><span class="line">	<span class="keyword">End</span> <span class="keyword">With</span></span><br><span class="line"><span class="keyword">End</span> <span class="keyword">Sub</span></span><br></pre></td></tr></table></figure>
<p>运行此代码时，它会显示一个输入框，要求您输入要添加为标题的文本，输入后单击“确定”。如果您仔细看到这一点，则有六行不同的代码来选择页眉或页脚的位置。假设您要添加左页脚而不是中心页眉，只需将“myText”替换为代码行，方法是从那里替换“”。如果您发现这些代码有用，您可以支持我们创建更多这样的教程。格式化代码 这些VBA代码将帮助您使用一些特定的条件和条件来格式化单元格和范围。</p>
<h4 id="11-从选择中突出显示重复项"><a href="#11-从选择中突出显示重复项" class="headerlink" title="11. 从选择中突出显示重复项"></a>11. 从选择中突出显示重复项</h4><figure class="highlight mathematica"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">Sub</span> <span class="variable">HighlightDuplicateValues</span><span class="punctuation">(</span><span class="punctuation">)</span></span><br><span class="line">	<span class="variable">Dim</span> <span class="variable">myRange</span> <span class="variable">As</span> <span class="built_in">Range</span></span><br><span class="line">	<span class="variable">Dim</span> <span class="variable">myCell</span> <span class="variable">As</span> <span class="built_in">Range</span></span><br><span class="line">	<span class="built_in">Set</span> <span class="variable">myRange</span> <span class="operator">=</span> <span class="built_in">Selection</span></span><br><span class="line">	<span class="built_in">For</span> <span class="variable">Each</span> <span class="variable">myCell</span> <span class="built_in">In</span> <span class="variable">myRange</span></span><br><span class="line">		<span class="built_in">If</span> <span class="variable">WorksheetFunction</span><span class="operator">.</span><span class="variable">CountIf</span><span class="punctuation">(</span><span class="variable">myRange</span><span class="operator">,</span> <span class="variable">myCell</span><span class="operator">.</span><span class="built_in">Value</span><span class="punctuation">)</span> <span class="operator">&gt;</span> <span class="number">1</span> <span class="variable">Then</span></span><br><span class="line">			<span class="variable">myCell</span><span class="operator">.</span><span class="variable">Interior</span><span class="operator">.</span><span class="variable">ColorIndex</span> <span class="operator">=</span> <span class="number">36</span></span><br><span class="line">		<span class="built_in">End</span> <span class="built_in">If</span></span><br><span class="line">	<span class="built_in">Next</span> <span class="variable">myCell</span></span><br><span class="line"><span class="built_in">End</span> <span class="variable">Sub</span></span><br></pre></td></tr></table></figure>
<p>此宏将检查您选择的每个单元格并突出显示重复值。您还可以更改代码中的颜色。</p>
<h4 id="12-突出显示活动行和列"><a href="#12-突出显示活动行和列" class="headerlink" title="12. 突出显示活动行和列"></a>12. 突出显示活动行和列</h4><figure class="highlight vbnet"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">Private</span> <span class="keyword">Sub</span> Worksheet_BeforeDoubleClick(<span class="keyword">ByVal</span> Target <span class="keyword">As</span> Range, Cancel <span class="keyword">As</span> <span class="type">Boolean</span>)</span><br><span class="line">	<span class="keyword">Dim</span> strRange <span class="keyword">As</span> <span class="type">String</span></span><br><span class="line">	strRange = Target.Cells.Address &amp; <span class="string">&quot;,&quot;</span> &amp; _</span><br><span class="line">	Target.Cells.EntireColumn.Address &amp; <span class="string">&quot;,&quot;</span> &amp; _</span><br><span class="line">	Target.Cells.EntireRow.Address</span><br><span class="line">	Range(strRange).<span class="keyword">Select</span></span><br><span class="line"><span class="keyword">End</span> <span class="keyword">Sub</span> <span class="comment">&#x27;Translate By Tmtony</span></span><br></pre></td></tr></table></figure>
<p>每当我必须分析数据表时，我真的很喜欢使用此宏代码。以下是应用此代码的快速步骤。打开 VBE （ALT F11）。转到“项目资源管理器”（Ctrl R，如果隐藏）。选择您的工作簿</p>
<h4 id="13-突出显示前-10-个值"><a href="#13-突出显示前-10-个值" class="headerlink" title="13. 突出显示前 10 个值"></a>13. 突出显示前 10 个值</h4><figure class="highlight mathematica"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">Sub</span> <span class="variable">TopTen</span><span class="punctuation">(</span><span class="punctuation">)</span></span><br><span class="line">	<span class="built_in">Selection</span><span class="operator">.</span><span class="variable">FormatConditions</span><span class="operator">.</span><span class="variable">AddTop10</span></span><br><span class="line">	<span class="built_in">Selection</span><span class="operator">.</span><span class="variable">FormatConditions</span><span class="punctuation">(</span><span class="built_in">Selection</span><span class="operator">.</span><span class="variable">FormatConditions</span><span class="operator">.</span><span class="built_in">Count</span><span class="punctuation">)</span><span class="operator">.</span><span class="variable">S</span></span><br><span class="line">	<span class="variable">tFirstPriority</span></span><br><span class="line">	<span class="built_in">With</span> <span class="built_in">Selection</span><span class="operator">.</span><span class="variable">FormatConditions</span><span class="punctuation">(</span><span class="number">1</span><span class="punctuation">)</span></span><br><span class="line">		<span class="operator">.</span><span class="variable">TopBottom</span> <span class="operator">=</span> <span class="variable">xlTop10Top</span></span><br><span class="line">		<span class="operator">.</span><span class="variable">Rank</span> <span class="operator">=</span> <span class="number">10</span></span><br><span class="line">		<span class="operator">.</span><span class="variable">Percent</span> <span class="operator">=</span> <span class="built_in">False</span></span><br><span class="line">	<span class="built_in">End</span> <span class="built_in">With</span></span><br><span class="line">	<span class="built_in">With</span> <span class="built_in">Selection</span><span class="operator">.</span><span class="variable">FormatConditions</span><span class="punctuation">(</span><span class="number">1</span><span class="punctuation">)</span><span class="operator">.</span><span class="built_in">Font</span></span><br><span class="line">		<span class="operator">.</span><span class="variable">Color</span> <span class="operator">=</span> <span class="operator">-</span><span class="number">16752384</span></span><br><span class="line">		<span class="operator">.</span><span class="variable">TintAndShade</span> <span class="operator">=</span> <span class="number">0</span></span><br><span class="line">	<span class="built_in">End</span> <span class="built_in">With</span></span><br><span class="line">	<span class="built_in">With</span> <span class="built_in">Selection</span><span class="operator">.</span><span class="variable">FormatConditions</span><span class="punctuation">(</span><span class="number">1</span><span class="punctuation">)</span><span class="operator">.</span><span class="variable">Interior</span></span><br><span class="line">		<span class="operator">.</span><span class="variable">PatternColorIndex</span> <span class="operator">=</span> <span class="variable">xlAutomatic</span></span><br><span class="line">		<span class="operator">.</span><span class="variable">Color</span> <span class="operator">=</span> <span class="number">13561798</span></span><br><span class="line">		<span class="operator">.</span><span class="variable">TintAndShade</span> <span class="operator">=</span> <span class="number">0</span></span><br><span class="line">	<span class="built_in">End</span> <span class="built_in">With</span></span><br><span class="line">	<span class="built_in">Selection</span><span class="operator">.</span><span class="variable">FormatConditions</span><span class="punctuation">(</span><span class="number">1</span><span class="punctuation">)</span><span class="operator">.</span><span class="variable">StopIfTrue</span> <span class="operator">=</span> <span class="built_in">False</span></span><br><span class="line"><span class="built_in">End</span> <span class="variable">Sub</span></span><br></pre></td></tr></table></figure>
<p>只需选择一个范围并运行此宏，它将以绿色突出显示前10个值。</p>
<h4 id="14-突出显示命名范围"><a href="#14-突出显示命名范围" class="headerlink" title="14. 突出显示命名范围"></a>14. 突出显示命名范围</h4><figure class="highlight vbnet"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">Sub</span> HighlightRanges()</span><br><span class="line">	<span class="keyword">Dim</span> RangeName <span class="keyword">As</span> Name</span><br><span class="line">	<span class="keyword">Dim</span> HighlightRange <span class="keyword">As</span> Range</span><br><span class="line">	<span class="keyword">On</span> <span class="keyword">Error</span> <span class="keyword">Resume</span> <span class="keyword">Next</span></span><br><span class="line">	<span class="keyword">For</span> <span class="keyword">Each</span> RangeName <span class="keyword">In</span> ActiveWorkbook.Names</span><br><span class="line">		<span class="keyword">Set</span> HighlightRange = RangeName.RefersToRange</span><br><span class="line">		HighlightRange.Interior.ColorIndex = <span class="number">36</span></span><br><span class="line">	<span class="keyword">Next</span> RangeName</span><br><span class="line"><span class="keyword">End</span> <span class="keyword">Sub</span></span><br></pre></td></tr></table></figure>
<p>如果您不确定工作表中有多少个命名区域，则可以使用此代码突出显示所有这些命名区域。</p>
<h4 id="15-突出显示大于值"><a href="#15-突出显示大于值" class="headerlink" title="15. 突出显示大于值"></a>15. 突出显示大于值</h4><figure class="highlight mathematica"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">Sub</span> <span class="variable">HighlightGreaterThanValues</span><span class="punctuation">(</span><span class="punctuation">)</span></span><br><span class="line">	<span class="variable">Dim</span> <span class="variable">i</span> <span class="variable">As</span> <span class="built_in">Integer</span></span><br><span class="line">	<span class="variable">i</span> <span class="operator">=</span> <span class="variable">InputBox</span><span class="punctuation">(</span><span class="string">&quot;Enter Greater Than Value&quot;</span><span class="operator">,</span> <span class="string">&quot;Enter Value&quot;</span><span class="punctuation">)</span></span><br><span class="line">	<span class="built_in">Selection</span><span class="operator">.</span><span class="variable">FormatConditions</span><span class="operator">.</span><span class="built_in">Delete</span></span><br><span class="line">	<span class="built_in">Selection</span><span class="operator">.</span><span class="variable">FormatConditions</span><span class="operator">.</span><span class="variable">Add</span> <span class="variable">Type</span><span class="operator">:=</span><span class="variable">xlCellValue</span><span class="operator">,</span> <span class="type">_</span></span><br><span class="line">	<span class="variable">Operator</span><span class="operator">:=</span><span class="variable">xlGreater</span><span class="operator">,</span> <span class="variable">Formula1</span><span class="operator">:=</span><span class="variable">i</span></span><br><span class="line">	<span class="built_in">Selection</span><span class="operator">.</span><span class="variable">FormatConditions</span><span class="punctuation">(</span><span class="built_in">Selection</span><span class="operator">.</span><span class="variable">FormatConditions</span><span class="operator">.</span><span class="built_in">Count</span><span class="punctuation">)</span><span class="operator">.</span><span class="variable">S</span></span><br><span class="line">	<span class="variable">tFirstPriority</span></span><br><span class="line">	<span class="built_in">With</span> <span class="built_in">Selection</span><span class="operator">.</span><span class="variable">FormatConditions</span><span class="punctuation">(</span><span class="number">1</span><span class="punctuation">)</span></span><br><span class="line">		<span class="operator">.</span><span class="built_in">Font</span><span class="operator">.</span><span class="variable">Color</span> <span class="operator">=</span> <span class="variable">RGB</span><span class="punctuation">(</span><span class="number">0</span><span class="operator">,</span> <span class="number">0</span><span class="operator">,</span> <span class="number">0</span><span class="punctuation">)</span></span><br><span class="line">		<span class="operator">.</span><span class="variable">Interior</span><span class="operator">.</span><span class="variable">Color</span> <span class="operator">=</span> <span class="variable">RGB</span><span class="punctuation">(</span><span class="number">31</span><span class="operator">,</span> <span class="number">218</span><span class="operator">,</span> <span class="number">154</span><span class="punctuation">)</span></span><br><span class="line">	<span class="built_in">End</span> <span class="built_in">With</span></span><br><span class="line"><span class="built_in">End</span> <span class="variable">Sub</span></span><br></pre></td></tr></table></figure>
<p>运行此代码后，它将要求您输入要从中突出显示所有较大值的值。</p>
<h4 id="16-突出显示低于以下值的值"><a href="#16-突出显示低于以下值的值" class="headerlink" title="16. 突出显示低于以下值的值"></a>16. 突出显示低于以下值的值</h4><figure class="highlight mathematica"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">Sub</span> <span class="variable">HighlightLowerThanValues</span><span class="punctuation">(</span><span class="punctuation">)</span></span><br><span class="line">	<span class="variable">Dim</span> <span class="variable">i</span> <span class="variable">As</span> <span class="built_in">Integer</span></span><br><span class="line">	<span class="variable">i</span> <span class="operator">=</span> <span class="variable">InputBox</span><span class="punctuation">(</span><span class="string">&quot;Enter Lower Than Value&quot;</span><span class="operator">,</span> <span class="string">&quot;Enter Value&quot;</span><span class="punctuation">)</span></span><br><span class="line">	<span class="built_in">Selection</span><span class="operator">.</span><span class="variable">FormatConditions</span><span class="operator">.</span><span class="built_in">Delete</span></span><br><span class="line">	<span class="built_in">Selection</span><span class="operator">.</span><span class="variable">FormatConditions</span><span class="operator">.</span><span class="variable">Add</span> <span class="type">_</span></span><br><span class="line">	<span class="variable">Type</span><span class="operator">:=</span><span class="variable">xlCellValue</span><span class="operator">,</span> <span class="type">_</span></span><br><span class="line">	<span class="variable">Operator</span><span class="operator">:=</span><span class="variable">xlLower</span><span class="operator">,</span> <span class="type">_</span></span><br><span class="line">	<span class="variable">Formula1</span><span class="operator">:=</span><span class="variable">i</span></span><br><span class="line">	<span class="built_in">Selection</span><span class="operator">.</span><span class="variable">FormatConditions</span><span class="punctuation">(</span><span class="built_in">Selection</span><span class="operator">.</span><span class="variable">FormatConditions</span><span class="operator">.</span><span class="built_in">Count</span><span class="punctuation">)</span><span class="operator">.</span><span class="variable">S</span></span><br><span class="line">	<span class="variable">tFirstPriority</span></span><br><span class="line">	<span class="built_in">With</span> <span class="built_in">Selection</span><span class="operator">.</span><span class="variable">FormatConditions</span><span class="punctuation">(</span><span class="number">1</span><span class="punctuation">)</span></span><br><span class="line">		<span class="operator">.</span><span class="built_in">Font</span><span class="operator">.</span><span class="variable">Color</span> <span class="operator">=</span> <span class="variable">RGB</span><span class="punctuation">(</span><span class="number">0</span><span class="operator">,</span> <span class="number">0</span><span class="operator">,</span> <span class="number">0</span><span class="punctuation">)</span></span><br><span class="line">		<span class="operator">.</span><span class="variable">Interior</span><span class="operator">.</span><span class="variable">Color</span> <span class="operator">=</span> <span class="variable">RGB</span><span class="punctuation">(</span><span class="number">217</span><span class="operator">,</span> <span class="number">83</span><span class="operator">,</span> <span class="number">79</span><span class="punctuation">)</span></span><br><span class="line">	<span class="built_in">End</span> <span class="built_in">With</span></span><br><span class="line"><span class="built_in">End</span> <span class="variable">Sub</span></span><br></pre></td></tr></table></figure>
<p>运行此代码后，它将要求您输入要从中突出显示所有较低值的值。</p>
<h4 id="17-突出显示负数"><a href="#17-突出显示负数" class="headerlink" title="17. 突出显示负数"></a>17. 突出显示负数</h4><figure class="highlight mathematica"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">Sub</span> <span class="variable">highlightNegativeNumbers</span><span class="punctuation">(</span><span class="punctuation">)</span></span><br><span class="line">	<span class="variable">Dim</span> <span class="variable">Rng</span> <span class="variable">As</span> <span class="built_in">Range</span></span><br><span class="line">	<span class="built_in">For</span> <span class="variable">Each</span> <span class="variable">Rng</span> <span class="built_in">In</span> <span class="built_in">Selection</span></span><br><span class="line">		<span class="built_in">If</span> <span class="variable">WorksheetFunction</span><span class="operator">.</span><span class="variable">IsNumber</span><span class="punctuation">(</span><span class="variable">Rng</span><span class="punctuation">)</span> <span class="variable">Then</span></span><br><span class="line">			<span class="built_in">If</span> <span class="variable">Rng</span><span class="operator">.</span><span class="built_in">Value</span> <span class="operator">&lt;</span> <span class="number">0</span> <span class="variable">Then</span></span><br><span class="line">				<span class="variable">Rng</span><span class="operator">.</span><span class="built_in">Font</span><span class="operator">.</span><span class="variable">Color</span><span class="operator">=</span> <span class="operator">-</span><span class="number">16776961</span></span><br><span class="line">			<span class="built_in">End</span> <span class="built_in">If</span></span><br><span class="line">		<span class="built_in">End</span> <span class="built_in">If</span></span><br><span class="line">	<span class="built_in">Next</span></span><br><span class="line"><span class="built_in">End</span> <span class="variable">Sub</span> <span class="operator">&#x27;</span><span class="built_in">Translate</span> <span class="variable">By</span> <span class="variable">Tmtony</span></span><br></pre></td></tr></table></figure>
<p>选择单元格区域并运行此代码。它将检查范围中的每个单元格，并突出显示您有负数的所有单元格。</p>
<h4 id="18-突出显示特定文本"><a href="#18-突出显示特定文本" class="headerlink" title="18. 突出显示特定文本"></a>18. 突出显示特定文本</h4><figure class="highlight vbnet"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">Sub</span> highlightValue()</span><br><span class="line">	<span class="keyword">Dim</span> myStr <span class="keyword">As</span> <span class="type">String</span></span><br><span class="line">	<span class="keyword">Dim</span> myRg <span class="keyword">As</span> range</span><br><span class="line">	<span class="keyword">Dim</span> myTxt <span class="keyword">As</span> <span class="type">String</span></span><br><span class="line">	<span class="keyword">Dim</span> myCell <span class="keyword">As</span> range</span><br><span class="line">	<span class="keyword">Dim</span> myChar <span class="keyword">As</span> <span class="type">String</span></span><br><span class="line">	<span class="keyword">Dim</span> I <span class="keyword">As</span> <span class="type">Long</span></span><br><span class="line">	<span class="keyword">Dim</span> J <span class="keyword">As</span> <span class="type">Long</span></span><br><span class="line">	<span class="keyword">On</span> <span class="keyword">Error</span> <span class="keyword">Resume</span> <span class="keyword">Next</span></span><br><span class="line">	<span class="keyword">If</span> ActiveWindow.RangeSelection.Count &gt; <span class="number">1</span> <span class="keyword">Then</span></span><br><span class="line">		myTxt = ActiveWindow.RangeSelection.AddressLocal</span><br><span class="line">		<span class="keyword">Else</span></span><br><span class="line">		myTxt = ActiveSheet.UsedRange.AddressLocal</span><br><span class="line">	<span class="keyword">End</span> <span class="keyword">If</span></span><br><span class="line">	LInput: <span class="keyword">Set</span> myRg = _</span><br><span class="line">	Application.InputBox _</span><br><span class="line">	(<span class="string">&quot;please select the data range:&quot;</span>, <span class="string">&quot;Selection Required&quot;</span>, myTxt, , , , , <span class="number">8</span>)</span><br><span class="line">	<span class="keyword">If</span> myRg <span class="built_in">Is</span> <span class="literal">Nothing</span> <span class="keyword">Then</span> 		<span class="keyword">Exit</span> <span class="keyword">Sub</span></span><br><span class="line">		<span class="keyword">If</span> myRg.Areas.Count &gt; <span class="number">1</span> <span class="keyword">Then</span></span><br><span class="line">			MsgBox <span class="string">&quot;not support multiple columns&quot;</span></span><br><span class="line">			<span class="keyword">GoTo</span> Linput</span><br><span class="line">		<span class="keyword">End</span> <span class="keyword">If</span></span><br><span class="line">		<span class="keyword">If</span> myRg.Columns.Count &lt;&gt; <span class="number">2</span> <span class="keyword">Then</span></span><br><span class="line">			MsgBox <span class="string">&quot;the selected range can only contain two columns &quot;</span></span><br><span class="line">			<span class="keyword">GoTo</span> Linput</span><br><span class="line">		<span class="keyword">End</span> <span class="keyword">If</span></span><br><span class="line">		<span class="keyword">For</span> I = <span class="number">0</span> <span class="keyword">To</span> myRg.Rows.Count - <span class="number">1</span></span><br><span class="line">			myStr = myRg.range(<span class="string">&quot;B1&quot;</span>).Offset(I, <span class="number">0</span>).Value</span><br><span class="line">			<span class="keyword">With</span> myRg.range(<span class="string">&quot;A1&quot;</span>).Offset(I, <span class="number">0</span>)</span><br><span class="line">				.Font.ColorIndex = <span class="number">1</span></span><br><span class="line">				<span class="keyword">For</span> J = <span class="number">1</span> <span class="keyword">To</span> Len(.<span class="keyword">Text</span>)</span><br><span class="line">					<span class="keyword">Mid</span>(.<span class="keyword">Text</span>, J, Len(myStr)) = myStrThen</span><br><span class="line">					.Characters(J, Len(myStr)).Font.ColorIndex = <span class="number">3</span></span><br><span class="line">				<span class="keyword">Next</span></span><br><span class="line">			<span class="keyword">End</span> <span class="keyword">With</span></span><br><span class="line">		<span class="keyword">Next</span> I</span><br><span class="line">		<span class="keyword">End</span> <span class="keyword">Sub</span></span><br></pre></td></tr></table></figure>
<p>假设您有一个大型数据集，并且想要检查特定值。为此，您可以使用此代码。运行它时，您将获得一个输入框，用于输入要搜索的值。</p>
<h4 id="19-突出显示带有注释的单元格"><a href="#19-突出显示带有注释的单元格" class="headerlink" title="19. 突出显示带有注释的单元格"></a>19. 突出显示带有注释的单元格</h4><figure class="highlight mathematica"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">Sub</span> <span class="variable">highlightCommentCells</span><span class="punctuation">(</span><span class="punctuation">)</span></span><br><span class="line">	<span class="built_in">Selection</span><span class="operator">.</span><span class="variable">SpecialCells</span><span class="punctuation">(</span><span class="variable">xlCellTypeComments</span><span class="punctuation">)</span><span class="operator">.</span><span class="built_in">Select</span></span><br><span class="line">	<span class="built_in">Selection</span><span class="operator">.</span><span class="built_in">Style</span><span class="operator">=</span> <span class="string">&quot;Note&quot;</span></span><br><span class="line"><span class="built_in">End</span> <span class="variable">Sub</span></span><br></pre></td></tr></table></figure>
<p>若要突出显示所有带有注释的单元格，请使用此宏。</p>
<h4 id="20-在所选内容中突出显示替换行"><a href="#20-在所选内容中突出显示替换行" class="headerlink" title="20. 在所选内容中突出显示替换行"></a>20. 在所选内容中突出显示替换行</h4><figure class="highlight mathematica"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">Sub</span> <span class="variable">highlightAlternateRows</span><span class="punctuation">(</span><span class="punctuation">)</span></span><br><span class="line">	<span class="variable">Dim</span> <span class="variable">rng</span> <span class="variable">As</span> <span class="built_in">Range</span></span><br><span class="line">	<span class="built_in">For</span> <span class="variable">Each</span> <span class="variable">rng</span> <span class="built_in">In</span> <span class="built_in">Selection</span><span class="operator">.</span><span class="variable">Rows</span></span><br><span class="line">		<span class="built_in">If</span> <span class="variable">rng</span><span class="operator">.</span><span class="built_in">Row</span> <span class="built_in">Mod</span> <span class="number">2</span> <span class="operator">=</span> <span class="number">1</span> <span class="variable">Then</span></span><br><span class="line">			<span class="variable">rng</span><span class="operator">.</span><span class="built_in">Style</span> <span class="operator">=</span> <span class="string">&quot;20% -Accent1&quot;</span></span><br><span class="line">			<span class="variable">rng</span><span class="operator">.</span><span class="built_in">Value</span> <span class="operator">=</span> <span class="variable">rng</span> <span class="operator">^</span> <span class="punctuation">(</span><span class="number">1</span> <span class="operator">/</span> <span class="number">3</span><span class="punctuation">)</span></span><br><span class="line">			<span class="variable">Else</span></span><br><span class="line">		<span class="built_in">End</span> <span class="built_in">If</span></span><br><span class="line">	<span class="built_in">Next</span> <span class="variable">rng</span></span><br><span class="line"><span class="built_in">End</span> <span class="variable">Sub</span></span><br></pre></td></tr></table></figure>
<p>通过突出显示备用行，您可以使数据易于读取，为此，您可以使用下面的VBA代码。它将简单地突出显示所选范围内的每一行。</p>
<h4 id="21-突出显示单词拼写错误的单元格"><a href="#21-突出显示单词拼写错误的单元格" class="headerlink" title="21. 突出显示单词拼写错误的单元格"></a>21. 突出显示单词拼写错误的单元格</h4><figure class="highlight mathematica"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">Sub</span> <span class="variable">HighlightMisspelledCells</span><span class="punctuation">(</span><span class="punctuation">)</span></span><br><span class="line">	<span class="variable">Dim</span> <span class="variable">rng</span> <span class="variable">As</span> <span class="built_in">Range</span></span><br><span class="line">	<span class="built_in">For</span> <span class="variable">Each</span> <span class="variable">rng</span> <span class="built_in">In</span> <span class="variable">ActiveSheet</span><span class="operator">.</span><span class="variable">UsedRange</span></span><br><span class="line">		<span class="built_in">If</span> <span class="built_in">Not</span> <span class="variable">Application</span><span class="operator">.</span><span class="variable">CheckSpelling</span><span class="punctuation">(</span><span class="variable">word</span><span class="operator">:=</span><span class="variable">rng</span><span class="operator">.</span><span class="built_in">Text</span><span class="punctuation">)</span> <span class="variable">Then</span></span><br><span class="line">			<span class="variable">rng</span><span class="operator">.</span><span class="built_in">Style</span> <span class="operator">=</span> <span class="string">&quot;Bad&quot;</span></span><br><span class="line">		<span class="built_in">End</span> <span class="built_in">If</span></span><br><span class="line">	<span class="built_in">Next</span> <span class="variable">rng</span></span><br><span class="line"><span class="built_in">End</span> <span class="variable">Sub</span></span><br></pre></td></tr></table></figure>
<p>如果您发现很难检查所有单元格的拼写错误，那么此代码适合您。它将检查所选内容中的每个单元格，并突出显示拼写错误的单词的单元格。</p>
<h4 id="22-突出显示整个工作表中出错的单元格"><a href="#22-突出显示整个工作表中出错的单元格" class="headerlink" title="22.突出显示整个工作表中出错的单元格"></a>22.突出显示整个工作表中出错的单元格</h4><figure class="highlight vbnet"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">Sub</span> highlightErrors()</span><br><span class="line">	<span class="keyword">Dim</span> rng <span class="keyword">As</span> Range</span><br><span class="line">	<span class="keyword">Dim</span> i <span class="keyword">As</span> <span class="type">Integer</span></span><br><span class="line">	<span class="keyword">For</span> <span class="keyword">Each</span> rng <span class="keyword">In</span> ActiveSheet.UsedRange</span><br><span class="line">		<span class="keyword">If</span> WorksheetFunction.IsError(rng) <span class="keyword">Then</span></span><br><span class="line">			i = i + <span class="number">1</span></span><br><span class="line">			rng.Style = <span class="string">&quot;bad&quot;</span></span><br><span class="line">		<span class="keyword">End</span> <span class="keyword">If</span></span><br><span class="line">	<span class="keyword">Next</span> rng</span><br><span class="line">	MsgBox _</span><br><span class="line">	<span class="string">&quot;There are total &quot;</span> &amp; i _</span><br><span class="line">	&amp; <span class="string">&quot; error(s) in this worksheet.&quot;</span></span><br><span class="line"><span class="keyword">End</span> <span class="keyword">Sub</span> <span class="comment">&#x27;Translate By Tmtony</span></span><br></pre></td></tr></table></figure>
<p>要突出显示并计算您有错误的所有单元格，此代码将为您提供帮助。只需运行此代码，它将返回一条带有数字错误单元格的消息，并突出显示所有单元格。</p>
<h4 id="23-突出显示工作表中具有特定文本的单元格"><a href="#23-突出显示工作表中具有特定文本的单元格" class="headerlink" title="23.突出显示工作表中具有特定文本的单元格"></a>23.突出显示工作表中具有特定文本的单元格</h4><figure class="highlight vbscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">Sub</span> highlightSpecificValues()</span><br><span class="line">	<span class="keyword">Dim</span> rng As range</span><br><span class="line">	<span class="keyword">Dim</span> i As Integer</span><br><span class="line">	<span class="keyword">Dim</span> c As Variant</span><br><span class="line">	c = <span class="built_in">InputBox</span>(<span class="string">&quot;Enter Value To Highlight&quot;</span>)</span><br><span class="line">	<span class="keyword">For</span> <span class="keyword">Each</span> rng <span class="keyword">In</span> ActiveSheet.UsedRange</span><br><span class="line">		<span class="keyword">If</span> rng = c <span class="keyword">Then</span></span><br><span class="line">			rng.Style = <span class="string">&quot;Note&quot;</span></span><br><span class="line">			i = i + <span class="number">1</span></span><br><span class="line">		<span class="keyword">End</span> <span class="keyword">If</span></span><br><span class="line">	<span class="keyword">Next</span> rng</span><br><span class="line">	MsgBox <span class="string">&quot;There are total &quot;</span> &amp; i &amp; <span class="string">&quot; &quot;</span> &amp; c &amp; <span class="string">&quot; in this worksheet.&quot;</span></span><br><span class="line"><span class="keyword">End</span> <span class="keyword">Sub</span></span><br></pre></td></tr></table></figure>
<p>此代码将帮助您计算具有特定值的单元格，您将提到这些值，然后突出显示所有这些单元格。</p>
<h4 id="24-突出显示所有空白单元格不可见空间"><a href="#24-突出显示所有空白单元格不可见空间" class="headerlink" title="24.突出显示所有空白单元格不可见空间"></a>24.突出显示所有空白单元格不可见空间</h4><figure class="highlight mathematica"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">Sub</span> <span class="variable">blankWithSpace</span><span class="punctuation">(</span><span class="punctuation">)</span></span><br><span class="line">	<span class="variable">Dim</span> <span class="variable">rng</span> <span class="variable">As</span> <span class="built_in">Range</span></span><br><span class="line">	<span class="built_in">For</span> <span class="variable">Each</span> <span class="variable">rng</span> <span class="built_in">In</span> <span class="variable">ActiveSheet</span><span class="operator">.</span><span class="variable">UsedRange</span></span><br><span class="line">		<span class="built_in">If</span> <span class="variable">rng</span><span class="operator">.</span><span class="built_in">Value</span> <span class="operator">=</span> <span class="string">&quot; &quot;</span> <span class="variable">Then</span></span><br><span class="line">			<span class="variable">rng</span><span class="operator">.</span><span class="built_in">Style</span> <span class="operator">=</span> <span class="string">&quot;Note&quot;</span></span><br><span class="line">		<span class="built_in">End</span> <span class="built_in">If</span></span><br><span class="line">	<span class="built_in">Next</span> <span class="variable">rng</span></span><br><span class="line"><span class="built_in">End</span> <span class="variable">Sub</span></span><br></pre></td></tr></table></figure>
<p>有时有一些单元格是空白的，但它们只有一个空格，因此，很难识别它们。此代码将检查工作表中的所有单元格，并突出显示具有单个空格的所有单元格。</p>
<h4 id="25-突出显示范围内的最大值"><a href="#25-突出显示范围内的最大值" class="headerlink" title="25. 突出显示范围内的最大值"></a>25. 突出显示范围内的最大值</h4><figure class="highlight mathematica"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">Sub</span> <span class="variable">highlightMaxValue</span><span class="punctuation">(</span><span class="punctuation">)</span></span><br><span class="line">	<span class="variable">Dim</span> <span class="variable">rng</span> <span class="variable">As</span> <span class="built_in">Range</span></span><br><span class="line">	<span class="built_in">For</span> <span class="variable">Each</span> <span class="variable">rng</span> <span class="built_in">In</span> <span class="built_in">Selection</span></span><br><span class="line">		<span class="built_in">If</span> <span class="variable">rng</span> <span class="operator">=</span> <span class="variable">WorksheetFunction</span><span class="operator">.</span><span class="built_in">Max</span><span class="punctuation">(</span><span class="built_in">Selection</span><span class="punctuation">)</span> <span class="variable">Then</span></span><br><span class="line">			<span class="variable">rng</span><span class="operator">.</span><span class="built_in">Style</span> <span class="operator">=</span> <span class="string">&quot;Good&quot;</span></span><br><span class="line">		<span class="built_in">End</span> <span class="built_in">If</span></span><br><span class="line">	<span class="built_in">Next</span> <span class="variable">rng</span></span><br><span class="line"><span class="built_in">End</span> <span class="variable">Sub</span></span><br></pre></td></tr></table></figure>
<p>它将检查所有选定的单元格，并使用最大值突出显示单元格。</p>
<h4 id="26-突出显示范围内的最小值"><a href="#26-突出显示范围内的最小值" class="headerlink" title="26. 突出显示范围内的最小值"></a>26. 突出显示范围内的最小值</h4><figure class="highlight mathematica"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">Sub</span> <span class="type">Highlight_Min</span><span class="type">_Value</span><span class="punctuation">(</span><span class="punctuation">)</span></span><br><span class="line">	<span class="variable">Dim</span> <span class="variable">rng</span> <span class="variable">As</span> <span class="built_in">Range</span></span><br><span class="line">	<span class="built_in">For</span> <span class="variable">Each</span> <span class="variable">rng</span> <span class="built_in">In</span> <span class="built_in">Selection</span></span><br><span class="line">			<span class="built_in">If</span> <span class="variable">rng</span> <span class="operator">=</span> <span class="variable">WorksheetFunction</span><span class="operator">.</span><span class="built_in">Min</span><span class="punctuation">(</span><span class="built_in">Selection</span><span class="punctuation">)</span> <span class="variable">Then</span></span><br><span class="line">				<span class="variable">rng</span><span class="operator">.</span><span class="built_in">Style</span> <span class="operator">=</span> <span class="string">&quot;Good&quot;</span></span><br><span class="line">			<span class="built_in">End</span> <span class="built_in">If</span></span><br><span class="line">	<span class="built_in">Next</span> <span class="variable">rng</span></span><br><span class="line"><span class="built_in">End</span> <span class="variable">Sub</span></span><br></pre></td></tr></table></figure>
<p>它将检查所有选定的单元格，并使用最小值突出显示单元格。</p>
<h4 id="27-突出显示唯一值"><a href="#27-突出显示唯一值" class="headerlink" title="27. 突出显示唯一值"></a>27. 突出显示唯一值</h4><figure class="highlight vbnet"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">Sub</span> highlightUniqueValues()</span><br><span class="line">	<span class="keyword">Dim</span> rng <span class="keyword">As</span> Range</span><br><span class="line">	<span class="keyword">Set</span> rng = Selection</span><br><span class="line">	rng.FormatConditions.Delete</span><br><span class="line">	<span class="keyword">Dim</span> uv <span class="keyword">As</span> UniqueValues</span><br><span class="line">	<span class="keyword">Set</span> uv = rng.FormatConditions.AddUniqueValues</span><br><span class="line">	uv.DupeUnique = xlUnique</span><br><span class="line">	uv.Interior.Color = vbGreen</span><br><span class="line"><span class="keyword">End</span> <span class="keyword">Sub</span> <span class="comment">&#x27;Translate By Tmtony</span></span><br></pre></td></tr></table></figure>
<p>此代码将突出显示所选内容中具有唯一值的所有单元格。</p>
<h4 id="28-突出显示列中的差异"><a href="#28-突出显示列中的差异" class="headerlink" title="28. 突出显示列中的差异"></a>28. 突出显示列中的差异</h4><figure class="highlight mathematica"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">Sub</span> <span class="variable">columnDifference</span><span class="punctuation">(</span><span class="punctuation">)</span></span><br><span class="line">	<span class="built_in">Range</span><span class="punctuation">(</span><span class="string">&quot;H7:H8,I7:I8&quot;</span><span class="punctuation">)</span><span class="operator">.</span><span class="built_in">Select</span></span><br><span class="line">	<span class="built_in">Selection</span><span class="operator">.</span><span class="variable">ColumnDifferences</span><span class="punctuation">(</span><span class="variable">ActiveCell</span><span class="punctuation">)</span><span class="operator">.</span><span class="built_in">Select</span></span><br><span class="line">	<span class="built_in">Selection</span><span class="operator">.</span><span class="built_in">Style</span><span class="operator">=</span> <span class="string">&quot;Bad&quot;</span></span><br><span class="line"><span class="built_in">End</span> <span class="variable">Sub</span></span><br></pre></td></tr></table></figure>
<p>使用此代码，您可以突出显示两列（相应单元格）之间的差异。</p>
<h4 id="29-突出显示行中的差异"><a href="#29-突出显示行中的差异" class="headerlink" title="29. 突出显示行中的差异"></a>29. 突出显示行中的差异</h4><figure class="highlight mathematica"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">Sub</span> <span class="variable">rowDifference</span><span class="punctuation">(</span><span class="punctuation">)</span></span><br><span class="line">	<span class="built_in">Range</span><span class="punctuation">(</span><span class="string">&quot;H7:H8,I7:I8&quot;</span><span class="punctuation">)</span><span class="operator">.</span><span class="built_in">Select</span></span><br><span class="line">	<span class="built_in">Selection</span><span class="operator">.</span><span class="variable">RowDifferences</span><span class="punctuation">(</span><span class="variable">ActiveCell</span><span class="punctuation">)</span><span class="operator">.</span><span class="built_in">Select</span></span><br><span class="line">	<span class="built_in">Selection</span><span class="operator">.</span><span class="built_in">Style</span><span class="operator">=</span> <span class="string">&quot;Bad&quot;</span></span><br><span class="line"><span class="built_in">End</span> <span class="variable">Sub</span></span><br></pre></td></tr></table></figure>
<p>通过使用此代码，您可以突出显示两行（相应单元格）之间的差异。打印代码 这些宏代码将帮助您自动执行一些打印任务，从而进一步节省大量时间。</p>
<h4 id="30-打印注释"><a href="#30-打印注释" class="headerlink" title="30. 打印注释"></a>30. 打印注释</h4><figure class="highlight vbnet"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">Sub</span> printComments()</span><br><span class="line">	<span class="keyword">With</span> ActiveSheet.PageSetup</span><br><span class="line">		.printComments = xlPrintSheetEnd</span><br><span class="line">	<span class="keyword">End</span> <span class="keyword">With</span></span><br><span class="line"><span class="keyword">End</span> <span class="keyword">Sub</span></span><br></pre></td></tr></table></figure>
<p>使用此宏可以激活设置以在页面末尾打印单元格注释。假设您有10页要打印，使用此代码后，您将获得第11页最后一页上的所有评论。</p>
<h4 id="31-打印窄边距"><a href="#31-打印窄边距" class="headerlink" title="31. 打印窄边距"></a>31. 打印窄边距</h4><figure class="highlight x86asm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">Sub</span> printNarrowMargin()</span><br><span class="line">	With ActiveSheet<span class="number">.</span>PageSetup</span><br><span class="line"><span class="meta">		.LeftMargin</span> = Application</span><br><span class="line"><span class="meta">		.InchesToPoints</span> (<span class="number">0.25</span>)</span><br><span class="line"><span class="meta">		.RightMargin</span> = Application<span class="number">.</span>InchesToPoints(<span class="number">0.25</span>)</span><br><span class="line"><span class="meta">		.TopMargin</span> = Application<span class="number">.</span>InchesToPoints(<span class="number">0.75</span>)</span><br><span class="line"><span class="meta">		.BottomMargin</span> = Application<span class="number">.</span>InchesToPoints(<span class="number">0.75</span>)</span><br><span class="line"><span class="meta">		.HeaderMargin</span> = Application<span class="number">.</span>InchesToPoints(<span class="number">0.3</span>)</span><br><span class="line"><span class="meta">		.FooterMargin</span> = Application<span class="number">.</span>InchesToPoints(<span class="number">0.3</span>)</span><br><span class="line">	End With</span><br><span class="line">	ActiveWindow<span class="number">.</span>SelectedSheets<span class="number">.</span>PrintOut _</span><br><span class="line"><span class="symbol">	Copies:</span>=<span class="number">1</span>, _</span><br><span class="line"><span class="symbol">	Collate:</span>=True, _</span><br><span class="line"><span class="symbol">	IgnorePrintAreas:</span>=False</span><br><span class="line">End <span class="keyword">Sub</span></span><br></pre></td></tr></table></figure>
<p>使用此VBA代码进行窄边距打印。运行此宏时，它会自动将边距更改为窄。</p>
<h4 id="32-打印选择"><a href="#32-打印选择" class="headerlink" title="32. 打印选择"></a>32. 打印选择</h4><figure class="highlight vbnet"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">Sub</span> printSelection()</span><br><span class="line">	Selection.PrintOut Copies:=<span class="number">1</span>, Collate:=<span class="literal">True</span></span><br><span class="line"><span class="keyword">End</span> <span class="keyword">Sub</span> <span class="comment">&#x27;Translate By Tmtony</span></span><br></pre></td></tr></table></figure>
<p>此代码将帮助您打印所选范围。您无需转到打印选项并设置打印范围。只需选择一个范围并运行此代码。</p>
<h4 id="33-打印自定义页面"><a href="#33-打印自定义页面" class="headerlink" title="33. 打印自定义页面"></a>33. 打印自定义页面</h4><figure class="highlight vbnet"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">Sub</span> printCustomSelection()</span><br><span class="line">	<span class="keyword">Dim</span> startpage <span class="keyword">As</span> <span class="type">Integer</span></span><br><span class="line">	<span class="keyword">Dim</span> endpage <span class="keyword">As</span> <span class="type">Integer</span></span><br><span class="line">	startpage = _</span><br><span class="line">	InputBox(<span class="string">&quot;Please Enter Start Page number.&quot;</span>, <span class="string">&quot;Enter Value&quot;</span>)</span><br><span class="line">	<span class="keyword">If</span> <span class="built_in">Not</span> WorksheetFunction.IsNumber(startpage) <span class="keyword">Then</span></span><br><span class="line">		MsgBox _</span><br><span class="line">		<span class="string">&quot;Invalid Start Page number. Please try again.&quot;</span>, <span class="string">&quot;Error&quot;</span></span><br><span class="line">		<span class="keyword">Exit</span> <span class="keyword">Sub</span></span><br><span class="line">	<span class="keyword">End</span> <span class="keyword">If</span></span><br><span class="line">	endpage = _</span><br><span class="line">	InputBox(<span class="string">&quot;Please Enter End Page number.&quot;</span>, <span class="string">&quot;Enter Value&quot;</span>)</span><br><span class="line">	<span class="keyword">If</span> <span class="built_in">Not</span> WorksheetFunction.IsNumber(endpage) <span class="keyword">Then</span></span><br><span class="line">		MsgBox _</span><br><span class="line">		<span class="string">&quot;Invalid End Page number. Please try again.&quot;</span>, <span class="string">&quot;Error&quot;</span></span><br><span class="line">		<span class="keyword">Exit</span> <span class="keyword">Sub</span></span><br><span class="line">	<span class="keyword">End</span> <span class="keyword">If</span></span><br><span class="line">	Selection.PrintOut <span class="keyword">From</span>:=startpage, _</span><br><span class="line">	<span class="keyword">To</span>:=endpage, Copies:=<span class="number">1</span>, Collate:=<span class="literal">True</span></span><br><span class="line"><span class="keyword">End</span> <span class="keyword">Sub</span></span><br></pre></td></tr></table></figure>
<p>您可以使用此代码来打印自定义页面范围，而不是使用打印选项中的设置。假设您要打印从 5 到 10 的页面。您只需要运行此VBA代码并输入起始页和结束页即可。工作表代码 这些宏代码将帮助您以简单的方式控制和管理工作表，并节省大量时间。</p>
<h4 id="34-隐藏除活动工作表之外的所有工作表"><a href="#34-隐藏除活动工作表之外的所有工作表" class="headerlink" title="34. 隐藏除活动工作表之外的所有工作表"></a>34. 隐藏除活动工作表之外的所有工作表</h4><figure class="highlight mathematica"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">Sub</span> <span class="variable">HideWorksheet</span><span class="punctuation">(</span><span class="punctuation">)</span></span><br><span class="line">	<span class="variable">Dim</span> <span class="variable">ws</span> <span class="variable">As</span> <span class="variable">Worksheet</span></span><br><span class="line">	<span class="built_in">For</span> <span class="variable">Each</span> <span class="variable">ws</span> <span class="built_in">In</span> <span class="variable">ThisWorkbook</span><span class="operator">.</span><span class="variable">Worksheets</span></span><br><span class="line">		<span class="built_in">If</span> <span class="variable">ws</span><span class="operator">.</span><span class="variable">Name</span> <span class="operator">&lt;&gt;</span> <span class="variable">ThisWorkbook</span><span class="operator">.</span><span class="variable">ActiveSheet</span><span class="operator">.</span><span class="variable">Name</span> <span class="variable">Then</span></span><br><span class="line">			<span class="variable">ws</span><span class="operator">.</span><span class="built_in">Visible</span> <span class="operator">=</span> <span class="variable">xlSheetHidden</span></span><br><span class="line">		<span class="built_in">End</span> <span class="built_in">If</span></span><br><span class="line">	<span class="built_in">Next</span> <span class="variable">ws</span></span><br><span class="line"><span class="built_in">End</span> <span class="variable">Sub</span></span><br></pre></td></tr></table></figure>
<p>现在，假设您要隐藏工作簿中除活动工作表之外的所有工作表。此宏代码将为您执行此操作。相关：VBA 函数列表</p>
<h4 id="35-取消隐藏所有隐藏的工作表"><a href="#35-取消隐藏所有隐藏的工作表" class="headerlink" title="35. 取消隐藏所有隐藏的工作表"></a>35. 取消隐藏所有隐藏的工作表</h4><figure class="highlight vbnet"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">Sub</span> UnhideAllWorksheet()</span><br><span class="line">	<span class="keyword">Dim</span> ws <span class="keyword">As</span> Worksheet</span><br><span class="line">	<span class="keyword">For</span> <span class="keyword">Each</span> ws <span class="keyword">In</span> ActiveWorkbook.Worksheets</span><br><span class="line">		ws.Visible = xlSheetVisible</span><br><span class="line">	<span class="keyword">Next</span> ws</span><br><span class="line"><span class="keyword">End</span> <span class="keyword">Sub</span></span><br></pre></td></tr></table></figure>
<p>如果您想取消隐藏使用以前的代码隐藏的所有工作表，那么这里是该代码。</p>
<h4 id="36-删除除活动工作表之外的所有工作表"><a href="#36-删除除活动工作表之外的所有工作表" class="headerlink" title="36. 删除除活动工作表之外的所有工作表"></a>36. 删除除活动工作表之外的所有工作表</h4><figure class="highlight mathematica"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">Sub</span> <span class="variable">DeleteWorksheets</span><span class="punctuation">(</span><span class="punctuation">)</span></span><br><span class="line">	<span class="variable">Dim</span> <span class="variable">ws</span> <span class="variable">As</span> <span class="variable">Worksheet</span></span><br><span class="line">	<span class="built_in">For</span> <span class="variable">Each</span> <span class="variable">ws</span> <span class="built_in">In</span> <span class="variable">ThisWorkbook</span><span class="operator">.</span><span class="variable">Worksheets</span></span><br><span class="line">		<span class="built_in">If</span> <span class="variable">ws</span><span class="operator">.</span><span class="variable">name</span> <span class="operator">&lt;&gt;</span> <span class="variable">ThisWorkbook</span><span class="operator">.</span><span class="variable">ActiveSheet</span><span class="operator">.</span><span class="variable">name</span> <span class="variable">Then</span></span><br><span class="line">			<span class="variable">Application</span><span class="operator">.</span><span class="variable">DisplayAlerts</span> <span class="operator">=</span> <span class="built_in">False</span></span><br><span class="line">			<span class="variable">ws</span><span class="operator">.</span><span class="built_in">Delete</span></span><br><span class="line">			<span class="variable">Application</span><span class="operator">.</span><span class="variable">DisplayAlerts</span> <span class="operator">=</span> <span class="built_in">True</span></span><br><span class="line">		<span class="built_in">End</span> <span class="built_in">If</span></span><br><span class="line">	<span class="built_in">Next</span> <span class="variable">ws</span></span><br><span class="line"><span class="built_in">End</span> <span class="variable">Sub</span></span><br></pre></td></tr></table></figure>
<p>如果要删除除活动工作表以外的所有工作表，此宏对您很有用。运行此宏时，它会将活动工作表的名称与其他工作表进行比较，然后将其删除。</p>
<h4 id="37-立即保护所有工作表"><a href="#37-立即保护所有工作表" class="headerlink" title="37.立即保护所有工作表"></a>37.立即保护所有工作表</h4><figure class="highlight vbnet"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">Sub</span> ProtectAllWorskeets()</span><br><span class="line">	<span class="keyword">Dim</span> ws <span class="keyword">As</span> Worksheet</span><br><span class="line">	<span class="keyword">Dim</span> ps <span class="keyword">As</span> <span class="type">String</span></span><br><span class="line">	ps = InputBox(<span class="string">&quot;Enter a Password.&quot;</span>, vbOKCancel)</span><br><span class="line">	<span class="keyword">For</span> <span class="keyword">Each</span> ws <span class="keyword">In</span> ActiveWorkbook.Worksheets</span><br><span class="line">		ws.Protect Password:=ps</span><br><span class="line">	<span class="keyword">Next</span> ws</span><br><span class="line"><span class="keyword">End</span> <span class="keyword">Sub</span> <span class="comment">&#x27;Translate By Tmtony</span></span><br></pre></td></tr></table></figure>
<p>如果您想一次性保护所有工作表，这里有一个适合您的代码。运行此宏时，您将获得一个用于输入密码的输入框。输入密码后，单击“确定”。并确保注意CAPS。</p>
<h4 id="38-调整工作表中所有图表的大小"><a href="#38-调整工作表中所有图表的大小" class="headerlink" title="38. 调整工作表中所有图表的大小"></a>38. 调整工作表中所有图表的大小</h4><figure class="highlight vbnet"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">Sub</span> Resize_Charts()</span><br><span class="line">	<span class="keyword">Dim</span> i <span class="keyword">As</span> <span class="type">Integer</span></span><br><span class="line">	<span class="keyword">For</span> i = <span class="number">1</span> <span class="keyword">To</span> ActiveSheet.ChartObjects.Count</span><br><span class="line">		<span class="keyword">With</span> ActiveSheet.ChartObjects(i)</span><br><span class="line">			.Width = <span class="number">300</span></span><br><span class="line">			.Height = <span class="number">200</span></span><br><span class="line">		<span class="keyword">End</span> <span class="keyword">With</span></span><br><span class="line">	<span class="keyword">Next</span> i</span><br><span class="line"><span class="keyword">End</span> <span class="keyword">Sub</span></span><br></pre></td></tr></table></figure>
<p>使所有图表的大小相同。此宏代码将帮助您制作相同大小的所有图表。您可以通过在宏代码中更改图表来更改图表的高度和宽度。</p>
<h4 id="39-插入多个工作表"><a href="#39-插入多个工作表" class="headerlink" title="39. 插入多个工作表"></a>39. 插入多个工作表</h4><figure class="highlight vbnet"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">Sub</span> InsertMultipleSheets()</span><br><span class="line">	<span class="keyword">Dim</span> i <span class="keyword">As</span> <span class="type">Integer</span></span><br><span class="line">	i = _</span><br><span class="line">	InputBox(<span class="string">&quot;Enter number of sheets to insert.&quot;</span>, _</span><br><span class="line">	<span class="string">&quot;Enter Multiple Sheets&quot;</span>)</span><br><span class="line">	Sheets.Add After:=ActiveSheet, Count:=i</span><br><span class="line"><span class="keyword">End</span> <span class="keyword">Sub</span></span><br></pre></td></tr></table></figure>
<p>如果要在单个镜头中在工作簿中添加多个工作表，则可以使用此代码。运行此宏代码时，您将获得一个输入框，用于输入要输入的工作表总数。</p>
<h4 id="40-保护工作表"><a href="#40-保护工作表" class="headerlink" title="40. 保护工作表"></a>40. 保护工作表</h4><figure class="highlight vbnet"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">Sub</span> ProtectWS()</span><br><span class="line">	ActiveSheet.Protect <span class="string">&quot;mypassword&quot;</span>, <span class="literal">True</span>, <span class="literal">True</span></span><br><span class="line"><span class="keyword">End</span> <span class="keyword">Sub</span></span><br></pre></td></tr></table></figure>
<p>如果要保护工作表，可以使用此宏代码。您所要做的就是在代码中提及您的密码。</p>
<h4 id="41-取消保护工作表"><a href="#41-取消保护工作表" class="headerlink" title="41. 取消保护工作表"></a>41. 取消保护工作表</h4><figure class="highlight vbnet"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">Sub</span> UnprotectWS()</span><br><span class="line">	ActiveSheet.Unprotect <span class="string">&quot;mypassword&quot;</span></span><br><span class="line"><span class="keyword">End</span> <span class="keyword">Sub</span></span><br></pre></td></tr></table></figure>
<p>如果要取消对工作表的保护，可以使用此宏代码。您所要做的就是提及您在保护工作表时使用的密码。</p>
<h4 id="42-对工作表进行排序"><a href="#42-对工作表进行排序" class="headerlink" title="42. 对工作表进行排序"></a>42. 对工作表进行排序</h4><figure class="highlight mathematica"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">Sub</span> <span class="variable">SortWorksheets</span><span class="punctuation">(</span><span class="punctuation">)</span></span><br><span class="line">	<span class="variable">Dim</span> <span class="variable">i</span> <span class="variable">As</span> <span class="built_in">Integer</span></span><br><span class="line">	<span class="variable">Dim</span> <span class="variable">j</span> <span class="variable">As</span> <span class="built_in">Integer</span></span><br><span class="line">	<span class="variable">Dim</span> <span class="variable">iAnswer</span> <span class="variable">As</span> <span class="variable">VbMsgBoxResult</span></span><br><span class="line">	<span class="variable">iAnswer</span> <span class="operator">=</span> <span class="variable">MsgBox</span><span class="punctuation">(</span><span class="string">&quot;Sort Sheets in Ascending Order?&quot;</span> <span class="operator">&amp;</span> <span class="variable">Chr</span><span class="punctuation">(</span><span class="number">10</span><span class="punctuation">)</span> <span class="type">_</span></span><br><span class="line">	<span class="operator">&amp;</span> <span class="string">&quot;Clicking No will sort in Descending Order&quot;</span><span class="operator">,</span> <span class="type">_</span></span><br><span class="line">	<span class="variable">vbYesNoCancel</span> <span class="operator">+</span> <span class="variable">vbQuestion</span> <span class="operator">+</span> <span class="variable">vbDefaultButton1</span><span class="operator">,</span> <span class="string">&quot;Sort Worksheets&quot;</span><span class="punctuation">)</span></span><br><span class="line">	<span class="built_in">For</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">1</span> <span class="variable">To</span> <span class="variable">Sheets</span><span class="operator">.</span><span class="built_in">Count</span></span><br><span class="line">		<span class="built_in">For</span> <span class="variable">j</span> <span class="operator">=</span> <span class="number">1</span> <span class="variable">To</span> <span class="variable">Sheets</span><span class="operator">.</span><span class="built_in">Count</span> <span class="operator">-</span> <span class="number">1</span></span><br><span class="line">			<span class="built_in">If</span> <span class="variable">iAnswer</span> <span class="operator">=</span> <span class="variable">vbYes</span> <span class="variable">Then</span></span><br><span class="line">				<span class="built_in">If</span> <span class="variable">UCase$</span><span class="punctuation">(</span><span class="variable">Sheets</span><span class="punctuation">(</span><span class="variable">j</span><span class="punctuation">)</span><span class="operator">.</span><span class="variable">Name</span><span class="punctuation">)</span> <span class="operator">&gt;</span> <span class="variable">UCase$</span><span class="punctuation">(</span><span class="variable">Sheets</span><span class="punctuation">(</span><span class="variable">j</span> <span class="operator">+</span> <span class="number">1</span><span class="punctuation">)</span><span class="operator">.</span><span class="variable">Name</span><span class="punctuation">)</span> <span class="variable">Then</span></span><br><span class="line">					<span class="variable">Sheets</span><span class="punctuation">(</span><span class="variable">j</span><span class="punctuation">)</span><span class="operator">.</span><span class="variable">Move</span> <span class="built_in">After</span><span class="operator">:=</span><span class="variable">Sheets</span><span class="punctuation">(</span><span class="variable">j</span> <span class="operator">+</span> <span class="number">1</span><span class="punctuation">)</span></span><br><span class="line">				<span class="built_in">End</span> <span class="built_in">If</span></span><br><span class="line">				<span class="variable">ElseIf</span> <span class="variable">iAnswer</span> <span class="operator">=</span> <span class="variable">vbNo</span> <span class="variable">Then</span></span><br><span class="line">				<span class="built_in">If</span> <span class="variable">UCase$</span><span class="punctuation">(</span><span class="variable">Sheets</span><span class="punctuation">(</span><span class="variable">j</span><span class="punctuation">)</span><span class="operator">.</span><span class="variable">Name</span><span class="punctuation">)</span> <span class="operator">&lt;</span> <span class="variable">UCase$</span><span class="punctuation">(</span><span class="variable">Sheets</span><span class="punctuation">(</span><span class="variable">j</span> <span class="operator">+</span> <span class="number">1</span><span class="punctuation">)</span><span class="operator">.</span><span class="variable">Name</span><span class="punctuation">)</span> <span class="variable">Then</span> <span class="variable">Sheets</span><span class="punctuation">(</span><span class="variable">j</span><span class="punctuation">)</span><span class="operator">.</span><span class="variable">Move</span> <span class="built_in">After</span><span class="operator">:=</span><span class="variable">Sheets</span><span class="punctuation">(</span><span class="variable">j</span> <span class="operator">+</span> <span class="number">1</span><span class="punctuation">)</span></span><br><span class="line">			<span class="built_in">End</span> <span class="built_in">If</span></span><br><span class="line">			<span class="built_in">End</span> <span class="built_in">If</span></span><br><span class="line">		<span class="built_in">Next</span> <span class="variable">j</span></span><br><span class="line">	<span class="built_in">Next</span> <span class="variable">i</span></span><br><span class="line"><span class="built_in">End</span> <span class="variable">Sub</span> <span class="operator">&#x27;</span><span class="built_in">Translate</span> <span class="variable">By</span> <span class="variable">Tmtony</span></span><br></pre></td></tr></table></figure>
<p>此代码将帮助您根据工作表的名称对工作簿中的工作表进行排序。 （整理：<br>@小辣椒高效Office<br> ）</p>
<h4 id="43-用公式保护所有单元格"><a href="#43-用公式保护所有单元格" class="headerlink" title="43.用公式保护所有单元格"></a>43.用公式保护所有单元格</h4><figure class="highlight mathematica"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">Sub</span> <span class="variable">lockCellsWithFormulas</span><span class="punctuation">(</span><span class="punctuation">)</span></span><br><span class="line">	<span class="built_in">With</span> <span class="variable">ActiveSheet</span></span><br><span class="line">		<span class="operator">.</span><span class="built_in">Unprotect</span></span><br><span class="line">		<span class="operator">.</span><span class="built_in">Cells</span><span class="operator">.</span><span class="built_in">Locked</span> <span class="operator">=</span> <span class="built_in">False</span></span><br><span class="line">		<span class="operator">.</span><span class="built_in">Cells</span><span class="operator">.</span><span class="variable">SpecialCells</span><span class="punctuation">(</span><span class="variable">xlCellTypeFormulas</span><span class="punctuation">)</span><span class="operator">.</span><span class="built_in">Locked</span> <span class="operator">=</span> <span class="built_in">True</span></span><br><span class="line">		<span class="operator">.</span><span class="built_in">Protect</span> <span class="variable">AllowDeletingRows</span><span class="operator">:=</span><span class="built_in">True</span></span><br><span class="line">	<span class="built_in">End</span> <span class="built_in">With</span></span><br><span class="line"><span class="built_in">End</span> <span class="variable">Sub</span></span><br></pre></td></tr></table></figure>
<p>若要通过单击使用公式保护单元格，您可以使用此代码。</p>
<h4 id="44-删除所有空白工作表"><a href="#44-删除所有空白工作表" class="headerlink" title="44. 删除所有空白工作表"></a>44. 删除所有空白工作表</h4><figure class="highlight vbnet"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">Sub</span> deleteBlankWorksheets()</span><br><span class="line">	<span class="keyword">Dim</span> Ws <span class="keyword">As</span> Worksheet</span><br><span class="line">	<span class="keyword">On</span> <span class="keyword">Error</span> <span class="keyword">Resume</span> <span class="keyword">Next</span></span><br><span class="line">	Application.ScreenUpdating= <span class="literal">False</span></span><br><span class="line">	Application.DisplayAlerts= <span class="literal">False</span></span><br><span class="line">	<span class="keyword">For</span> <span class="keyword">Each</span> Ws <span class="keyword">In</span> Application.Worksheets</span><br><span class="line">		<span class="keyword">If</span> Application.WorksheetFunction.CountA(Ws.UsedRange) = <span class="number">0</span> <span class="keyword">Then</span></span><br><span class="line">			Ws.Delete</span><br><span class="line">		<span class="keyword">End</span> <span class="keyword">If</span></span><br><span class="line">	<span class="keyword">Next</span></span><br><span class="line">	Application.ScreenUpdating= <span class="literal">True</span></span><br><span class="line">	Application.DisplayAlerts= <span class="literal">True</span></span><br><span class="line"><span class="keyword">End</span> <span class="keyword">Sub</span></span><br></pre></td></tr></table></figure>
<p>运行此代码，它将检查活动工作簿中的所有工作表，如果工作表为空，则将其删除。</p>
<h4 id="45-取消隐藏所有行和列"><a href="#45-取消隐藏所有行和列" class="headerlink" title="45. 取消隐藏所有行和列"></a>45. 取消隐藏所有行和列</h4><figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">Sub UnhideRowsColumns()</span><br><span class="line">	<span class="keyword">Columns</span>.EntireColumn.Hidden = <span class="keyword">False</span></span><br><span class="line">	<span class="keyword">Rows</span>.EntireRow.Hidden = <span class="keyword">False</span></span><br><span class="line"><span class="keyword">End</span> Sub</span><br></pre></td></tr></table></figure>
<p>无需手动将行和列隐藏一个，您可以使用此代码一次性执行此操作。</p>
<h4 id="46-将每个工作表另存为单个-PDF"><a href="#46-将每个工作表另存为单个-PDF" class="headerlink" title="46. 将每个工作表另存为单个 PDF"></a>46. 将每个工作表另存为单个 PDF</h4><figure class="highlight vbnet"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">Sub</span> SaveWorkshetAsPDF()</span><br><span class="line">	Dimws <span class="keyword">As</span> Worksheet</span><br><span class="line">	<span class="keyword">For</span> <span class="keyword">Each</span> ws <span class="keyword">In</span> Worksheets</span><br><span class="line">		ws.ExportAsFixedFormat _</span><br><span class="line">		xlTypePDF, _</span><br><span class="line">		<span class="string">&quot;ENTER-FOLDER-NAME-HERE&quot;</span> &amp; _</span><br><span class="line">		ws.Name &amp; <span class="string">&quot;.pdf&quot;</span></span><br><span class="line">	<span class="keyword">Next</span> ws</span><br><span class="line"><span class="keyword">End</span> <span class="keyword">Sub</span></span><br></pre></td></tr></table></figure>
<p>此代码将简单地将所有工作表保存在单独的PDF文件中。您只需要从代码中更改文件夹名称即可。</p>
<h4 id="47-禁用分页符"><a href="#47-禁用分页符" class="headerlink" title="47. 禁用分页符"></a>47. 禁用分页符</h4><figure class="highlight vbnet"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">Sub</span> DisablePageBreaks()</span><br><span class="line">	<span class="keyword">Dim</span> wb <span class="keyword">As</span> Workbook</span><br><span class="line">	<span class="keyword">Dim</span> wks <span class="keyword">As</span> Worksheet</span><br><span class="line">	Application.ScreenUpdating = <span class="literal">False</span></span><br><span class="line">	<span class="keyword">For</span> <span class="keyword">Each</span> wb <span class="keyword">In</span> Application.Workbooks</span><br><span class="line">		<span class="keyword">For</span> <span class="keyword">Each</span> Sht <span class="keyword">In</span> wb.Worksheets</span><br><span class="line">			Sht.DisplayPageBreaks = <span class="literal">False</span></span><br><span class="line">		<span class="keyword">Next</span> Sht</span><br><span class="line">	<span class="keyword">Next</span> wb</span><br><span class="line">	Application.ScreenUpdating = <span class="literal">True</span></span><br><span class="line"><span class="keyword">End</span> <span class="keyword">Sub</span> <span class="comment">&#x27;Translate By Tmtony</span></span><br></pre></td></tr></table></figure>
<p>若要禁用分页符，请使用此代码。它只会从所有打开的工作簿中禁用分页符。工作簿代码 这些代码将帮助您以简单的方式以最少的工作量执行工作簿级任务。</p>
<h4 id="48-创建当前工作簿的备份"><a href="#48-创建当前工作簿的备份" class="headerlink" title="48. 创建当前工作簿的备份"></a>48. 创建当前工作簿的备份</h4><figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">Sub FileBackUp()</span><br><span class="line">	ThisWorkbook.SaveCopyAs Filename:=ThisWorkbook.Path &amp; _</span><br><span class="line">	&quot;&quot; &amp; Format(<span class="type">Date</span>, &quot;mm-dd-yy&quot;) &amp; &quot; &quot; &amp; _</span><br><span class="line">	ThisWorkbook.name</span><br><span class="line"><span class="keyword">End</span> Sub</span><br></pre></td></tr></table></figure>
<p>这是最有用的宏之一，可以帮助您保存当前工作簿的备份文件。它将备份文件保存在保存当前文件的同一目录中，并且还将添加带有文件名的当前日期。</p>
<h4 id="49-一次关闭所有工作簿"><a href="#49-一次关闭所有工作簿" class="headerlink" title="49. 一次关闭所有工作簿"></a>49. 一次关闭所有工作簿</h4><figure class="highlight vbnet"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">Sub</span> CloseAllWorkbooks()</span><br><span class="line">	<span class="keyword">Dim</span> wbs <span class="keyword">As</span> Workbook</span><br><span class="line">	<span class="keyword">For</span> <span class="keyword">Each</span> wbs <span class="keyword">In</span> Workbooks</span><br><span class="line">		wbs.Close SaveChanges:=<span class="literal">True</span></span><br><span class="line">	<span class="keyword">Next</span> wb</span><br><span class="line"><span class="keyword">End</span> <span class="keyword">Sub</span></span><br></pre></td></tr></table></figure>
<p>使用此宏代码关闭所有打开的工作簿。此宏代码将首先逐个检查所有工作簿并关闭它们。如果未保存任何工作表，您将收到一条消息以保存它。</p>
<h4 id="50-将活动工作表复制到新工作簿中"><a href="#50-将活动工作表复制到新工作簿中" class="headerlink" title="50. 将活动工作表复制到新工作簿中"></a>50. 将活动工作表复制到新工作簿中</h4><figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">Sub CopyWorksheetToNewWorkbook()</span><br><span class="line">	ThisWorkbook.ActiveSheet.<span class="keyword">Copy</span> _</span><br><span class="line">	<span class="keyword">Before</span>:=Workbooks.<span class="keyword">Add</span>.Worksheets(<span class="number">1</span>)</span><br><span class="line"><span class="keyword">End</span> Sub</span><br></pre></td></tr></table></figure>
<p>假设您要在新工作簿中复制活动工作表，只需运行此宏代码，它就会为您做同样的事情。这超级节省时间。</p>
<h4 id="51-电子邮件中的活动工作簿"><a href="#51-电子邮件中的活动工作簿" class="headerlink" title="51. 电子邮件中的活动工作簿"></a>51. 电子邮件中的活动工作簿</h4><figure class="highlight vbnet"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">Sub</span> Send_Mail()</span><br><span class="line">	<span class="keyword">Dim</span> OutApp <span class="keyword">As</span> <span class="type">Object</span></span><br><span class="line">	<span class="keyword">Dim</span> OutMail <span class="keyword">As</span> <span class="type">Object</span></span><br><span class="line">	<span class="keyword">Set</span> OutApp = CreateObject(<span class="string">&quot;Outlook.Application&quot;</span>)</span><br><span class="line">	<span class="keyword">Set</span> OutMail = OutApp.CreateItem(<span class="number">0</span>)</span><br><span class="line">	<span class="keyword">With</span> OutMail</span><br><span class="line">		.<span class="keyword">to</span> = <span class="string">&quot;Sales@FrontLinePaper.com&quot;</span></span><br><span class="line">		.Subject = <span class="string">&quot;Growth Report&quot;</span></span><br><span class="line">		.Body = <span class="string">&quot;Hello Team, Please find attached Growth Report.&quot;</span></span><br><span class="line">		.Attachments.Add ActiveWorkbook.FullName</span><br><span class="line">		.display</span><br><span class="line">	<span class="keyword">End</span> <span class="keyword">With</span></span><br><span class="line">	<span class="keyword">Set</span> OutMail = <span class="literal">Nothing</span></span><br><span class="line">	<span class="keyword">Set</span> OutApp = <span class="literal">Nothing</span></span><br><span class="line"><span class="keyword">End</span> <span class="keyword">Sub</span></span><br></pre></td></tr></table></figure>
<p>使用此宏代码可以通过电子邮件快速发送活动工作簿。您可以在代码中更改主题，电子邮件和正文文本，如果要直接发送此邮件，请使用“ 。发送“而不是””。显示”。</p>
<h4 id="52-将工作簿添加到邮件附件"><a href="#52-将工作簿添加到邮件附件" class="headerlink" title="52. 将工作簿添加到邮件附件"></a>52. 将工作簿添加到邮件附件</h4><figure class="highlight isbl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">Sub</span> <span class="function"><span class="title">OpenWorkbookAsAttachment</span>()</span></span><br><span class="line">	<span class="variable"><span class="class">Application</span>.<span class="class">Dialogs</span></span>(<span class="variable">xlDialogSendMail</span>).Show</span><br><span class="line"><span class="variable">End</span> <span class="variable">Sub</span> <span class="string">&#x27;Translate By Tmtony</span></span><br></pre></td></tr></table></figure>
<p>运行此宏后，它将打开您的默认邮件客户端，并将其作为附件附加活动工作簿。(整理：<br>@小辣椒高效Office<br> ）</p>
<h4 id="53-欢迎辞"><a href="#53-欢迎辞" class="headerlink" title="53. 欢迎辞"></a>53. 欢迎辞</h4><figure class="highlight vbnet"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">Sub</span> auto_open()</span><br><span class="line">	MsgBox _</span><br><span class="line">	<span class="string">&quot;Welcome To ExcelChamps &amp; Thanks for downloading this file.&quot;</span></span><br><span class="line"><span class="keyword">End</span> <span class="keyword">Sub</span></span><br></pre></td></tr></table></figure>
<p>您可以使用auto_open来执行打开文件的任务，您所要做的就是将宏命名为“auto_open”。</p>
<h4 id="54-结束语"><a href="#54-结束语" class="headerlink" title="54. 结束语"></a>54. 结束语</h4><figure class="highlight vim"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">Sub auto_close()</span><br><span class="line">	MsgBox <span class="comment">&quot;Bye Bye! Don&#x27;t forget to check other cool stuff on</span></span><br><span class="line">	excelchamps.<span class="keyword">com</span><span class="comment">&quot;</span></span><br><span class="line">End Sub</span><br></pre></td></tr></table></figure>
<p>您可以使用close_open来执行打开文件的任务，您所要做的就是将宏命名为“close_open”。</p>
<h4 id="55-对打开的未保存工作簿进行计数"><a href="#55-对打开的未保存工作簿进行计数" class="headerlink" title="55. 对打开的未保存工作簿进行计数"></a>55. 对打开的未保存工作簿进行计数</h4><figure class="highlight vbnet"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">Sub</span> VisibleWorkbooks()</span><br><span class="line">	<span class="keyword">Dim</span> book <span class="keyword">As</span> Workbook</span><br><span class="line">	<span class="keyword">Dim</span> i <span class="keyword">As</span> <span class="type">Integer</span></span><br><span class="line">	<span class="keyword">For</span> <span class="keyword">Each</span> book <span class="keyword">In</span> Workbooks</span><br><span class="line">		<span class="keyword">If</span> book.Saved = <span class="literal">False</span> <span class="keyword">Then</span></span><br><span class="line">			i = i + <span class="number">1</span></span><br><span class="line">		<span class="keyword">End</span> <span class="keyword">If</span></span><br><span class="line">	<span class="keyword">Next</span> book</span><br><span class="line">	MsgBox i</span><br><span class="line"><span class="keyword">End</span> <span class="keyword">Sub</span></span><br></pre></td></tr></table></figure>
<p>假设您有5-10个打开的工作簿，您可以使用此代码来获取尚未保存的工作簿的数量。数据透视表代码 这些代码将帮助您在快速管理数据透视表中并进行一些更改。</p>
<h4 id="56-隐藏数据透视表小计"><a href="#56-隐藏数据透视表小计" class="headerlink" title="56. 隐藏数据透视表小计"></a>56. 隐藏数据透视表小计</h4><figure class="highlight vbnet"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">Sub</span> HideSubtotals()</span><br><span class="line">	<span class="keyword">Dim</span> pt <span class="keyword">As</span> PivotTable</span><br><span class="line">	<span class="keyword">Dim</span> pf <span class="keyword">As</span> PivotField</span><br><span class="line">	<span class="keyword">On</span> <span class="keyword">Error</span> <span class="keyword">Resume</span> <span class="keyword">Next</span></span><br><span class="line">	<span class="keyword">Set</span> pt = ActiveSheet.PivotTables(ActiveCell.PivotTable.Name)</span><br><span class="line">	<span class="keyword">If</span> pt <span class="built_in">Is</span> <span class="literal">Nothing</span> <span class="keyword">Then</span></span><br><span class="line">		MsgBox <span class="string">&quot;You must place your cursor inside of a PivotTable.&quot;</span></span><br><span class="line">		<span class="keyword">Exit</span> <span class="keyword">Sub</span></span><br><span class="line">	<span class="keyword">End</span> <span class="keyword">If</span></span><br><span class="line">	<span class="keyword">For</span> <span class="keyword">Each</span> pf <span class="keyword">In</span> pt.PivotFields</span><br><span class="line">		pf.Subtotals(<span class="number">1</span>) = <span class="literal">True</span></span><br><span class="line">		pf.Subtotals(<span class="number">1</span>) = <span class="literal">False</span></span><br><span class="line">	<span class="keyword">Next</span> pf</span><br><span class="line"><span class="keyword">End</span> <span class="keyword">Sub</span></span><br></pre></td></tr></table></figure>
<p>如果要隐藏所有小计，只需运行此代码。首先，请确保从数据透视表中选择一个单元格，然后运行此宏。</p>
<h4 id="57-刷新所有数据透视表"><a href="#57-刷新所有数据透视表" class="headerlink" title="57. 刷新所有数据透视表"></a>57. 刷新所有数据透视表</h4><figure class="highlight vbnet"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">Sub</span> vba_referesh_all_pivots()</span><br><span class="line">	<span class="keyword">Dim</span> pt <span class="keyword">As</span> PivotTable</span><br><span class="line">	<span class="keyword">For</span> <span class="keyword">Each</span> pt <span class="keyword">In</span> ActiveWorkbook.PivotTables</span><br><span class="line">		pt.RefreshTable</span><br><span class="line">	<span class="keyword">Next</span> pt</span><br><span class="line"><span class="keyword">End</span> <span class="keyword">Sub</span> <span class="comment">&#x27;Translate By Tmtony</span></span><br></pre></td></tr></table></figure>

<p>刷新所有数据透视表的超快速方法。只需运行此代码，工作簿中的所有数据透视表都将在一次射击中刷新。</p>
<h4 id="58-创建数据透视表"><a href="#58-创建数据透视表" class="headerlink" title="58. 创建数据透视表"></a>58. 创建数据透视表</h4><p>Follow this step by step guide to create a pivot table using VBA.</p>
<h4 id="59-自动更新数据透视表范围"><a href="#59-自动更新数据透视表范围" class="headerlink" title="59. 自动更新数据透视表范围"></a>59. 自动更新数据透视表范围</h4><figure class="highlight vbnet"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">Sub</span> UpdatePivotTableRange()</span><br><span class="line">	<span class="keyword">Dim</span> Data_Sheet <span class="keyword">As</span> Worksheet</span><br><span class="line">	<span class="keyword">Dim</span> Pivot_Sheet <span class="keyword">As</span> Worksheet</span><br><span class="line">	<span class="keyword">Dim</span> StartPoint <span class="keyword">As</span> Range</span><br><span class="line">	<span class="keyword">Dim</span> DataRange <span class="keyword">As</span> Range</span><br><span class="line">	<span class="keyword">Dim</span> PivotName <span class="keyword">As</span> <span class="type">String</span></span><br><span class="line">	<span class="keyword">Dim</span> NewRange <span class="keyword">As</span> <span class="type">String</span></span><br><span class="line">	<span class="keyword">Dim</span> LastCol <span class="keyword">As</span> <span class="type">Long</span></span><br><span class="line">	<span class="keyword">Dim</span> lastRow <span class="keyword">As</span> <span class="type">Long</span></span><br><span class="line"><span class="comment">&#x27; 	Set Pivot Table &amp; Source Worksheet</span></span><br><span class="line">	<span class="keyword">Set</span> Data_Sheet = ThisWorkbook.Worksheets(<span class="string">&quot;PivotTableData3&quot;</span>)</span><br><span class="line">	<span class="keyword">Set</span> Pivot_Sheet = ThisWorkbook.Worksheets(<span class="string">&quot;Pivot3&quot;</span>)</span><br><span class="line"><span class="comment">&#x27; 	Enter in Pivot Table Name</span></span><br><span class="line">	PivotName = <span class="string">&quot;PivotTable2&quot;</span></span><br><span class="line"><span class="comment">&#x27; 	Defining Staring Point &amp; Dynamic Range</span></span><br><span class="line">	Data_Sheet.Activate</span><br><span class="line">	<span class="keyword">Set</span> StartPoint = Data_Sheet.Range(<span class="string">&quot;A1&quot;</span>)</span><br><span class="line">	LastCol = StartPoint.<span class="keyword">End</span>(xlToRight).Column</span><br><span class="line">	DownCell = StartPoint.<span class="keyword">End</span>(xlDown).Row</span><br><span class="line">	<span class="keyword">Set</span> DataRange = Data_Sheet.Range(StartPoint, Cells(DownCell, LastCol))</span><br><span class="line">	NewRange = Data_Sheet.Name &amp; <span class="string">&quot;!&quot;</span> &amp; DataRange.Address(ReferenceStyle:=xlR1C1)</span><br><span class="line"><span class="comment">&#x27; 	Change Pivot Table Data Source Range Address</span></span><br><span class="line">	Pivot_Sheet.PivotTables(PivotName). _</span><br><span class="line">	ChangePivotCache ActiveWorkbook. _</span><br><span class="line">	PivotCaches.Create(SourceType:=xlDatabase, SourceData:=NewRange)</span><br><span class="line"><span class="comment">&#x27; 	Ensure Pivot Table is Refreshed</span></span><br><span class="line">	Pivot_Sheet.PivotTables(PivotName).RefreshTable</span><br><span class="line"><span class="comment">&#x27; 	Complete Message</span></span><br><span class="line">	Pivot_Sheet.Activate</span><br><span class="line">	MsgBox <span class="string">&quot;Your Pivot Table is now updated.&quot;</span></span><br><span class="line"><span class="keyword">End</span> <span class="keyword">Sub</span></span><br></pre></td></tr></table></figure>
<p>如果您不使用Excel表格，则可以使用此代码来更新数据透视表范围。 （整理：<br>@小辣椒高效Office<br> ）</p>
<h4 id="60-禁用-x2F-启用获取透视数据"><a href="#60-禁用-x2F-启用获取透视数据" class="headerlink" title="60. 禁用&#x2F;启用获取透视数据"></a>60. 禁用&#x2F;启用获取透视数据</h4><figure class="highlight isbl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">Sub</span> <span class="function"><span class="title">activateGetPivotData</span>()</span></span><br><span class="line">	<span class="variable"><span class="class">Application</span>.GenerateGetPivotData</span> = <span class="variable"><span class="literal">True</span></span></span><br><span class="line"><span class="variable">End</span> <span class="variable">Sub</span></span><br></pre></td></tr></table></figure>
<p>Sub deactivateGetPivotData（） Application.GenerateGetPivotData &#x3D; False 要禁用&#x2F;启用GetPivotData功能，您需要使用Excel选项。但是使用此代码，您只需单击一下即可完成。图表代码 使用这些VBA代码在Excel中管理图表并节省大量时间。</p>
<h4 id="61-更改图表类型"><a href="#61-更改图表类型" class="headerlink" title="61. 更改图表类型"></a>61. 更改图表类型</h4><figure class="highlight vbnet"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">Sub</span> ChangeChartType()</span><br><span class="line">	ActiveChart.ChartType = xlColumnClustered</span><br><span class="line"><span class="keyword">End</span> <span class="keyword">Sub</span></span><br></pre></td></tr></table></figure>
<p>此代码将帮助您转换图表类型，而无需使用选项卡中的图表选项。您所要做的就是指定要转换为的类型。下面的代码会将选定的图表转换为簇状柱形图。不同类型的代码不同，您可以从这里找到所有这些类型。</p>
<h4 id="62-将图表粘贴为图像"><a href="#62-将图表粘贴为图像" class="headerlink" title="62. 将图表粘贴为图像"></a>62. 将图表粘贴为图像</h4><figure class="highlight mathematica"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">Sub</span> <span class="variable">ConvertChartToPicture</span><span class="punctuation">(</span><span class="punctuation">)</span></span><br><span class="line">	<span class="variable">ActiveChart</span><span class="operator">.</span><span class="variable">ChartArea</span><span class="operator">.</span><span class="variable">Copy</span></span><br><span class="line">	<span class="variable">ActiveSheet</span><span class="operator">.</span><span class="built_in">Range</span><span class="punctuation">(</span><span class="string">&quot;A1&quot;</span><span class="punctuation">)</span><span class="operator">.</span><span class="built_in">Select</span></span><br><span class="line">	<span class="variable">ActiveSheet</span><span class="operator">.</span><span class="variable">Pictures</span><span class="operator">.</span><span class="built_in">Paste</span><span class="operator">.</span><span class="built_in">Select</span></span><br><span class="line"><span class="built_in">End</span> <span class="variable">Sub</span> <span class="operator">&#x27;</span><span class="built_in">Translate</span> <span class="variable">By</span> <span class="variable">Tmtony</span></span><br></pre></td></tr></table></figure>

<p>此代码将帮助您将图表转换为图像。您只需要选择图表并运行此代码即可。</p>
<h4 id="63-添加图表标题"><a href="#63-添加图表标题" class="headerlink" title="63. 添加图表标题"></a>63. 添加图表标题</h4><figure class="highlight vbscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">Sub</span> AddChartTitle()</span><br><span class="line">	<span class="keyword">Dim</span> i As Variant</span><br><span class="line">	i = <span class="built_in">InputBox</span>(<span class="string">&quot;Please enter your chart title&quot;</span>, <span class="string">&quot;Chart Title&quot;</span>)</span><br><span class="line">	<span class="keyword">On</span> <span class="keyword">Error</span> <span class="keyword">GoTo</span> Last</span><br><span class="line">	ActiveChart.SetElement (msoElementChartTitleAboveChart)</span><br><span class="line">	ActiveChart.ChartTitle.Text = i</span><br><span class="line">	Last:</span><br><span class="line">	<span class="keyword">Exit</span> <span class="keyword">Sub</span></span><br><span class="line"><span class="keyword">End</span> <span class="keyword">Sub</span></span><br></pre></td></tr></table></figure>
<p>首先，您需要选择图表并运行此代码。您将获得一个输入框来输入图表标题。高级代码 可用于在电子表格中预制高级任务的一些代码。</p>
<h4 id="64-将所选范围另存为-PDF"><a href="#64-将所选范围另存为-PDF" class="headerlink" title="64. 将所选范围另存为 PDF"></a>64. 将所选范围另存为 PDF</h4><figure class="highlight vbnet"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">Sub</span> HideSubtotals()</span><br><span class="line">	<span class="keyword">Dim</span> pt <span class="keyword">As</span> PivotTable</span><br><span class="line">	<span class="keyword">Dim</span> pf <span class="keyword">As</span> PivotField</span><br><span class="line">	<span class="keyword">On</span> <span class="keyword">Error</span> <span class="keyword">Resume</span> <span class="keyword">Next</span></span><br><span class="line">	<span class="keyword">Set</span> pt = ActiveSheet.PivotTables(ActiveCell.PivotTable.name)</span><br><span class="line">	<span class="keyword">If</span> pt <span class="built_in">Is</span> <span class="literal">Nothing</span> <span class="keyword">Then</span></span><br><span class="line">		MsgBox <span class="string">&quot;You must place your cursor inside of a PivotTable.&quot;</span></span><br><span class="line">		<span class="keyword">Exit</span> <span class="keyword">Sub</span></span><br><span class="line">	<span class="keyword">End</span> <span class="keyword">If</span></span><br><span class="line">	<span class="keyword">For</span> <span class="keyword">Each</span> pf <span class="keyword">In</span> pt.PivotFields</span><br><span class="line">		pf.Subtotals(<span class="number">1</span>) = <span class="literal">True</span></span><br><span class="line">		pf.Subtotals(<span class="number">1</span>) = <span class="literal">False</span></span><br><span class="line">	<span class="keyword">Next</span> pf</span><br><span class="line"><span class="keyword">End</span> <span class="keyword">Sub</span></span><br></pre></td></tr></table></figure>
<p>如果要隐藏所有小计，只需运行此代码。首先，请确保从数据透视表中选择一个单元格，然后运行此宏。</p>
<h4 id="65-创建目录"><a href="#65-创建目录" class="headerlink" title="65. 创建目录"></a>65. 创建目录</h4><figure class="highlight vbnet"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">Sub</span> TableofContent()</span><br><span class="line">	<span class="keyword">Dim</span> i <span class="keyword">As</span> <span class="type">Long</span></span><br><span class="line">	<span class="keyword">On</span> <span class="keyword">Error</span> <span class="keyword">Resume</span> <span class="keyword">Next</span></span><br><span class="line">	Application.DisplayAlerts = <span class="literal">False</span></span><br><span class="line">	Worksheets(<span class="string">&quot;Table of Content&quot;</span>).Delete</span><br><span class="line">	Application.DisplayAlerts = <span class="literal">True</span></span><br><span class="line">	<span class="keyword">On</span> <span class="keyword">Error</span> <span class="keyword">GoTo</span> <span class="number">0</span></span><br><span class="line">	ThisWorkbook.Sheets.Add Before:=ThisWorkbook.Worksheets(<span class="number">1</span>)</span><br><span class="line">	ActiveSheet.Name = <span class="string">&quot;Table of Content&quot;</span></span><br><span class="line">	<span class="keyword">For</span> i = <span class="number">1</span> <span class="keyword">To</span> Sheets.Count</span><br><span class="line">		<span class="keyword">With</span> ActiveSheet</span><br><span class="line">			.Hyperlinks.Add _</span><br><span class="line">			Anchor:=ActiveSheet.Cells(i, <span class="number">1</span>), _</span><br><span class="line">			Address:=<span class="string">&quot;&quot;</span>, _</span><br><span class="line">			SubAddress:=<span class="string">&quot;&#x27;&quot;</span> &amp; Sheets(i).Name &amp; <span class="string">&quot;&#x27;!A1&quot;</span>, _</span><br><span class="line">			ScreenTip:=Sheets(i).Name, _</span><br><span class="line">			TextToDisplay:=Sheets(i).Name</span><br><span class="line">		<span class="keyword">End</span> <span class="keyword">With</span></span><br><span class="line">	<span class="keyword">Next</span> i</span><br><span class="line"><span class="keyword">End</span> <span class="keyword">Sub</span></span><br></pre></td></tr></table></figure>
<p>假设您的工作簿中有超过 100 个工作表，现在很难导航。不要担心这个宏代码会拯救一切。当您运行此代码时，它将创建一个新工作表，并创建一个带有超链接的工作表索引。 （整理：<br>@小辣椒高效Office<br> ）</p>
<h4 id="66-将范围转换为图像"><a href="#66-将范围转换为图像" class="headerlink" title="66.将范围转换为图像"></a>66.将范围转换为图像</h4><figure class="highlight mathematica"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">Sub</span> <span class="variable">PasteAsPicture</span><span class="punctuation">(</span><span class="punctuation">)</span></span><br><span class="line">	<span class="variable">Application</span><span class="operator">.</span><span class="variable">CutCopyMode</span> <span class="operator">=</span> <span class="built_in">False</span></span><br><span class="line">	<span class="built_in">Selection</span><span class="operator">.</span><span class="variable">Copy</span></span><br><span class="line">	<span class="variable">ActiveSheet</span><span class="operator">.</span><span class="variable">Pictures</span><span class="operator">.</span><span class="built_in">Paste</span><span class="operator">.</span><span class="built_in">Select</span></span><br><span class="line"><span class="built_in">End</span> <span class="variable">Sub</span></span><br></pre></td></tr></table></figure>
<p>将所选范围粘贴为图像。您只需要选择范围，运行此代码后，它将自动插入该范围的图片。</p>
<h4 id="67-插入链接的图片"><a href="#67-插入链接的图片" class="headerlink" title="67. 插入链接的图片"></a>67. 插入链接的图片</h4><figure class="highlight mathematica"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">Sub</span> <span class="variable">LinkedPicture</span><span class="punctuation">(</span><span class="punctuation">)</span></span><br><span class="line">	<span class="built_in">Selection</span><span class="operator">.</span><span class="variable">Copy</span></span><br><span class="line">	<span class="variable">ActiveSheet</span><span class="operator">.</span><span class="variable">Pictures</span><span class="operator">.</span><span class="built_in">Paste</span><span class="punctuation">(</span><span class="variable">Link</span><span class="operator">:=</span><span class="built_in">True</span><span class="punctuation">)</span><span class="operator">.</span><span class="built_in">Select</span></span><br><span class="line"><span class="built_in">End</span> <span class="variable">Sub</span> <span class="operator">&#x27;</span><span class="built_in">Translate</span> <span class="variable">By</span> <span class="variable">Tmtony</span></span><br></pre></td></tr></table></figure>

<p>此VBA代码会将您选择的范围转换为链接的图片，您可以在任何您想要的地方使用该图像。</p>
<h4 id="68-使用文本到语音转换"><a href="#68-使用文本到语音转换" class="headerlink" title="68. 使用文本到语音转换"></a>68. 使用文本到语音转换</h4><figure class="highlight mathematica"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">Sub</span> <span class="built_in">Speak</span><span class="punctuation">(</span><span class="punctuation">)</span></span><br><span class="line">	<span class="built_in">Selection</span><span class="operator">.</span><span class="built_in">Speak</span></span><br><span class="line"><span class="built_in">End</span> <span class="variable">Sub</span></span><br></pre></td></tr></table></figure>
<p>只需选择一个范围并运行此代码。Excel将逐个单元格地说出您在该范围内的所有文本。</p>
<h4 id="69-激活数据输入表单"><a href="#69-激活数据输入表单" class="headerlink" title="69. 激活数据输入表单"></a>69. 激活数据输入表单</h4><figure class="highlight vbnet"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">Sub</span> DataForm()</span><br><span class="line">	ActiveSheet.ShowDataForm</span><br><span class="line"><span class="keyword">End</span> <span class="keyword">Sub</span></span><br></pre></td></tr></table></figure>
<p>有一个默认的数据输入表单，可用于数据输入。</p>
<h4 id="70-使用目标搜索"><a href="#70-使用目标搜索" class="headerlink" title="70.使用目标搜索"></a>70.使用目标搜索</h4><figure class="highlight vbnet"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">Sub</span> GoalSeekVBA()</span><br><span class="line">	<span class="keyword">Dim</span> Target <span class="keyword">As</span> <span class="type">Long</span></span><br><span class="line">	<span class="keyword">On</span> <span class="keyword">Error</span> <span class="keyword">GoTo</span> Errorhandler</span><br><span class="line">	Target = InputBox(<span class="string">&quot;Enter the required value&quot;</span>, <span class="string">&quot;Enter Value&quot;</span>)</span><br><span class="line">	Worksheets(<span class="string">&quot;Goal_Seek&quot;</span>).Activate</span><br><span class="line">	<span class="keyword">With</span> ActiveSheet.Range(<span class="string">&quot;C7&quot;</span>)</span><br><span class="line">		.GoalSeek_ Goal:=Target, _</span><br><span class="line">		ChangingCell:=Range(<span class="string">&quot;C2&quot;</span>)</span><br><span class="line">	<span class="keyword">End</span> <span class="keyword">With</span></span><br><span class="line">	<span class="keyword">Exit</span> <span class="keyword">Sub</span></span><br><span class="line">	Errorhandler: MsgBox (<span class="string">&quot;Sorry, value is not valid.&quot;</span>)</span><br><span class="line"><span class="keyword">End</span> <span class="keyword">Sub</span></span><br></pre></td></tr></table></figure>
<p>目标寻求可以非常有助于您解决复杂的问题。在使用此代码之前，请在此处了解有关目标查找的详细信息。</p>
<h4 id="71-在谷歌上搜索的VBA代码"><a href="#71-在谷歌上搜索的VBA代码" class="headerlink" title="71.在谷歌上搜索的VBA代码"></a>71.在谷歌上搜索的VBA代码</h4><figure class="highlight vbnet"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">Sub</span> SearchWindow32()</span><br><span class="line">	<span class="keyword">Dim</span> chromePath <span class="keyword">As</span> <span class="type">String</span></span><br><span class="line">	<span class="keyword">Dim</span> search_string <span class="keyword">As</span> <span class="type">String</span></span><br><span class="line">	<span class="keyword">Dim</span> query <span class="keyword">As</span> <span class="type">String</span></span><br><span class="line">	query = InputBox(<span class="string">&quot;Enter here your search here&quot;</span>, <span class="string">&quot;Google Search&quot;</span>)</span><br><span class="line">	search_string = query</span><br><span class="line">	search_string = Replace(search_string, <span class="string">&quot; &quot;</span>, <span class="string">&quot;+&quot;</span>)</span><br><span class="line"><span class="comment">&#x27; 	Uncomment the following line for Windows 64 versions and comment out Windows 32 versions&#x27;</span></span><br><span class="line"><span class="comment">&#x27; 	chromePath = &quot;C:Program FilesGoogleChromeApplicationchrome.exe&quot;</span></span><br><span class="line"><span class="comment">&#x27; 	Uncomment the following line for Windows 32 versions and comment out Windows 64 versions</span></span><br><span class="line"><span class="comment">&#x27; 	chromePath = &quot;C:Program Files (x86)GoogleChromeApplicationchrome.exe&quot;</span></span><br><span class="line">	Shell (chromePath &amp; <span class="string">&quot; -url http://google.com/#q=&quot;</span> &amp; search_string)</span><br><span class="line"><span class="keyword">End</span> <span class="keyword">Sub</span></span><br></pre></td></tr></table></figure>
<p>请点击这篇文章，了解如何使用此VBA代码在Google上进行搜索。公式代码 这些代码将帮助您计算或获得通常使用工作表函数和公式的结果。</p>
<h4 id="72-将所有公式转换为值"><a href="#72-将所有公式转换为值" class="headerlink" title="72. 将所有公式转换为值"></a>72. 将所有公式转换为值</h4><figure class="highlight vbnet"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">Sub</span> convertToValues()</span><br><span class="line">	<span class="keyword">Dim</span> MyRange <span class="keyword">As</span> Range</span><br><span class="line">	<span class="keyword">Dim</span> MyCell <span class="keyword">As</span> Range</span><br><span class="line">	<span class="keyword">Select</span> <span class="keyword">Case</span> _</span><br><span class="line">		MsgBox(<span class="string">&quot;You Can&#x27;t Undo This Action. &quot;</span> _</span><br><span class="line">		&amp; <span class="string">&quot;Save Workbook First?&quot;</span>, vbYesNoCancel, _</span><br><span class="line">		<span class="string">&quot;Alert&quot;</span>)</span><br><span class="line">		<span class="keyword">Case</span> <span class="built_in">Is</span> = vbYes</span><br><span class="line">		ThisWorkbook.Save</span><br><span class="line">		<span class="keyword">Case</span> <span class="built_in">Is</span> = vbCancel</span><br><span class="line">		<span class="keyword">Exit</span> <span class="keyword">Sub</span></span><br><span class="line">	<span class="keyword">End</span> <span class="keyword">Select</span></span><br><span class="line">	<span class="keyword">Set</span> MyRange = Selection</span><br><span class="line">	<span class="keyword">For</span> <span class="keyword">Each</span> MyCell <span class="keyword">In</span> MyRange</span><br><span class="line">		<span class="keyword">If</span> MyCell.HasFormula <span class="keyword">Then</span></span><br><span class="line">			MyCell.Formula = MyCell.Value</span><br><span class="line">		<span class="keyword">End</span> <span class="keyword">If</span></span><br><span class="line">	<span class="keyword">Next</span> MyCell</span><br><span class="line"><span class="keyword">End</span> <span class="keyword">Sub</span> <span class="comment">&#x27;Translate By Tmtony</span></span><br></pre></td></tr></table></figure>

<p>只需将公式转换为值即可。运行此宏时，它会快速将公式更改为绝对值。</p>
<h4 id="73-从所选单元格中删除空格"><a href="#73-从所选单元格中删除空格" class="headerlink" title="73.从所选单元格中删除空格"></a>73.从所选单元格中删除空格</h4><figure class="highlight vbscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">Sub</span> RemoveSpaces()</span><br><span class="line">	<span class="keyword">Dim</span> myRange As Range</span><br><span class="line">	<span class="keyword">Dim</span> myCell As Range</span><br><span class="line">	<span class="keyword">Select</span> <span class="keyword">Case</span> <span class="built_in">MsgBox</span>(<span class="string">&quot;You Can&#x27;t Undo This Action. &quot;</span> _</span><br><span class="line">		&amp; <span class="string">&quot;Save Workbook First?&quot;</span>, _</span><br><span class="line">		vbYesNoCancel, <span class="string">&quot;Alert&quot;</span>)</span><br><span class="line">		<span class="keyword">Case</span> <span class="keyword">Is</span> = vbYesThisWorkbook.Save</span><br><span class="line">		<span class="keyword">Case</span> <span class="keyword">Is</span> = vbCancel</span><br><span class="line">		<span class="keyword">Exit</span> <span class="keyword">Sub</span></span><br><span class="line">	<span class="keyword">End</span> <span class="keyword">Select</span></span><br><span class="line">	<span class="keyword">Set</span> myRange = Selection</span><br><span class="line">	<span class="keyword">For</span> <span class="keyword">Each</span> myCell <span class="keyword">In</span> myRange</span><br><span class="line">		<span class="keyword">If</span> <span class="keyword">Not</span> <span class="built_in">IsEmpty</span>(myCell) <span class="keyword">Then</span></span><br><span class="line">			myCell = <span class="built_in">Trim</span>(myCell)</span><br><span class="line">		<span class="keyword">End</span> <span class="keyword">If</span></span><br><span class="line">	<span class="keyword">Next</span> myCell</span><br><span class="line"><span class="keyword">End</span> <span class="keyword">Sub</span></span><br></pre></td></tr></table></figure>
<p>此列表中最有用的宏之一。它将检查您的选择，然后从中删除所有多余的空格。</p>
<h4 id="74-从字符串中删除字符"><a href="#74-从字符串中删除字符" class="headerlink" title="74. 从字符串中删除字符"></a>74. 从字符串中删除字符</h4><figure class="highlight vbnet"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">Public</span> <span class="keyword">Function</span> removeFirstC(rng <span class="keyword">As</span> <span class="type">String</span>, cnt <span class="keyword">As</span> <span class="type">Long</span>)</span><br><span class="line">	removeFirstC = Right(rng, Len(rng) - cnt)</span><br><span class="line"><span class="keyword">End</span> <span class="keyword">Function</span></span><br></pre></td></tr></table></figure>
<p>Simply remove characters from the starting of a text string. All you need is to refer to a cell or insert a text into the function and number of characters to remove from the text string.<br>It has two arguments “rng” for the text string and “cnt” for the count of characters to remove. For Example: If you want to remove first characters from a cell, you need to enter 1 in cnt.</p>
<h4 id="75-在-Excel-中添加插入度数符号"><a href="#75-在-Excel-中添加插入度数符号" class="headerlink" title="75. 在 Excel 中添加插入度数符号"></a>75. 在 Excel 中添加插入度数符号</h4><figure class="highlight mathematica"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">Sub</span> <span class="variable">degreeSymbol</span><span class="punctuation">(</span> <span class="punctuation">)</span></span><br><span class="line">	<span class="variable">Dim</span> <span class="variable">rng</span> <span class="variable">As</span> <span class="built_in">Range</span></span><br><span class="line">	<span class="built_in">For</span> <span class="variable">Each</span> <span class="variable">rng</span> <span class="built_in">In</span> <span class="built_in">Selection</span></span><br><span class="line">		<span class="variable">rng</span><span class="operator">.</span><span class="built_in">Select</span></span><br><span class="line">		<span class="built_in">If</span> <span class="variable">ActiveCell</span> <span class="operator">&lt;&gt;</span> <span class="string">&quot;&quot;</span> <span class="variable">Then</span></span><br><span class="line">			<span class="built_in">If</span> <span class="variable">IsNumeric</span><span class="punctuation">(</span><span class="variable">ActiveCell</span><span class="operator">.</span><span class="built_in">Value</span><span class="punctuation">)</span> <span class="variable">Then</span></span><br><span class="line">				<span class="variable">ActiveCell</span><span class="operator">.</span><span class="built_in">Value</span> <span class="operator">=</span> <span class="variable">ActiveCell</span><span class="operator">.</span><span class="built_in">Value</span> <span class="operator">&amp;</span> <span class="string">&quot;°&quot;</span></span><br><span class="line">			<span class="built_in">End</span> <span class="built_in">If</span></span><br><span class="line">		<span class="built_in">End</span> <span class="built_in">If</span></span><br><span class="line">	<span class="built_in">Next</span></span><br><span class="line"><span class="built_in">End</span> <span class="variable">Sub</span></span><br></pre></td></tr></table></figure>
<p>假设您在一列中有一个数字列表，并且您希望添加所有数字的度数符号。</p>
<h4 id="76-反转文本"><a href="#76-反转文本" class="headerlink" title="76. 反转文本"></a>76. 反转文本</h4><figure class="highlight vbnet"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">Public</span> <span class="keyword">Function</span> rvrse(<span class="keyword">ByVal</span> cell <span class="keyword">As</span> Range) <span class="keyword">As</span> <span class="type">String</span></span><br><span class="line">	rvrse = VBA.strReverse(cell.Value)</span><br><span class="line"><span class="keyword">End</span> <span class="keyword">Function</span></span><br></pre></td></tr></table></figure>
<p>All you have to do just enter “rvrse” function in a cell and refer to the cell in which you have text which you want to reverse.</p>
<h4 id="77-激活-R1C1-参考样式"><a href="#77-激活-R1C1-参考样式" class="headerlink" title="77. 激活 R1C1 参考样式"></a>77. 激活 R1C1 参考样式</h4><figure class="highlight isbl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">Sub</span> <span class="function"><span class="title">ActivateR1C1</span>()</span></span><br><span class="line">	<span class="variable"><span class="keyword">If</span></span> <span class="variable"><span class="class">Application</span>.ReferenceStyle</span> = <span class="variable">xlA1</span> <span class="variable">Then</span></span><br><span class="line">		<span class="variable"><span class="class">Application</span>.ReferenceStyle</span> = <span class="variable">xlR1C1</span></span><br><span class="line">		<span class="variable"><span class="keyword">Else</span></span></span><br><span class="line">		<span class="variable"><span class="class">Application</span>.ReferenceStyle</span> = <span class="variable">xlR1C1</span></span><br><span class="line">	<span class="variable">End</span> <span class="variable"><span class="keyword">If</span></span></span><br><span class="line"><span class="variable">End</span> <span class="variable">Sub</span> <span class="string">&#x27;Translate By Tmtony</span></span><br></pre></td></tr></table></figure>

<p>此宏代码将帮助您在不使用 Excel 选项的情况下激活 R1C1 引用样式。</p>
<h4 id="78-激活-A1-参考样式"><a href="#78-激活-A1-参考样式" class="headerlink" title="78. 激活 A1 参考样式"></a>78. 激活 A1 参考样式</h4><figure class="highlight isbl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">Sub</span> <span class="function"><span class="title">ActivateA1</span>()</span></span><br><span class="line">	<span class="variable"><span class="keyword">If</span></span> <span class="variable"><span class="class">Application</span>.ReferenceStyle</span> = <span class="variable">xlR1C1</span> <span class="variable">Then</span></span><br><span class="line">		<span class="variable"><span class="class">Application</span>.ReferenceStyle</span> = <span class="variable">xlA1</span></span><br><span class="line">		<span class="variable"><span class="keyword">Else</span></span></span><br><span class="line">		<span class="variable"><span class="class">Application</span>.ReferenceStyle</span> = <span class="variable">xlA1</span></span><br><span class="line">	<span class="variable">End</span> <span class="variable"><span class="keyword">If</span></span></span><br><span class="line"><span class="variable">End</span> <span class="variable">Sub</span></span><br></pre></td></tr></table></figure>
<p>此宏代码将帮助您在不使用Excel选项的情况下激活A1引用样式。 （整理：<br>@小辣椒高效Office<br> ）</p>
<h4 id="79-插入时间范围"><a href="#79-插入时间范围" class="headerlink" title="79. 插入时间范围"></a>79. 插入时间范围</h4><figure class="highlight vbnet"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">Sub</span> TimeStamp()</span><br><span class="line">	<span class="keyword">Dim</span> i <span class="keyword">As</span> <span class="type">Integer</span></span><br><span class="line">	<span class="keyword">For</span> i = <span class="number">1</span> <span class="keyword">To</span> <span class="number">24</span></span><br><span class="line">		ActiveCell.FormulaR1C1 = i &amp; <span class="string">&quot;:00&quot;</span></span><br><span class="line">		ActiveCell.NumberFormat = <span class="string">&quot;[$-409]h:mm AM/PM;@&quot;</span></span><br><span class="line">		ActiveCell.Offset(RowOffset:=<span class="number">1</span>, ColumnOffset:=<span class="number">0</span>).<span class="keyword">Select</span></span><br><span class="line">	<span class="keyword">Next</span> i</span><br><span class="line"><span class="keyword">End</span> <span class="keyword">Sub</span></span><br></pre></td></tr></table></figure>
<p>使用此代码，您可以按从 00：00 到 23：00 的顺序插入时间范围。</p>
<h4 id="80-将日期转换为天"><a href="#80-将日期转换为天" class="headerlink" title="80. 将日期转换为天"></a>80. 将日期转换为天</h4><figure class="highlight mathematica"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">Sub</span> <span class="variable">date2day</span><span class="punctuation">(</span><span class="punctuation">)</span></span><br><span class="line">	<span class="variable">Dim</span> <span class="variable">tempCell</span> <span class="variable">As</span> <span class="built_in">Range</span></span><br><span class="line">	<span class="built_in">Selection</span><span class="operator">.</span><span class="built_in">Value</span> <span class="operator">=</span> <span class="built_in">Selection</span><span class="operator">.</span><span class="built_in">Value</span></span><br><span class="line">	<span class="built_in">For</span> <span class="variable">Each</span> <span class="variable">tempCell</span> <span class="built_in">In</span> <span class="built_in">Selection</span></span><br><span class="line">		<span class="built_in">If</span> <span class="variable">IsDate</span><span class="punctuation">(</span><span class="variable">tempCell</span><span class="punctuation">)</span> <span class="operator">=</span> <span class="built_in">True</span> <span class="variable">Then</span></span><br><span class="line">			<span class="built_in">With</span> <span class="variable">tempCell</span></span><br><span class="line">				<span class="operator">.</span><span class="built_in">Value</span> <span class="operator">=</span> <span class="variable">Day</span><span class="punctuation">(</span><span class="variable">tempCell</span><span class="punctuation">)</span></span><br><span class="line">				<span class="operator">.</span><span class="built_in">NumberFormat</span> <span class="operator">=</span> <span class="string">&quot;0&quot;</span></span><br><span class="line">			<span class="built_in">End</span> <span class="built_in">With</span></span><br><span class="line">		<span class="built_in">End</span> <span class="built_in">If</span></span><br><span class="line">	<span class="built_in">Next</span> <span class="variable">tempCell</span></span><br><span class="line"><span class="built_in">End</span> <span class="variable">Sub</span></span><br></pre></td></tr></table></figure>
<p>如果您的工作表中有日期，并且想要将所有这些日期转换为天，那么此代码适合您。只需选择单元格的范围并运行此宏。</p>
<h4 id="81-将日期转换为年份"><a href="#81-将日期转换为年份" class="headerlink" title="81. 将日期转换为年份"></a>81. 将日期转换为年份</h4><figure class="highlight mathematica"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">Sub</span> <span class="variable">date2year</span><span class="punctuation">(</span><span class="punctuation">)</span></span><br><span class="line">	<span class="variable">Dim</span> <span class="variable">tempCell</span> <span class="variable">As</span> <span class="built_in">Range</span></span><br><span class="line">	<span class="built_in">Selection</span><span class="operator">.</span><span class="built_in">Value</span> <span class="operator">=</span> <span class="built_in">Selection</span><span class="operator">.</span><span class="built_in">Value</span></span><br><span class="line">	<span class="built_in">For</span> <span class="variable">Each</span> <span class="variable">tempCell</span> <span class="built_in">In</span> <span class="built_in">Selection</span></span><br><span class="line">		<span class="built_in">If</span> <span class="variable">IsDate</span><span class="punctuation">(</span><span class="variable">tempCell</span><span class="punctuation">)</span> <span class="operator">=</span> <span class="built_in">True</span> <span class="variable">Then</span></span><br><span class="line">			<span class="built_in">With</span> <span class="variable">tempCell</span></span><br><span class="line">				<span class="operator">.</span><span class="built_in">Value</span> <span class="operator">=</span> <span class="variable">Year</span><span class="punctuation">(</span><span class="variable">tempCell</span><span class="punctuation">)</span></span><br><span class="line">				<span class="operator">.</span><span class="built_in">NumberFormat</span> <span class="operator">=</span> <span class="string">&quot;0&quot;</span></span><br><span class="line">			<span class="built_in">End</span> <span class="built_in">With</span></span><br><span class="line">		<span class="built_in">End</span> <span class="built_in">If</span></span><br><span class="line">	<span class="built_in">Next</span> <span class="variable">tempCell</span></span><br><span class="line"><span class="built_in">End</span> <span class="variable">Sub</span></span><br></pre></td></tr></table></figure>
<p>此代码将日期转换为年份。</p>
<h4 id="82-从日期中删除时间"><a href="#82-从日期中删除时间" class="headerlink" title="82.从日期中删除时间"></a>82.从日期中删除时间</h4><figure class="highlight mathematica"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">Sub</span> <span class="variable">removeTime</span><span class="punctuation">(</span><span class="punctuation">)</span></span><br><span class="line">	<span class="variable">Dim</span> <span class="variable">Rng</span> <span class="variable">As</span> <span class="built_in">Range</span></span><br><span class="line">	<span class="built_in">For</span> <span class="variable">Each</span> <span class="variable">Rng</span> <span class="built_in">In</span> <span class="built_in">Selection</span></span><br><span class="line">		<span class="built_in">If</span> <span class="variable">IsDate</span><span class="punctuation">(</span><span class="variable">Rng</span><span class="punctuation">)</span> <span class="operator">=</span> <span class="built_in">True</span> <span class="variable">Then</span></span><br><span class="line">			<span class="variable">Rng</span><span class="operator">.</span><span class="built_in">Value</span> <span class="operator">=</span> <span class="variable">VBA</span><span class="operator">.</span><span class="variable">Int</span><span class="punctuation">(</span><span class="variable">Rng</span><span class="operator">.</span><span class="built_in">Value</span><span class="punctuation">)</span></span><br><span class="line">		<span class="built_in">End</span> <span class="built_in">If</span></span><br><span class="line">	<span class="built_in">Next</span></span><br><span class="line">	<span class="built_in">Selection</span><span class="operator">.</span><span class="built_in">NumberFormat</span> <span class="operator">=</span> <span class="string">&quot;dd-mmm-yy&quot;</span></span><br><span class="line"><span class="built_in">End</span> <span class="variable">Sub</span> <span class="operator">&#x27;</span><span class="built_in">Translate</span> <span class="variable">By</span> <span class="variable">Tmtony</span></span><br></pre></td></tr></table></figure>

<p>如果您有时间使用日期并希望将其删除，则可以使用此代码。</p>
<h4 id="83-从日期和时间中删除日期"><a href="#83-从日期和时间中删除日期" class="headerlink" title="83.从日期和时间中删除日期"></a>83.从日期和时间中删除日期</h4><figure class="highlight mathematica"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">Sub</span> <span class="variable">removeDate</span><span class="punctuation">(</span><span class="punctuation">)</span></span><br><span class="line">	<span class="variable">Dim</span> <span class="variable">Rng</span> <span class="variable">As</span> <span class="built_in">Range</span></span><br><span class="line">	<span class="built_in">For</span> <span class="variable">Each</span> <span class="variable">Rng</span> <span class="built_in">In</span> <span class="built_in">Selection</span></span><br><span class="line">		<span class="built_in">If</span> <span class="variable">IsDate</span><span class="punctuation">(</span><span class="variable">Rng</span><span class="punctuation">)</span> <span class="operator">=</span> <span class="built_in">True</span> <span class="variable">Then</span></span><br><span class="line">			<span class="variable">Rng</span><span class="operator">.</span><span class="built_in">Value</span> <span class="operator">=</span> <span class="variable">Rng</span><span class="operator">.</span><span class="built_in">Value</span> <span class="operator">-</span> <span class="variable">VBA</span><span class="operator">.</span><span class="variable">Fix</span><span class="punctuation">(</span><span class="variable">Rng</span><span class="operator">.</span><span class="built_in">Value</span><span class="punctuation">)</span></span><br><span class="line">		<span class="built_in">End</span> <span class="built_in">If</span></span><br><span class="line">	<span class="variable">NextSelection</span><span class="operator">.</span><span class="built_in">NumberFormat</span> <span class="operator">=</span> <span class="string">&quot;hh:mm:ss am/pm&quot;</span></span><br><span class="line"><span class="built_in">End</span> <span class="variable">Sub</span></span><br></pre></td></tr></table></figure>
<p>它将仅返回日期和时间值的时间。</p>
<h4 id="84-转换为大写"><a href="#84-转换为大写" class="headerlink" title="84. 转换为大写"></a>84. 转换为大写</h4><figure class="highlight mathematica"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">Sub</span> <span class="variable">convertUpperCase</span><span class="punctuation">(</span><span class="punctuation">)</span></span><br><span class="line">	<span class="variable">Dim</span> <span class="variable">Rng</span> <span class="variable">As</span> <span class="built_in">Range</span></span><br><span class="line">	<span class="built_in">For</span> <span class="variable">Each</span> <span class="variable">Rng</span> <span class="built_in">In</span> <span class="built_in">Selection</span></span><br><span class="line">		<span class="built_in">If</span> <span class="variable">Application</span><span class="operator">.</span><span class="variable">WorksheetFunction</span><span class="operator">.</span><span class="variable">IsText</span><span class="punctuation">(</span><span class="variable">Rng</span><span class="punctuation">)</span> <span class="variable">Then</span></span><br><span class="line">			<span class="variable">Rng</span><span class="operator">.</span><span class="built_in">Value</span> <span class="operator">=</span> <span class="variable">UCase</span><span class="punctuation">(</span><span class="variable">Rng</span><span class="punctuation">)</span></span><br><span class="line">		<span class="built_in">End</span> <span class="built_in">If</span></span><br><span class="line">	<span class="built_in">Next</span></span><br><span class="line"><span class="built_in">End</span> <span class="variable">Sub</span></span><br></pre></td></tr></table></figure>
<p>选择单元格并运行此代码。它将检查所选范围的每个单元格，然后将其转换为大写文本。</p>
<h4 id="85-转换为小写"><a href="#85-转换为小写" class="headerlink" title="85. 转换为小写"></a>85. 转换为小写</h4><figure class="highlight mathematica"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">Sub</span> <span class="variable">convertLowerCase</span><span class="punctuation">(</span><span class="punctuation">)</span></span><br><span class="line">	<span class="variable">Dim</span> <span class="variable">Rng</span> <span class="variable">As</span> <span class="built_in">Range</span></span><br><span class="line">	<span class="built_in">For</span> <span class="variable">Each</span> <span class="variable">Rng</span> <span class="built_in">In</span> <span class="built_in">Selection</span></span><br><span class="line">		<span class="built_in">If</span> <span class="variable">Application</span><span class="operator">.</span><span class="variable">WorksheetFunction</span><span class="operator">.</span><span class="variable">IsText</span><span class="punctuation">(</span><span class="variable">Rng</span><span class="punctuation">)</span> <span class="variable">Then</span></span><br><span class="line">			<span class="variable">Rng</span><span class="operator">.</span><span class="built_in">Value</span><span class="operator">=</span> <span class="variable">LCase</span><span class="punctuation">(</span><span class="variable">Rng</span><span class="punctuation">)</span></span><br><span class="line">		<span class="built_in">End</span> <span class="built_in">If</span></span><br><span class="line">	<span class="built_in">Next</span></span><br><span class="line"><span class="built_in">End</span> <span class="variable">Sub</span></span><br></pre></td></tr></table></figure>
<p>此代码将帮助您将所选文本转换为小写文本。只需选择有文本的单元格范围并运行此代码即可。如果单元格具有数字或文本以外的任何值，则该值将保持不变。</p>
<h4 id="86-转换为正确的大小写"><a href="#86-转换为正确的大小写" class="headerlink" title="86.转换为正确的大小写"></a>86.转换为正确的大小写</h4><figure class="highlight mathematica"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">Sub</span> <span class="variable">convertProperCase</span><span class="punctuation">(</span><span class="punctuation">)</span></span><br><span class="line">	<span class="variable">Dim</span> <span class="variable">Rng</span> <span class="variable">As</span> <span class="built_in">Range</span></span><br><span class="line">	<span class="built_in">For</span> <span class="variable">Each</span> <span class="variable">Rng</span> <span class="built_in">In</span> <span class="built_in">Selection</span></span><br><span class="line">		<span class="built_in">If</span> <span class="variable">WorksheetFunction</span><span class="operator">.</span><span class="variable">IsText</span><span class="punctuation">(</span><span class="variable">Rng</span><span class="punctuation">)</span> <span class="variable">Then</span></span><br><span class="line">			<span class="variable">Rng</span><span class="operator">.</span><span class="built_in">Value</span> <span class="operator">=</span> <span class="variable">WorksheetFunction</span><span class="operator">.</span><span class="variable">Proper</span><span class="punctuation">(</span><span class="variable">Rng</span><span class="operator">.</span><span class="built_in">Value</span><span class="punctuation">)</span></span><br><span class="line">		<span class="built_in">End</span> <span class="built_in">If</span></span><br><span class="line">	<span class="built_in">Next</span></span><br><span class="line"><span class="built_in">End</span> <span class="variable">Sub</span></span><br></pre></td></tr></table></figure>
<p>此代码将所选文本转换为正确的大小写，其中第一个字母大写，其余字母以小写。</p>
<h4 id="87-转换为句子大小写"><a href="#87-转换为句子大小写" class="headerlink" title="87. 转换为句子大小写"></a>87. 转换为句子大小写</h4><figure class="highlight mathematica"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">Sub</span> <span class="variable">convertTextCase</span><span class="punctuation">(</span><span class="punctuation">)</span></span><br><span class="line">	<span class="variable">Dim</span> <span class="variable">Rng</span> <span class="variable">As</span> <span class="built_in">Range</span></span><br><span class="line">	<span class="built_in">For</span> <span class="variable">Each</span> <span class="variable">Rng</span> <span class="built_in">In</span> <span class="built_in">Selection</span></span><br><span class="line">		<span class="built_in">If</span> <span class="variable">WorksheetFunction</span><span class="operator">.</span><span class="variable">IsText</span><span class="punctuation">(</span><span class="variable">Rng</span><span class="punctuation">)</span> <span class="variable">Then</span></span><br><span class="line">			<span class="variable">Rng</span><span class="operator">.</span><span class="built_in">Value</span> <span class="operator">=</span> <span class="variable">UCase</span><span class="punctuation">(</span><span class="built_in">Left</span><span class="punctuation">(</span><span class="variable">Rng</span><span class="operator">,</span> <span class="number">1</span><span class="punctuation">)</span><span class="punctuation">)</span> <span class="operator">&amp;</span> <span class="variable">LCase</span><span class="punctuation">(</span><span class="built_in">Right</span><span class="punctuation">(</span><span class="variable">Rng</span><span class="operator">,</span> <span class="variable">Len</span><span class="punctuation">(</span><span class="variable">Rng</span><span class="punctuation">)</span> <span class="operator">-</span> <span class="number">1</span><span class="punctuation">)</span><span class="punctuation">)</span></span><br><span class="line">		<span class="built_in">End</span> <span class="built_in">If</span></span><br><span class="line">	<span class="built_in">Next</span> <span class="variable">Rng</span></span><br><span class="line"><span class="built_in">End</span> <span class="variable">Sub</span> <span class="operator">&#x27;</span><span class="built_in">Translate</span> <span class="variable">By</span> <span class="variable">Tmtony</span></span><br></pre></td></tr></table></figure>

<p>在文本大小写中，第一个单词的第一个字母大写，并将所有单词都放在一个句子中，此代码将帮助您将普通文本转换为句子大小写。</p>
<h4 id="88-从选区中删除字符"><a href="#88-从选区中删除字符" class="headerlink" title="88. 从选区中删除字符"></a>88. 从选区中删除字符</h4><figure class="highlight vbnet"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">Sub</span> removeChar()</span><br><span class="line">	<span class="keyword">Dim</span> Rng <span class="keyword">As</span> Range</span><br><span class="line">	<span class="keyword">Dim</span> rc <span class="keyword">As</span> <span class="type">String</span></span><br><span class="line">	rc = InputBox(<span class="string">&quot;Character(s) to Replace&quot;</span>, <span class="string">&quot;Enter Value&quot;</span>)</span><br><span class="line">	<span class="keyword">For</span> <span class="keyword">Each</span> Rng <span class="keyword">In</span> Selection</span><br><span class="line">		Selection.Replace What:=rc, Replacement:=<span class="string">&quot;&quot;</span></span><br><span class="line">	<span class="keyword">Next</span></span><br><span class="line"><span class="keyword">End</span> <span class="keyword">Sub</span></span><br></pre></td></tr></table></figure>
<p>若要从所选单元格中删除特定字符，可以使用此代码。它将显示一个输入框，用于输入要删除的字符。</p>
<h4 id="89-整个工作表的字数统计"><a href="#89-整个工作表的字数统计" class="headerlink" title="89. 整个工作表的字数统计"></a>89. 整个工作表的字数统计</h4><figure class="highlight vbnet"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">Sub</span> Word_Count_Worksheet()</span><br><span class="line">	<span class="keyword">Dim</span> WordCnt <span class="keyword">As</span> <span class="type">Long</span></span><br><span class="line">	<span class="keyword">Dim</span> rng <span class="keyword">As</span> Range</span><br><span class="line">	<span class="keyword">Dim</span> S <span class="keyword">As</span> <span class="type">String</span></span><br><span class="line">	<span class="keyword">Dim</span> N <span class="keyword">As</span> <span class="type">Long</span></span><br><span class="line">	<span class="keyword">For</span> <span class="keyword">Each</span> rng <span class="keyword">In</span> ActiveSheet.UsedRange.Cells</span><br><span class="line">		S = Application.WorksheetFunction.Trim(rng.<span class="keyword">Text</span>)</span><br><span class="line">		N = <span class="number">0</span></span><br><span class="line">		<span class="keyword">If</span> S &lt;&gt; vbNullString <span class="keyword">Then</span></span><br><span class="line">			N = Len(S) - Len(Replace(S, <span class="string">&quot; &quot;</span>, <span class="string">&quot;&quot;</span>)) + <span class="number">1</span></span><br><span class="line">		<span class="keyword">End</span> <span class="keyword">If</span></span><br><span class="line">		WordCnt = WordCnt + N</span><br><span class="line">	<span class="keyword">Next</span> rng</span><br><span class="line">	MsgBox <span class="string">&quot;There are total &quot;</span> _</span><br><span class="line">	&amp; Format(WordCnt, <span class="string">&quot;#,##0&quot;</span>) &amp; _</span><br><span class="line">	<span class="string">&quot; words in the active worksheet&quot;</span></span><br><span class="line"><span class="keyword">End</span> <span class="keyword">Sub</span></span><br></pre></td></tr></table></figure>
<p>它可以帮助您计算工作表中的所有单词。</p>
<p>​</p>
<h4 id="90-从数字中删除撇号"><a href="#90-从数字中删除撇号" class="headerlink" title="90. 从数字中删除撇号"></a>90. 从数字中删除撇号</h4><figure class="highlight mathematica"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">Sub</span> <span class="variable">removeApostrophes</span><span class="punctuation">(</span><span class="punctuation">)</span></span><br><span class="line">	<span class="built_in">Selection</span><span class="operator">.</span><span class="built_in">Value</span> <span class="operator">=</span> <span class="built_in">Selection</span><span class="operator">.</span><span class="built_in">Value</span></span><br><span class="line"><span class="built_in">End</span> <span class="variable">Sub</span></span><br></pre></td></tr></table></figure>
<p>如果您有数字数据，其中每个数字前都有一个撇号，则运行此代码将其删除。</p>
<h4 id="91-从数字中删除小数"><a href="#91-从数字中删除小数" class="headerlink" title="91.从数字中删除小数"></a>91.从数字中删除小数</h4><figure class="highlight vbnet"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">Sub</span> removeDecimals()</span><br><span class="line">	<span class="keyword">Dim</span> lnumber <span class="keyword">As</span> <span class="type">Double</span></span><br><span class="line">	<span class="keyword">Dim</span> lResult <span class="keyword">As</span> <span class="type">Long</span></span><br><span class="line">	<span class="keyword">Dim</span> rng <span class="keyword">As</span> Range</span><br><span class="line">	<span class="keyword">For</span> <span class="keyword">Each</span> rng <span class="keyword">In</span> Selection</span><br><span class="line">		rng.Value = Int(rng)</span><br><span class="line">		rng.NumberFormat = <span class="string">&quot;0&quot;</span></span><br><span class="line">	<span class="keyword">Next</span> rng</span><br><span class="line"><span class="keyword">End</span> <span class="keyword">Sub</span></span><br></pre></td></tr></table></figure>
<p>此代码将仅帮助您从所选范围的数字中删除所有小数。</p>
<h4 id="92-将所有值乘以一个数字"><a href="#92-将所有值乘以一个数字" class="headerlink" title="92. 将所有值乘以一个数字"></a>92. 将所有值乘以一个数字</h4><figure class="highlight vbnet"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">Sub</span> addNumber()</span><br><span class="line">	<span class="keyword">Dim</span> rng <span class="keyword">As</span> Range</span><br><span class="line">	<span class="keyword">Dim</span> i <span class="keyword">As</span> <span class="type">Integer</span></span><br><span class="line">	i = InputBox(<span class="string">&quot;Enter number to multiple&quot;</span>, <span class="string">&quot;Input Required&quot;</span>)</span><br><span class="line">	<span class="keyword">For</span> <span class="keyword">Each</span> rng <span class="keyword">In</span> Selection</span><br><span class="line">		<span class="keyword">If</span> WorksheetFunction.IsNumber(rng) <span class="keyword">Then</span></span><br><span class="line">			rng.Value = rng + i</span><br><span class="line">			<span class="keyword">Else</span></span><br><span class="line">		<span class="keyword">End</span> <span class="keyword">If</span></span><br><span class="line">	<span class="keyword">Next</span> rng</span><br><span class="line"><span class="keyword">End</span> <span class="keyword">Sub</span> <span class="comment">&#x27;Translate By Tmtony</span></span><br></pre></td></tr></table></figure>

<p>让我们有一个数字列表，并且您希望将所有数字与特定数字相乘。若要使用此代码：选择该单元格区域并运行此代码。它将首先询问您要与之相乘的数字，然后立即将其与之相乘。</p>
<h4 id="93-在所有数字中添加一个数字"><a href="#93-在所有数字中添加一个数字" class="headerlink" title="93.在所有数字中添加一个数字"></a>93.在所有数字中添加一个数字</h4><figure class="highlight vbnet"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">Sub</span> addNumber()</span><br><span class="line">	<span class="keyword">Dim</span> rng <span class="keyword">As</span> Range</span><br><span class="line">	<span class="keyword">Dim</span> i <span class="keyword">As</span> <span class="type">Integer</span></span><br><span class="line">	i = InputBox(<span class="string">&quot;Enter number to multiple&quot;</span>, <span class="string">&quot;Input Required&quot;</span>)</span><br><span class="line">	<span class="keyword">For</span> <span class="keyword">Each</span> rng <span class="keyword">In</span> Selection</span><br><span class="line">		<span class="keyword">If</span> WorksheetFunction.IsNumber(rng) <span class="keyword">Then</span></span><br><span class="line">			rng.Value = rng + i</span><br><span class="line">			<span class="keyword">Else</span></span><br><span class="line">		<span class="keyword">End</span> <span class="keyword">If</span></span><br><span class="line">	<span class="keyword">Next</span> rng</span><br><span class="line"><span class="keyword">End</span> <span class="keyword">Sub</span></span><br></pre></td></tr></table></figure>
<p>就像乘法一样，您也可以将一个数字加到一组数字中。</p>
<h4 id="94-计算平方根"><a href="#94-计算平方根" class="headerlink" title="94. 计算平方根"></a>94. 计算平方根</h4><figure class="highlight vbnet"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">Sub</span> getSquareRoot()</span><br><span class="line">	<span class="keyword">Dim</span> rng <span class="keyword">As</span> Range</span><br><span class="line">	<span class="keyword">Dim</span> i <span class="keyword">As</span> <span class="type">Integer</span></span><br><span class="line">	<span class="keyword">For</span> <span class="keyword">Each</span> rng <span class="keyword">In</span> Selection</span><br><span class="line">		<span class="keyword">If</span> WorksheetFunction.IsNumber(rng) <span class="keyword">Then</span></span><br><span class="line">			rng.Value = Sqr(rng)</span><br><span class="line">			<span class="keyword">Else</span></span><br><span class="line">		<span class="keyword">End</span> <span class="keyword">If</span></span><br><span class="line">	<span class="keyword">Next</span> rng</span><br><span class="line"><span class="keyword">End</span> <span class="keyword">Sub</span></span><br></pre></td></tr></table></figure>
<p>若要在不应用公式的情况下计算平方根，可以使用此代码。它只需检查所有选定的单元格并将数字转换为其平方根即可。</p>
<h4 id="95-计算立方根"><a href="#95-计算立方根" class="headerlink" title="95.计算立方根"></a>95.计算立方根</h4><figure class="highlight mathematica"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">Sub</span> <span class="variable">getCubeRoot</span><span class="punctuation">(</span><span class="punctuation">)</span></span><br><span class="line">	<span class="variable">Dim</span> <span class="variable">rng</span> <span class="variable">As</span> <span class="built_in">Range</span></span><br><span class="line">	<span class="variable">Dimi</span> <span class="variable">As</span> <span class="built_in">Integer</span></span><br><span class="line">	<span class="built_in">For</span> <span class="variable">Each</span> <span class="variable">rng</span> <span class="built_in">In</span> <span class="built_in">Selection</span></span><br><span class="line">		<span class="built_in">If</span> <span class="variable">WorksheetFunction</span><span class="operator">.</span><span class="variable">IsNumber</span><span class="punctuation">(</span><span class="variable">rng</span><span class="punctuation">)</span> <span class="variable">Then</span></span><br><span class="line">			<span class="variable">rng</span><span class="operator">.</span><span class="built_in">Value</span> <span class="operator">=</span> <span class="variable">rng</span> <span class="operator">^</span> <span class="punctuation">(</span><span class="number">1</span> <span class="operator">/</span> <span class="number">3</span><span class="punctuation">)</span></span><br><span class="line">			<span class="variable">Else</span></span><br><span class="line">		<span class="built_in">End</span> <span class="built_in">If</span></span><br><span class="line">	<span class="variable">Nextrng</span></span><br><span class="line"><span class="built_in">End</span> <span class="variable">Sub</span></span><br></pre></td></tr></table></figure>
<p>若要在不应用公式的情况下计算多维数据集根目录，可以使用此代码。它只需检查所有选定的单元格并将数字转换为其多维数据集根。</p>
<h4 id="96-在区域中添加-A-Z-字母"><a href="#96-在区域中添加-A-Z-字母" class="headerlink" title="96. 在区域中添加 A-Z 字母"></a>96. 在区域中添加 A-Z 字母</h4><figure class="highlight vbnet"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">Sub</span> addsAlphabets1()</span><br><span class="line">	<span class="keyword">Dim</span> i <span class="keyword">As</span> <span class="type">Integer</span></span><br><span class="line">	<span class="keyword">For</span> i = <span class="number">65</span> <span class="keyword">To</span> <span class="number">90</span></span><br><span class="line">		ActiveCell.Value = Chr(i)</span><br><span class="line">		ActiveCell.Offset(<span class="number">1</span>, <span class="number">0</span>).<span class="keyword">Select</span></span><br><span class="line">	<span class="keyword">Next</span> i</span><br><span class="line"><span class="keyword">End</span> <span class="keyword">Sub</span></span><br></pre></td></tr></table></figure>
<p>子添加阿尔法贝茨2（） Dim i As Integer 对于 i &#x3D; 97 到 122 ActiveCell.Value &#x3D; Chr（i） ActiveCell.Offset（1， 0）.选择 下一个 i 就像序列号一样，您也可以在工作表中插入字母。以下是您可以使用的代码。</p>
<h4 id="97-将罗马数字转换为阿拉伯数字"><a href="#97-将罗马数字转换为阿拉伯数字" class="headerlink" title="97.将罗马数字转换为阿拉伯数字"></a>97.将罗马数字转换为阿拉伯数字</h4><figure class="highlight mathematica"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">Sub</span> <span class="variable">convertToNumbers</span><span class="punctuation">(</span><span class="punctuation">)</span></span><br><span class="line">	<span class="variable">Dim</span> <span class="variable">rng</span> <span class="variable">As</span> <span class="built_in">Range</span></span><br><span class="line">	<span class="built_in">Selection</span><span class="operator">.</span><span class="built_in">Value</span> <span class="operator">=</span> <span class="built_in">Selection</span><span class="operator">.</span><span class="built_in">Value</span></span><br><span class="line">	<span class="built_in">For</span> <span class="variable">Each</span> <span class="variable">rng</span> <span class="built_in">In</span> <span class="built_in">Selection</span></span><br><span class="line">		<span class="built_in">If</span> <span class="built_in">Not</span> <span class="variable">WorksheetFunction</span><span class="operator">.</span><span class="variable">IsNonText</span><span class="punctuation">(</span><span class="variable">rng</span><span class="punctuation">)</span> <span class="variable">Then</span></span><br><span class="line">			<span class="variable">rng</span><span class="operator">.</span><span class="built_in">Value</span> <span class="operator">=</span> <span class="variable">WorksheetFunction</span><span class="operator">.</span><span class="variable">Arabic</span><span class="punctuation">(</span><span class="variable">rng</span><span class="punctuation">)</span></span><br><span class="line">		<span class="built_in">End</span> <span class="built_in">If</span></span><br><span class="line">	<span class="built_in">Next</span> <span class="variable">rng</span></span><br><span class="line"><span class="built_in">End</span> <span class="variable">Sub</span> <span class="operator">&#x27;</span><span class="built_in">Translate</span> <span class="variable">By</span> <span class="variable">Tmtony</span></span><br></pre></td></tr></table></figure>

<p>有时很难将罗马数字理解为序列号。此代码将帮助您将罗马数字转换为阿拉伯数字。</p>
<h4 id="98-删除负号"><a href="#98-删除负号" class="headerlink" title="98.删除负号"></a>98.删除负号</h4><figure class="highlight mathematica"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">Sub</span> <span class="variable">removeNegativeSign</span><span class="punctuation">(</span><span class="punctuation">)</span></span><br><span class="line">	<span class="variable">Dim</span> <span class="variable">rng</span> <span class="variable">As</span> <span class="built_in">Range</span></span><br><span class="line">	<span class="built_in">Selection</span><span class="operator">.</span><span class="built_in">Value</span> <span class="operator">=</span> <span class="built_in">Selection</span><span class="operator">.</span><span class="built_in">Value</span></span><br><span class="line">	<span class="built_in">For</span> <span class="variable">Each</span> <span class="variable">rng</span> <span class="built_in">In</span> <span class="built_in">Selection</span></span><br><span class="line">		<span class="built_in">If</span> <span class="variable">WorksheetFunction</span><span class="operator">.</span><span class="variable">IsNumber</span><span class="punctuation">(</span><span class="variable">rng</span><span class="punctuation">)</span> <span class="variable">Then</span></span><br><span class="line">			<span class="variable">rng</span><span class="operator">.</span><span class="built_in">Value</span> <span class="operator">=</span> <span class="built_in">Abs</span><span class="punctuation">(</span><span class="variable">rng</span><span class="punctuation">)</span></span><br><span class="line">		<span class="built_in">End</span> <span class="built_in">If</span></span><br><span class="line">	<span class="built_in">Next</span> <span class="variable">rng</span></span><br><span class="line"><span class="built_in">End</span> <span class="variable">Sub</span></span><br></pre></td></tr></table></figure>
<p>此代码将简单地检查所选内容中的所有单元格，并将所有负数转换为正数。只需选择一个范围并运行此代码。</p>
<h4 id="99-用零替换空白单元格"><a href="#99-用零替换空白单元格" class="headerlink" title="99. 用零替换空白单元格"></a>99. 用零替换空白单元格</h4><figure class="highlight mathematica"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">Sub</span> <span class="variable">replaceBlankWithZero</span><span class="punctuation">(</span><span class="punctuation">)</span></span><br><span class="line">         <span class="variable">Dim</span> <span class="variable">rng</span> <span class="variable">As</span> <span class="built_in">Range</span></span><br><span class="line">         <span class="built_in">Selection</span><span class="operator">.</span><span class="built_in">Value</span> <span class="operator">=</span> <span class="built_in">Selection</span><span class="operator">.</span><span class="built_in">Value</span></span><br><span class="line">         <span class="built_in">For</span> <span class="variable">Each</span> <span class="variable">rng</span> <span class="built_in">In</span> <span class="built_in">Selection</span></span><br><span class="line">             <span class="built_in">If</span> <span class="variable">rng</span> <span class="operator">=</span> <span class="string">&quot;&quot;</span> <span class="built_in">Or</span> <span class="variable">rng</span> <span class="operator">=</span> <span class="string">&quot; &quot;</span> <span class="variable">Then</span></span><br><span class="line">                <span class="variable">rng</span><span class="operator">.</span><span class="built_in">Value</span> <span class="operator">=</span> <span class="string">&quot;0&quot;</span></span><br><span class="line">             <span class="variable">Else</span></span><br><span class="line">             <span class="built_in">End</span> <span class="built_in">If</span></span><br><span class="line">         <span class="built_in">Next</span> <span class="variable">rng</span></span><br><span class="line"><span class="built_in">End</span> <span class="variable">Sub</span></span><br></pre></td></tr></table></figure>
<p>对于具有空白单元格的数据，可以使用以下代码在所有这些单元格中添加零。这样可以更轻松地在进一步的计算中使用这些单元格。</p>
</article><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/VBA%E4%BB%A3%E7%A0%81/">VBA代码</a></div><div class="post_share"><div class="social-share" data-image="/img/4.jpg" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/js/social-share.min.js" defer></script></div></div><div class="post-reward"><div class="reward-button"><i class="fas fa-qrcode"></i> 打赏</div><div class="reward-main"><ul class="reward-all"><li class="reward-item"><a href="/img/wx.png" target="_blank"><img class="post-qr-code-img" src="/img/wx.png" alt="wechat"/></a><div class="post-qr-code-desc">wechat</div></li><li class="reward-item"><a href="/img/zfb.png" target="_blank"><img class="post-qr-code-img" src="/img/zfb.png" alt="alipay"/></a><div class="post-qr-code-desc">alipay</div></li></ul></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/2022/08/12/b7c683067d7c/"><img class="prev-cover" src="/img/4.jpg" onerror="onerror=null;src='/img/404.jpg'" alt="cover of previous post"><div class="pagination-info"><div class="label">上一篇</div><div class="prev_info">01_字符串方法_上</div></div></a></div><div class="next-post pull-right"><a href="/2022/08/08/a677850c2e08/"><img class="next-cover" src="/img/2.jpg" onerror="onerror=null;src='/img/404.jpg'" alt="cover of next post"><div class="pagination-info"><div class="label">下一篇</div><div class="next_info">作业</div></div></a></div></nav><div class="relatedPosts"><div class="headline"><i class="fas fa-thumbs-up fa-fw"></i><span>相关推荐</span></div><div class="relatedPosts-list"><div><a href="/2021/07/18/03166f570e62/" title="Excel VBA常用代码100句"><img class="cover" src="/img/3.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2021-07-18</div><div class="title">Excel VBA常用代码100句</div></div></a></div></div></div><hr/><div id="post-comment"><div class="comment-head"><div class="comment-headline"><i class="fas fa-comments fa-fw"></i><span> 评论</span></div></div><div class="comment-wrap"><div><div id="waline-wrap"></div></div></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="is-center"><div class="avatar-img"><img src="/img/logo.png" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info__name">欧阳</div><div class="author-info__description">成本管理、RPA</div></div><div class="card-info-data site-data is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">93</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">40</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">11</div></a></div><div class="card-info-social-icons is-center"><a class="social-icon" href="/./atom.xml" target="_blank" title="订阅"><i class="fas fa-atom"></i></a><a class="social-icon" href="/./sitemap.xml" target="_blank" title="地图"><i class="fas fa-sitemap"></i></a></div></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn fa-shake"></i><span>公告</span></div><div class="announcement_content">博客换模板、换域名vvvvvv.top</div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>目录</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-4"><a class="toc-link" href="#1-%E6%B7%BB%E5%8A%A0%E5%BA%8F%E5%88%97%E5%8F%B7"><span class="toc-number">1.</span> <span class="toc-text">1. 添加序列号</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-%E6%8F%92%E5%85%A5%E5%A4%9A%E5%88%97"><span class="toc-number">2.</span> <span class="toc-text">2. 插入多列</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3-%E6%8F%92%E5%85%A5%E5%A4%9A%E8%A1%8C"><span class="toc-number">3.</span> <span class="toc-text">3. 插入多行</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#4-%E8%87%AA%E5%8A%A8%E8%B0%83%E6%95%B4%E5%88%97"><span class="toc-number">4.</span> <span class="toc-text">4. 自动调整列</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#5-%E8%87%AA%E5%8A%A8%E8%B0%83%E6%95%B4%E8%A1%8C"><span class="toc-number">5.</span> <span class="toc-text">5. 自动调整行</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#6-%E5%88%A0%E9%99%A4%E6%96%87%E5%AD%97%E7%BB%95%E6%8E%92"><span class="toc-number">6.</span> <span class="toc-text">6. 删除文字绕排</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#7-%E5%8F%96%E6%B6%88%E5%90%88%E5%B9%B6%E5%8D%95%E5%85%83%E6%A0%BC"><span class="toc-number">7.</span> <span class="toc-text">7. 取消合并单元格</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#8-%E6%89%93%E5%BC%80%E8%AE%A1%E7%AE%97%E5%99%A8"><span class="toc-number">8.</span> <span class="toc-text">8. 打开计算器</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#9-%E6%B7%BB%E5%8A%A0%E9%A1%B5%E7%9C%89-x2F-%E9%A1%B5%E8%84%9A%E6%97%A5%E6%9C%9F"><span class="toc-number">9.</span> <span class="toc-text">9. 添加页眉&#x2F;页脚日期</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#10-%E8%87%AA%E5%AE%9A%E4%B9%89%E9%A1%B5%E7%9C%89-x2F-%E9%A1%B5%E8%84%9A"><span class="toc-number">10.</span> <span class="toc-text">10. 自定义页眉&#x2F;页脚</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#11-%E4%BB%8E%E9%80%89%E6%8B%A9%E4%B8%AD%E7%AA%81%E5%87%BA%E6%98%BE%E7%A4%BA%E9%87%8D%E5%A4%8D%E9%A1%B9"><span class="toc-number">11.</span> <span class="toc-text">11. 从选择中突出显示重复项</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#12-%E7%AA%81%E5%87%BA%E6%98%BE%E7%A4%BA%E6%B4%BB%E5%8A%A8%E8%A1%8C%E5%92%8C%E5%88%97"><span class="toc-number">12.</span> <span class="toc-text">12. 突出显示活动行和列</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#13-%E7%AA%81%E5%87%BA%E6%98%BE%E7%A4%BA%E5%89%8D-10-%E4%B8%AA%E5%80%BC"><span class="toc-number">13.</span> <span class="toc-text">13. 突出显示前 10 个值</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#14-%E7%AA%81%E5%87%BA%E6%98%BE%E7%A4%BA%E5%91%BD%E5%90%8D%E8%8C%83%E5%9B%B4"><span class="toc-number">14.</span> <span class="toc-text">14. 突出显示命名范围</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#15-%E7%AA%81%E5%87%BA%E6%98%BE%E7%A4%BA%E5%A4%A7%E4%BA%8E%E5%80%BC"><span class="toc-number">15.</span> <span class="toc-text">15. 突出显示大于值</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#16-%E7%AA%81%E5%87%BA%E6%98%BE%E7%A4%BA%E4%BD%8E%E4%BA%8E%E4%BB%A5%E4%B8%8B%E5%80%BC%E7%9A%84%E5%80%BC"><span class="toc-number">16.</span> <span class="toc-text">16. 突出显示低于以下值的值</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#17-%E7%AA%81%E5%87%BA%E6%98%BE%E7%A4%BA%E8%B4%9F%E6%95%B0"><span class="toc-number">17.</span> <span class="toc-text">17. 突出显示负数</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#18-%E7%AA%81%E5%87%BA%E6%98%BE%E7%A4%BA%E7%89%B9%E5%AE%9A%E6%96%87%E6%9C%AC"><span class="toc-number">18.</span> <span class="toc-text">18. 突出显示特定文本</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#19-%E7%AA%81%E5%87%BA%E6%98%BE%E7%A4%BA%E5%B8%A6%E6%9C%89%E6%B3%A8%E9%87%8A%E7%9A%84%E5%8D%95%E5%85%83%E6%A0%BC"><span class="toc-number">19.</span> <span class="toc-text">19. 突出显示带有注释的单元格</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#20-%E5%9C%A8%E6%89%80%E9%80%89%E5%86%85%E5%AE%B9%E4%B8%AD%E7%AA%81%E5%87%BA%E6%98%BE%E7%A4%BA%E6%9B%BF%E6%8D%A2%E8%A1%8C"><span class="toc-number">20.</span> <span class="toc-text">20. 在所选内容中突出显示替换行</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#21-%E7%AA%81%E5%87%BA%E6%98%BE%E7%A4%BA%E5%8D%95%E8%AF%8D%E6%8B%BC%E5%86%99%E9%94%99%E8%AF%AF%E7%9A%84%E5%8D%95%E5%85%83%E6%A0%BC"><span class="toc-number">21.</span> <span class="toc-text">21. 突出显示单词拼写错误的单元格</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#22-%E7%AA%81%E5%87%BA%E6%98%BE%E7%A4%BA%E6%95%B4%E4%B8%AA%E5%B7%A5%E4%BD%9C%E8%A1%A8%E4%B8%AD%E5%87%BA%E9%94%99%E7%9A%84%E5%8D%95%E5%85%83%E6%A0%BC"><span class="toc-number">22.</span> <span class="toc-text">22.突出显示整个工作表中出错的单元格</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#23-%E7%AA%81%E5%87%BA%E6%98%BE%E7%A4%BA%E5%B7%A5%E4%BD%9C%E8%A1%A8%E4%B8%AD%E5%85%B7%E6%9C%89%E7%89%B9%E5%AE%9A%E6%96%87%E6%9C%AC%E7%9A%84%E5%8D%95%E5%85%83%E6%A0%BC"><span class="toc-number">23.</span> <span class="toc-text">23.突出显示工作表中具有特定文本的单元格</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#24-%E7%AA%81%E5%87%BA%E6%98%BE%E7%A4%BA%E6%89%80%E6%9C%89%E7%A9%BA%E7%99%BD%E5%8D%95%E5%85%83%E6%A0%BC%E4%B8%8D%E5%8F%AF%E8%A7%81%E7%A9%BA%E9%97%B4"><span class="toc-number">24.</span> <span class="toc-text">24.突出显示所有空白单元格不可见空间</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#25-%E7%AA%81%E5%87%BA%E6%98%BE%E7%A4%BA%E8%8C%83%E5%9B%B4%E5%86%85%E7%9A%84%E6%9C%80%E5%A4%A7%E5%80%BC"><span class="toc-number">25.</span> <span class="toc-text">25. 突出显示范围内的最大值</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#26-%E7%AA%81%E5%87%BA%E6%98%BE%E7%A4%BA%E8%8C%83%E5%9B%B4%E5%86%85%E7%9A%84%E6%9C%80%E5%B0%8F%E5%80%BC"><span class="toc-number">26.</span> <span class="toc-text">26. 突出显示范围内的最小值</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#27-%E7%AA%81%E5%87%BA%E6%98%BE%E7%A4%BA%E5%94%AF%E4%B8%80%E5%80%BC"><span class="toc-number">27.</span> <span class="toc-text">27. 突出显示唯一值</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#28-%E7%AA%81%E5%87%BA%E6%98%BE%E7%A4%BA%E5%88%97%E4%B8%AD%E7%9A%84%E5%B7%AE%E5%BC%82"><span class="toc-number">28.</span> <span class="toc-text">28. 突出显示列中的差异</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#29-%E7%AA%81%E5%87%BA%E6%98%BE%E7%A4%BA%E8%A1%8C%E4%B8%AD%E7%9A%84%E5%B7%AE%E5%BC%82"><span class="toc-number">29.</span> <span class="toc-text">29. 突出显示行中的差异</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#30-%E6%89%93%E5%8D%B0%E6%B3%A8%E9%87%8A"><span class="toc-number">30.</span> <span class="toc-text">30. 打印注释</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#31-%E6%89%93%E5%8D%B0%E7%AA%84%E8%BE%B9%E8%B7%9D"><span class="toc-number">31.</span> <span class="toc-text">31. 打印窄边距</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#32-%E6%89%93%E5%8D%B0%E9%80%89%E6%8B%A9"><span class="toc-number">32.</span> <span class="toc-text">32. 打印选择</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#33-%E6%89%93%E5%8D%B0%E8%87%AA%E5%AE%9A%E4%B9%89%E9%A1%B5%E9%9D%A2"><span class="toc-number">33.</span> <span class="toc-text">33. 打印自定义页面</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#34-%E9%9A%90%E8%97%8F%E9%99%A4%E6%B4%BB%E5%8A%A8%E5%B7%A5%E4%BD%9C%E8%A1%A8%E4%B9%8B%E5%A4%96%E7%9A%84%E6%89%80%E6%9C%89%E5%B7%A5%E4%BD%9C%E8%A1%A8"><span class="toc-number">34.</span> <span class="toc-text">34. 隐藏除活动工作表之外的所有工作表</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#35-%E5%8F%96%E6%B6%88%E9%9A%90%E8%97%8F%E6%89%80%E6%9C%89%E9%9A%90%E8%97%8F%E7%9A%84%E5%B7%A5%E4%BD%9C%E8%A1%A8"><span class="toc-number">35.</span> <span class="toc-text">35. 取消隐藏所有隐藏的工作表</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#36-%E5%88%A0%E9%99%A4%E9%99%A4%E6%B4%BB%E5%8A%A8%E5%B7%A5%E4%BD%9C%E8%A1%A8%E4%B9%8B%E5%A4%96%E7%9A%84%E6%89%80%E6%9C%89%E5%B7%A5%E4%BD%9C%E8%A1%A8"><span class="toc-number">36.</span> <span class="toc-text">36. 删除除活动工作表之外的所有工作表</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#37-%E7%AB%8B%E5%8D%B3%E4%BF%9D%E6%8A%A4%E6%89%80%E6%9C%89%E5%B7%A5%E4%BD%9C%E8%A1%A8"><span class="toc-number">37.</span> <span class="toc-text">37.立即保护所有工作表</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#38-%E8%B0%83%E6%95%B4%E5%B7%A5%E4%BD%9C%E8%A1%A8%E4%B8%AD%E6%89%80%E6%9C%89%E5%9B%BE%E8%A1%A8%E7%9A%84%E5%A4%A7%E5%B0%8F"><span class="toc-number">38.</span> <span class="toc-text">38. 调整工作表中所有图表的大小</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#39-%E6%8F%92%E5%85%A5%E5%A4%9A%E4%B8%AA%E5%B7%A5%E4%BD%9C%E8%A1%A8"><span class="toc-number">39.</span> <span class="toc-text">39. 插入多个工作表</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#40-%E4%BF%9D%E6%8A%A4%E5%B7%A5%E4%BD%9C%E8%A1%A8"><span class="toc-number">40.</span> <span class="toc-text">40. 保护工作表</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#41-%E5%8F%96%E6%B6%88%E4%BF%9D%E6%8A%A4%E5%B7%A5%E4%BD%9C%E8%A1%A8"><span class="toc-number">41.</span> <span class="toc-text">41. 取消保护工作表</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#42-%E5%AF%B9%E5%B7%A5%E4%BD%9C%E8%A1%A8%E8%BF%9B%E8%A1%8C%E6%8E%92%E5%BA%8F"><span class="toc-number">42.</span> <span class="toc-text">42. 对工作表进行排序</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#43-%E7%94%A8%E5%85%AC%E5%BC%8F%E4%BF%9D%E6%8A%A4%E6%89%80%E6%9C%89%E5%8D%95%E5%85%83%E6%A0%BC"><span class="toc-number">43.</span> <span class="toc-text">43.用公式保护所有单元格</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#44-%E5%88%A0%E9%99%A4%E6%89%80%E6%9C%89%E7%A9%BA%E7%99%BD%E5%B7%A5%E4%BD%9C%E8%A1%A8"><span class="toc-number">44.</span> <span class="toc-text">44. 删除所有空白工作表</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#45-%E5%8F%96%E6%B6%88%E9%9A%90%E8%97%8F%E6%89%80%E6%9C%89%E8%A1%8C%E5%92%8C%E5%88%97"><span class="toc-number">45.</span> <span class="toc-text">45. 取消隐藏所有行和列</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#46-%E5%B0%86%E6%AF%8F%E4%B8%AA%E5%B7%A5%E4%BD%9C%E8%A1%A8%E5%8F%A6%E5%AD%98%E4%B8%BA%E5%8D%95%E4%B8%AA-PDF"><span class="toc-number">46.</span> <span class="toc-text">46. 将每个工作表另存为单个 PDF</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#47-%E7%A6%81%E7%94%A8%E5%88%86%E9%A1%B5%E7%AC%A6"><span class="toc-number">47.</span> <span class="toc-text">47. 禁用分页符</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#48-%E5%88%9B%E5%BB%BA%E5%BD%93%E5%89%8D%E5%B7%A5%E4%BD%9C%E7%B0%BF%E7%9A%84%E5%A4%87%E4%BB%BD"><span class="toc-number">48.</span> <span class="toc-text">48. 创建当前工作簿的备份</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#49-%E4%B8%80%E6%AC%A1%E5%85%B3%E9%97%AD%E6%89%80%E6%9C%89%E5%B7%A5%E4%BD%9C%E7%B0%BF"><span class="toc-number">49.</span> <span class="toc-text">49. 一次关闭所有工作簿</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#50-%E5%B0%86%E6%B4%BB%E5%8A%A8%E5%B7%A5%E4%BD%9C%E8%A1%A8%E5%A4%8D%E5%88%B6%E5%88%B0%E6%96%B0%E5%B7%A5%E4%BD%9C%E7%B0%BF%E4%B8%AD"><span class="toc-number">50.</span> <span class="toc-text">50. 将活动工作表复制到新工作簿中</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#51-%E7%94%B5%E5%AD%90%E9%82%AE%E4%BB%B6%E4%B8%AD%E7%9A%84%E6%B4%BB%E5%8A%A8%E5%B7%A5%E4%BD%9C%E7%B0%BF"><span class="toc-number">51.</span> <span class="toc-text">51. 电子邮件中的活动工作簿</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#52-%E5%B0%86%E5%B7%A5%E4%BD%9C%E7%B0%BF%E6%B7%BB%E5%8A%A0%E5%88%B0%E9%82%AE%E4%BB%B6%E9%99%84%E4%BB%B6"><span class="toc-number">52.</span> <span class="toc-text">52. 将工作簿添加到邮件附件</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#53-%E6%AC%A2%E8%BF%8E%E8%BE%9E"><span class="toc-number">53.</span> <span class="toc-text">53. 欢迎辞</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#54-%E7%BB%93%E6%9D%9F%E8%AF%AD"><span class="toc-number">54.</span> <span class="toc-text">54. 结束语</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#55-%E5%AF%B9%E6%89%93%E5%BC%80%E7%9A%84%E6%9C%AA%E4%BF%9D%E5%AD%98%E5%B7%A5%E4%BD%9C%E7%B0%BF%E8%BF%9B%E8%A1%8C%E8%AE%A1%E6%95%B0"><span class="toc-number">55.</span> <span class="toc-text">55. 对打开的未保存工作簿进行计数</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#56-%E9%9A%90%E8%97%8F%E6%95%B0%E6%8D%AE%E9%80%8F%E8%A7%86%E8%A1%A8%E5%B0%8F%E8%AE%A1"><span class="toc-number">56.</span> <span class="toc-text">56. 隐藏数据透视表小计</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#57-%E5%88%B7%E6%96%B0%E6%89%80%E6%9C%89%E6%95%B0%E6%8D%AE%E9%80%8F%E8%A7%86%E8%A1%A8"><span class="toc-number">57.</span> <span class="toc-text">57. 刷新所有数据透视表</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#58-%E5%88%9B%E5%BB%BA%E6%95%B0%E6%8D%AE%E9%80%8F%E8%A7%86%E8%A1%A8"><span class="toc-number">58.</span> <span class="toc-text">58. 创建数据透视表</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#59-%E8%87%AA%E5%8A%A8%E6%9B%B4%E6%96%B0%E6%95%B0%E6%8D%AE%E9%80%8F%E8%A7%86%E8%A1%A8%E8%8C%83%E5%9B%B4"><span class="toc-number">59.</span> <span class="toc-text">59. 自动更新数据透视表范围</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#60-%E7%A6%81%E7%94%A8-x2F-%E5%90%AF%E7%94%A8%E8%8E%B7%E5%8F%96%E9%80%8F%E8%A7%86%E6%95%B0%E6%8D%AE"><span class="toc-number">60.</span> <span class="toc-text">60. 禁用&#x2F;启用获取透视数据</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#61-%E6%9B%B4%E6%94%B9%E5%9B%BE%E8%A1%A8%E7%B1%BB%E5%9E%8B"><span class="toc-number">61.</span> <span class="toc-text">61. 更改图表类型</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#62-%E5%B0%86%E5%9B%BE%E8%A1%A8%E7%B2%98%E8%B4%B4%E4%B8%BA%E5%9B%BE%E5%83%8F"><span class="toc-number">62.</span> <span class="toc-text">62. 将图表粘贴为图像</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#63-%E6%B7%BB%E5%8A%A0%E5%9B%BE%E8%A1%A8%E6%A0%87%E9%A2%98"><span class="toc-number">63.</span> <span class="toc-text">63. 添加图表标题</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#64-%E5%B0%86%E6%89%80%E9%80%89%E8%8C%83%E5%9B%B4%E5%8F%A6%E5%AD%98%E4%B8%BA-PDF"><span class="toc-number">64.</span> <span class="toc-text">64. 将所选范围另存为 PDF</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#65-%E5%88%9B%E5%BB%BA%E7%9B%AE%E5%BD%95"><span class="toc-number">65.</span> <span class="toc-text">65. 创建目录</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#66-%E5%B0%86%E8%8C%83%E5%9B%B4%E8%BD%AC%E6%8D%A2%E4%B8%BA%E5%9B%BE%E5%83%8F"><span class="toc-number">66.</span> <span class="toc-text">66.将范围转换为图像</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#67-%E6%8F%92%E5%85%A5%E9%93%BE%E6%8E%A5%E7%9A%84%E5%9B%BE%E7%89%87"><span class="toc-number">67.</span> <span class="toc-text">67. 插入链接的图片</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#68-%E4%BD%BF%E7%94%A8%E6%96%87%E6%9C%AC%E5%88%B0%E8%AF%AD%E9%9F%B3%E8%BD%AC%E6%8D%A2"><span class="toc-number">68.</span> <span class="toc-text">68. 使用文本到语音转换</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#69-%E6%BF%80%E6%B4%BB%E6%95%B0%E6%8D%AE%E8%BE%93%E5%85%A5%E8%A1%A8%E5%8D%95"><span class="toc-number">69.</span> <span class="toc-text">69. 激活数据输入表单</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#70-%E4%BD%BF%E7%94%A8%E7%9B%AE%E6%A0%87%E6%90%9C%E7%B4%A2"><span class="toc-number">70.</span> <span class="toc-text">70.使用目标搜索</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#71-%E5%9C%A8%E8%B0%B7%E6%AD%8C%E4%B8%8A%E6%90%9C%E7%B4%A2%E7%9A%84VBA%E4%BB%A3%E7%A0%81"><span class="toc-number">71.</span> <span class="toc-text">71.在谷歌上搜索的VBA代码</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#72-%E5%B0%86%E6%89%80%E6%9C%89%E5%85%AC%E5%BC%8F%E8%BD%AC%E6%8D%A2%E4%B8%BA%E5%80%BC"><span class="toc-number">72.</span> <span class="toc-text">72. 将所有公式转换为值</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#73-%E4%BB%8E%E6%89%80%E9%80%89%E5%8D%95%E5%85%83%E6%A0%BC%E4%B8%AD%E5%88%A0%E9%99%A4%E7%A9%BA%E6%A0%BC"><span class="toc-number">73.</span> <span class="toc-text">73.从所选单元格中删除空格</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#74-%E4%BB%8E%E5%AD%97%E7%AC%A6%E4%B8%B2%E4%B8%AD%E5%88%A0%E9%99%A4%E5%AD%97%E7%AC%A6"><span class="toc-number">74.</span> <span class="toc-text">74. 从字符串中删除字符</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#75-%E5%9C%A8-Excel-%E4%B8%AD%E6%B7%BB%E5%8A%A0%E6%8F%92%E5%85%A5%E5%BA%A6%E6%95%B0%E7%AC%A6%E5%8F%B7"><span class="toc-number">75.</span> <span class="toc-text">75. 在 Excel 中添加插入度数符号</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#76-%E5%8F%8D%E8%BD%AC%E6%96%87%E6%9C%AC"><span class="toc-number">76.</span> <span class="toc-text">76. 反转文本</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#77-%E6%BF%80%E6%B4%BB-R1C1-%E5%8F%82%E8%80%83%E6%A0%B7%E5%BC%8F"><span class="toc-number">77.</span> <span class="toc-text">77. 激活 R1C1 参考样式</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#78-%E6%BF%80%E6%B4%BB-A1-%E5%8F%82%E8%80%83%E6%A0%B7%E5%BC%8F"><span class="toc-number">78.</span> <span class="toc-text">78. 激活 A1 参考样式</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#79-%E6%8F%92%E5%85%A5%E6%97%B6%E9%97%B4%E8%8C%83%E5%9B%B4"><span class="toc-number">79.</span> <span class="toc-text">79. 插入时间范围</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#80-%E5%B0%86%E6%97%A5%E6%9C%9F%E8%BD%AC%E6%8D%A2%E4%B8%BA%E5%A4%A9"><span class="toc-number">80.</span> <span class="toc-text">80. 将日期转换为天</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#81-%E5%B0%86%E6%97%A5%E6%9C%9F%E8%BD%AC%E6%8D%A2%E4%B8%BA%E5%B9%B4%E4%BB%BD"><span class="toc-number">81.</span> <span class="toc-text">81. 将日期转换为年份</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#82-%E4%BB%8E%E6%97%A5%E6%9C%9F%E4%B8%AD%E5%88%A0%E9%99%A4%E6%97%B6%E9%97%B4"><span class="toc-number">82.</span> <span class="toc-text">82.从日期中删除时间</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#83-%E4%BB%8E%E6%97%A5%E6%9C%9F%E5%92%8C%E6%97%B6%E9%97%B4%E4%B8%AD%E5%88%A0%E9%99%A4%E6%97%A5%E6%9C%9F"><span class="toc-number">83.</span> <span class="toc-text">83.从日期和时间中删除日期</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#84-%E8%BD%AC%E6%8D%A2%E4%B8%BA%E5%A4%A7%E5%86%99"><span class="toc-number">84.</span> <span class="toc-text">84. 转换为大写</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#85-%E8%BD%AC%E6%8D%A2%E4%B8%BA%E5%B0%8F%E5%86%99"><span class="toc-number">85.</span> <span class="toc-text">85. 转换为小写</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#86-%E8%BD%AC%E6%8D%A2%E4%B8%BA%E6%AD%A3%E7%A1%AE%E7%9A%84%E5%A4%A7%E5%B0%8F%E5%86%99"><span class="toc-number">86.</span> <span class="toc-text">86.转换为正确的大小写</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#87-%E8%BD%AC%E6%8D%A2%E4%B8%BA%E5%8F%A5%E5%AD%90%E5%A4%A7%E5%B0%8F%E5%86%99"><span class="toc-number">87.</span> <span class="toc-text">87. 转换为句子大小写</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#88-%E4%BB%8E%E9%80%89%E5%8C%BA%E4%B8%AD%E5%88%A0%E9%99%A4%E5%AD%97%E7%AC%A6"><span class="toc-number">88.</span> <span class="toc-text">88. 从选区中删除字符</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#89-%E6%95%B4%E4%B8%AA%E5%B7%A5%E4%BD%9C%E8%A1%A8%E7%9A%84%E5%AD%97%E6%95%B0%E7%BB%9F%E8%AE%A1"><span class="toc-number">89.</span> <span class="toc-text">89. 整个工作表的字数统计</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#90-%E4%BB%8E%E6%95%B0%E5%AD%97%E4%B8%AD%E5%88%A0%E9%99%A4%E6%92%87%E5%8F%B7"><span class="toc-number">90.</span> <span class="toc-text">90. 从数字中删除撇号</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#91-%E4%BB%8E%E6%95%B0%E5%AD%97%E4%B8%AD%E5%88%A0%E9%99%A4%E5%B0%8F%E6%95%B0"><span class="toc-number">91.</span> <span class="toc-text">91.从数字中删除小数</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#92-%E5%B0%86%E6%89%80%E6%9C%89%E5%80%BC%E4%B9%98%E4%BB%A5%E4%B8%80%E4%B8%AA%E6%95%B0%E5%AD%97"><span class="toc-number">92.</span> <span class="toc-text">92. 将所有值乘以一个数字</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#93-%E5%9C%A8%E6%89%80%E6%9C%89%E6%95%B0%E5%AD%97%E4%B8%AD%E6%B7%BB%E5%8A%A0%E4%B8%80%E4%B8%AA%E6%95%B0%E5%AD%97"><span class="toc-number">93.</span> <span class="toc-text">93.在所有数字中添加一个数字</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#94-%E8%AE%A1%E7%AE%97%E5%B9%B3%E6%96%B9%E6%A0%B9"><span class="toc-number">94.</span> <span class="toc-text">94. 计算平方根</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#95-%E8%AE%A1%E7%AE%97%E7%AB%8B%E6%96%B9%E6%A0%B9"><span class="toc-number">95.</span> <span class="toc-text">95.计算立方根</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#96-%E5%9C%A8%E5%8C%BA%E5%9F%9F%E4%B8%AD%E6%B7%BB%E5%8A%A0-A-Z-%E5%AD%97%E6%AF%8D"><span class="toc-number">96.</span> <span class="toc-text">96. 在区域中添加 A-Z 字母</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#97-%E5%B0%86%E7%BD%97%E9%A9%AC%E6%95%B0%E5%AD%97%E8%BD%AC%E6%8D%A2%E4%B8%BA%E9%98%BF%E6%8B%89%E4%BC%AF%E6%95%B0%E5%AD%97"><span class="toc-number">97.</span> <span class="toc-text">97.将罗马数字转换为阿拉伯数字</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#98-%E5%88%A0%E9%99%A4%E8%B4%9F%E5%8F%B7"><span class="toc-number">98.</span> <span class="toc-text">98.删除负号</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#99-%E7%94%A8%E9%9B%B6%E6%9B%BF%E6%8D%A2%E7%A9%BA%E7%99%BD%E5%8D%95%E5%85%83%E6%A0%BC"><span class="toc-number">99.</span> <span class="toc-text">99. 用零替换空白单元格</span></a></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>最新文章</span></div><div class="aside-list"><div class="aside-list-item"><a class="thumbnail" href="/2022/08/12/6a39224360df/" title="C# 输出"><img src="/img/4.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="C# 输出"/></a><div class="content"><a class="title" href="/2022/08/12/6a39224360df/" title="C# 输出">C# 输出</a><time datetime="2022-08-12T12:52:26.000Z" title="发表于 2022-08-12 20:52:26">2022-08-12</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2022/08/12/cd11908066fa/" title=".NET、C#和ASP.NET三者之间的区别"><img src="/img/4.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt=".NET、C#和ASP.NET三者之间的区别"/></a><div class="content"><a class="title" href="/2022/08/12/cd11908066fa/" title=".NET、C#和ASP.NET三者之间的区别">.NET、C#和ASP.NET三者之间的区别</a><time datetime="2022-08-12T12:49:46.000Z" title="发表于 2022-08-12 20:49:46">2022-08-12</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2022/08/12/556d4f9abf2a/" title="VSTO"><img src="/img/1.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="VSTO"/></a><div class="content"><a class="title" href="/2022/08/12/556d4f9abf2a/" title="VSTO">VSTO</a><time datetime="2022-08-12T12:46:56.000Z" title="发表于 2022-08-12 20:46:56">2022-08-12</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2022/08/12/c6027af475e8/" title="Day06作业"><img src="/img/3.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Day06作业"/></a><div class="content"><a class="title" href="/2022/08/12/c6027af475e8/" title="Day06作业">Day06作业</a><time datetime="2022-08-12T12:22:30.000Z" title="发表于 2022-08-12 20:22:30">2022-08-12</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2022/08/12/0ca86b8c7451/" title="03_练习-歌词解析器"><img src="/img/1.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="03_练习-歌词解析器"/></a><div class="content"><a class="title" href="/2022/08/12/0ca86b8c7451/" title="03_练习-歌词解析器">03_练习-歌词解析器</a><time datetime="2022-08-12T12:21:57.000Z" title="发表于 2022-08-12 20:21:57">2022-08-12</time></div></div></div></div></div></div></main><footer id="footer"><div id="footer-wrap"><div class="copyright">&copy;2012 - 2022 By 欧阳</div><div class="framework-info"><span>框架 </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>主题 </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="fas fa-book-open"></i></button><button id="translateLink" type="button" title="简繁转换">简</button><button id="darkmode" type="button" title="浅色和深色模式转换"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside_config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="fas fa-list-ul"></i></button><a id="to_comment" href="#post-comment" title="直达评论"><i class="fas fa-comments"></i></a><button id="go-up" type="button" title="回到顶部"><i class="fas fa-arrow-up"></i></button></div></div><div id="local-search"><div class="search-dialog"><nav class="search-nav"><span class="search-dialog-title">搜索</span><span id="loading-status"></span><button class="search-close-button"><i class="fas fa-times"></i></button></nav><div class="is-center" id="loading-database"><i class="fas fa-spinner fa-pulse"></i><span>  数据库加载中</span></div><div class="search-wrap"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="搜索文章" type="text"/></div></div><hr/><div id="local-search-results"></div></div></div><div id="search-mask"></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="/js/tw_cn.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox.umd.min.js"></script><script src="/js/search/local-search.js"></script><script>var preloader = {
  endLoading: () => {
    document.body.style.overflow = 'auto';
    document.getElementById('loading-box').classList.add("loaded")
  },
  initLoading: () => {
    document.body.style.overflow = '';
    document.getElementById('loading-box').classList.remove("loaded")

  }
}
window.addEventListener('load',preloader.endLoading())</script><div class="js-pjax"><script>(() => {
  const $mermaidWrap = document.querySelectorAll('#article-container .mermaid-wrap')
  if ($mermaidWrap.length) {
    window.runMermaid = () => {
      window.loadMermaid = true
      const theme = document.documentElement.getAttribute('data-theme') === 'dark' ? 'dark' : 'default'

      Array.from($mermaidWrap).forEach((item, index) => {
        const mermaidSrc = item.firstElementChild
        const mermaidThemeConfig = '%%{init:{ \'theme\':\'' + theme + '\'}}%%\n'
        const mermaidID = 'mermaid-' + index
        const mermaidDefinition = mermaidThemeConfig + mermaidSrc.textContent
        mermaid.mermaidAPI.render(mermaidID, mermaidDefinition, (svgCode) => {
          mermaidSrc.insertAdjacentHTML('afterend', svgCode)
        })
      })
    }

    const loadMermaid = () => {
      window.loadMermaid ? runMermaid() : getScript('https://cdn.jsdelivr.net/npm/mermaid/dist/mermaid.min.js').then(runMermaid)
    }

    window.pjax ? loadMermaid() : document.addEventListener('DOMContentLoaded', loadMermaid)
  }
})()</script><script>function loadWaline () {
  function insertCSS () {
    const link = document.createElement("link")
    link.rel = "stylesheet"
    link.href = "https://cdn.jsdelivr.net/npm/@waline/client/dist/waline.min.css"
    document.head.appendChild(link)
  }

  function initWaline () {
    const waline = Waline.init(Object.assign({
      el: '#waline-wrap',
      serverURL: 'https://waline-j0ssj7g7m-ouyli.vercel.app/',
      pageview: false,
      dark: 'html[data-theme="dark"]',
      path: window.location.pathname,
      comment: false,
    }, null))
  }

  if (typeof Waline === 'function') initWaline()
  else {
    insertCSS()
    getScript('https://cdn.jsdelivr.net/npm/@waline/client/dist/waline.min.js').then(initWaline)
  }
}

if ('Waline' === 'Waline' || !true) {
  if (true) btf.loadComment(document.getElementById('waline-wrap'),loadWaline)
  else setTimeout(loadWaline, 0)
} else {
  function loadOtherComment () {
    loadWaline()
  }
}</script></div><script defer="defer" id="fluttering_ribbon" mobile="false" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/dist/canvas-fluttering-ribbon.min.js"></script><script id="click-heart" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/dist/click-heart.min.js" async="async" mobile="false"></script><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div></body></html>